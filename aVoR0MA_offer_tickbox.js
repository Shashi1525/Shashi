
var pdp_html = '<div class="inc_pdp_title_block"><div class="inc_pdp_title_text_block"><div class="inc_pdp_title_text">Frequently bought together</div></div></div><div class="inc_pdp_bundle_block"><div class="inc_pdp_product-main_block"><div class="mainprodtitletext">This item</div></div><div class="inc_pdp_icon-add_block"><div class="inc_pdp_icon-add_img_block"><div class="inc_pdp_icon-add_img"></div></div></div><div class="inc_pdp_bundle_product_block"><div class="inc_pdp_bundle_product_header_block"><div class="inc_pdp_bundle_product_header_text">Frequently bought with</div></div><div class="inc_pdp_bundle_product_left-btn_block"><div class="inc_pdp_bundle_product_left-btn_img_block"><div class="inc_pdp_bundle_product_left-btn_img" title="Scroll left"></div></div></div><div class="inc_pdp_bundle_product_list_block"><div class="inc_pdp_bundle_product_list_main_block"></div><div class="inc_pdp_bundle_list_wrapper_block"><div class="inc_pdp_bundle_product_list_left_block"><div class="inc_pdp_bundle_product_list_left_btn_block"><div class="inc_pdp_bundle_product_list_left_btn_img_block"><div class="inc_pdp_bundle_product_list_left_btn_img">Next</div></div></div></div><div class="inc_pdp_bundle_product_list_items_show_more_less_block"><div class="inc_pdp_bundle_product_list_items_show_more_less_text down_wrrow">Show more products</div></div><div class="inc_pdp_bundle_product_list_wrapper_items_block"><div class="inc_pdp_bundle_product_list_wrapper_header_block"><div class="inc_pdp_bundle_product_list_wrapper_header_text_block"></div><div class="inc_pdp_bundle_product_list_wrapper_header_close_block"></div></div><div class="inc_pdp_bundle_product_list_items_block"></div></div><div class="inc_pdp_bundle_product_list_right_block"><div class="inc_pdp_bundle_product_list_right_btn_block"><div class="inc_pdp_bundle_product_list_right_btn_img_block"><div class="inc_pdp_bundle_product_list_right_btn_img">Previous</div></div></div></div></div><div class="inc_pdp_bundle_product_right-btn_block"><div class="inc_pdp_bundle_product_right-btn_img_block"><div class="inc_pdp_bundle_product_right-btn_img" title="Scroll right"></div></div></div></div></div><div class="inc_pdp_bundle_cart_overlay_block"></div><div class="inc_pdp_bundle_cart_block"><div class="inc_pdp_bundle_cart_title_block"><div class="inc_pdp_bundle_cart_title_text_block"><div class="inc_pdp_bundle_cart_title_text">Price Summary</div></div></div><div class="inc_pdp_bundle-cart_ecirp_block"><div class="inc_pdp_bundle-cart_ecirp_main"><div class="inc_pdp_bundle-cart_ecirp_main_title_block"><div class="inc_pdp_bundle-cart_ecirp_main_title_text_block"><div class="inc_pdp_bundle-cart_ecirp_main_title_text">Main Product Price </div></div></div><div class="inc_pdp_bundle-cart_ecirp_main_figure_block"><div class="inc_pdp_bundle-cart_ecirp_main_figure_text_block"><div class="inc_pdp_bundle-cart_ecirp_main_figure_text">£00.00</div></div></div></div><div class="inc_pdp_bundle-cart_ecirp_addon_block"><div class="inc_pdp_bundle-cart_ecirp_addon_title_block"><div class="inc_pdp_bundle-cart_ecirp_addon_title_text_block"><div class="inc_pdp_bundle-cart_ecirp_addon_title_text">Add-on(s) Selected </div></div></div><div class="inc_pdp_bundle-cart_ecirp_addon_figure_block"><div class="inc_pdp_bundle-cart_ecirp_addon_figure_text_block"><div class="inc_pdp_bundle-cart_ecirp_addon_figure_text">£0.00</div></div></div></div></div><div class="inc_pdp_bundle_cart_added_block"></div><div class="inc_pdp_bundle_cart_summary_block"><div class="inc_pdp_bundle_cart_summary_title_block"><div class="inc_pdp_bundle_cart_summary_title_text_block"><div class="inc_pdp_bundle_cart_summary_title_text">Total bundle price</div></div></div><div class="inc_pdp_bundle_cart_summary_ecirp_block"><div class="inc_pdp_bundle_cart_summary_ecirp_active_block"><div class="inc_pdp_bundle_cart_summary_ecirp_active_text_block"><div class="inc_pdp_bundle_cart_summary_ecirp_active_text"></div></div></div><div class="inc_pdp_bundle_cart_summary_ecirp_regular_block"><div class="inc_pdp_bundle_cart_summary_ecirp_regular_text_block"><div class="inc_pdp_bundle_cart_summary_ecirp_regular_text"></div></div></div></div><div class="inc_pdp_bundle_cart_summary_ecirp_save_block"><div class="inc_pdp_bundle_cart_summary_ecirp_save_text"></div></div><div class="inc_pdp_bundle_cart_summary_view_block"><div class="inc_pdp_bundle_cart_summary_view_btn_block"><div class="inc_pdp_bundle_cart_summary_view_btn_img_block"><div class="inc_pdp_bundle_cart_summary_view_btn_img"></div></div><div class="inc_pdp_bundle_cart_summary_view_btn_text_block"><div class="inc_pdp_bundle_cart_summary_view_btn_text">Added items</div></div><div class="inc_pdp_bundle_cart_summary_view_btn_count_block"><div class="inc_pdp_bundle_cart_summary_view_btn_count"></div></div></div></div><div class="inc_pdp_bundle_cart_summary_add_block"><div class="inc_pdp_bundle_cart_summary_add_btn_block"><div class="inc_pdp_bundle_cart_summary_add_btn_text_block"><div class="inc_pdp_bundle_cart_summary_add_btn_text">Add To Bag</div><div class="inc_pdp_bundle_cart_summary_add_btn_span"></div></div><div class="inc_pdp_bundle_cart_summary_add_btn_img_block"><div class="inc_pdp_bundle_cart_summary_add_btn_img"></div></div></div></div></div></div></div>'
var sidebar_html = '<div class="inc_sidebar_modal_block"><div class="inc_sidebar_modal_cart_and_title_block"><div class="inc_header_title_block"><div class="inc_header_title_text_block"><div class="inc_header_title_text">Just Added to your Basket</div></div><span class="close_sisebar_icon"></span></div><div class="inc_sidebar_cart_added_block"><div class="inc_cart_added_list_block"></div><div class="inc_cart_product_count_block"></div></div><div class="inc_sidebar_header_block"><div class="inc_header_continue_block"><div class="inc_header_continue_img_block"><div class="inc_header_continue_img"></div></div><div class="inc_header_continue_text_block"><div class="inc_header_continue_text">Back</div></div></div><div class="inc_header_item_block"><div class="inc_header_item_count_block"><div class="inc_header_item_count_title_block"><div class="inc_header_item_count_title_text_block"><div class="inc_header_item_count_title_text">Subtotal (0 item)</div></div></div><div class="inc_header_item_count_figure_block"><div class="inc_header_item_count_figure_text_block"><div class="inc_header_item_count_figure_text"></div></div></div><div class="inc_cart_added_product_desc_subtotal_ecirp_block"><div class="inc_cart_added_product_desc_subtotal_ecirp_active_block"><div class="inc_cart_added_product_desc_subtotal_ecirp_active_text_block"><div class="inc_cart_added_product_desc_subtotal_ecirp_active_text" subtotalactiveprice="0.00">£0.00</div><div class="inc_cart_added_product_desc_ecirp_active_text_msg"></div></div></div><div class="inc_cart_added_product_desc_subtotal_ecirp_regular_block"><div class="inc_cart_added_product_desc_subtotal_ecirp_regular_text_block"><div class="inc_cart_added_product_desc_subtotal_ecirp_regular_text" subtotalregularprice="0.00"></div></div></div></div></div></div></div></div><div class="inc_sidebar_checkout_block"><div class="inc_checkout_continue_block"><div class="inc_checkout_continue_btn_block"><div class="inc_checkout_continue_btn_img_block"><div class="inc_checkout_continue_btn_img"></div></div><div class="inc_checkout_continue_btn_text_block"><div class="inc_checkout_continue_btn_text">Continue shopping</div><div class="inc_checkout_continue_btn_span"></div></div></div></div><div class="inc_checkout_basket_block"><div class="inc_checkout_basket_btn_block"><div class="inc_checkout_basket_btn_img_block"><div class="inc_checkout_basket_btn_img"></div></div><div class="inc_checkout_basket_btn_text_block"><div class="inc_checkout_basket_btn_span"></div><div class="inc_checkout_basket_btn_text"><a class="view_basket_checkout"><div draggable="false">View cart</div></a></div></div></div></div></div><div class="inc_sidebar_recommended_block"><div class="inc_recommended_title_block"><div class="inc_recommended_title_text_block"><div class="inc_recommended_title_text">Customers also bought</div></div></div><div class="inc_recommended_tabs_block"><div class="inc_recommended_tabs_list_block inc_categ_4" tabindex="0"></div></div><div class="inc_recommended_products_block"><div class="inc_recommended_products_left_block"><div class="inc_recommended_products_left_btn_block"><div class="inc_recommended_products_left_btn_img_block"><div class="inc_recommended_products_left_btn_img" title="Scroll left"></div></div></div></div><div class="inc_recommended_products_list_main_block"><div class="inc_recommended_products_list_block"></div></div><div class="inc_recommended_products_item_thumb_block"><div class="inc_recommended_products_list_item_thumb_block"></div></div><div class="inc_recommended_products_right_block"><div class="inc_recommeded_products_right_btn_block"><div class="inc_recommended_products_right_btn_img_block"><div class="inc_recommended_products_right_btn_img" title="Scroll right"></div></div></div></div></div></div></div>'
var cart_html = '<div class="inc_af_title_block" style="clear: both;"><div class="inc_af_title_text_block"><div class="inc_af_title_text">Produse de top cu reduceri</div><div class="inc_af_modal_close"></div></div></div><div class="inc_af_bundles_block"><div class="inc_af_left_block"><div class="inc_af_left_btn_block"><div class="inc_af_left_btn_img_block"><div class="inc_af_left_btn_img"></div></div></div></div><div class="inc_af_product-list-main_block"><div class="inc_af_product-list_block"></div></div><div class="inc_af_right_block"><div class="inc_af_right_btn_block"><div class="inc_af_right_btn_img_block"><div class="inc_af_right_btn_img"></div></div></div></div></div>'
var showcase_productcard = '<div class="inc_product_block"><div class="inc_product_extension_block"></div><div class="inc_product_header_main_block"><div class="inc_product_header_main_title_block"></div><div class="inc_product_header_main_rating_block"></div><div class="inc_product_header_block"><div class="inc_product_header_title_block"><div class="inc_product_header_title_text_block"><div class="inc_product_header_title_text"></div></div></div></div><div class="inc_product_Description_header_block"><div class="inc_product_Description_header_title_block"><div class="inc_product_Description_header_title_text_block"><div class="inc_product_Description_header_title_text"></div></div></div></div><div class="inc_product_header_img_block"><div class="inc_product_header_img"></div></div></div><div class="inc_product_info_main_block"><div class="inc_product_img_block"><div class="inc_product_img_main_block"><div class="inc_product_img_main_img"></div></div><div class="inc_product_img_gallery_block"><div class="inc_product_img_gallery_left_block"><div class="inc_product_img_gallery_left_btn_block"><div class="inc_product_img_gallery_left_btn_img_block"><div class="inc_product_img_gallery_left_btn_img"></div></div><div class="inc_product_img_gallery_left_btn_text_block"><div class="inc_product_img_gallery_left_btn_text"></div></div></div></div><div class="inc_product_img_gallery_list_block"></div><div class="inc_product_img_gallery_right_block"><div class="inc_product_img_gallery_right_btn_block"><div class="inc_product_img_gallery_right_btn_img_block"><div class="inc_product_img_gallery_right_btn_img"></div></div><div class="inc_product_img_gallery_right_btn_text_block"><div class="inc_product_img_gallery_right_btn_text"></div></div></div></div></div></div><div class="inc_product_desc_block"><div class="cosproductsku"></div><div class="inc_product_desc_title_block"><div class="inc_product_desc_title_text_block"><div class="inc_product_desc_title_text"></div></div></div><div class="pc_promo_div empty"></div><div class="inc_product_desc_ecirp_block"><div class="inc_product_ecirp_label_block">SALE</div><div class="inc_product_desc_ecirp_active_block"><div class="inc_product_desc_ecirp_active_text_block"><div class="inc_product_desc_ecirp_active_text">£0.00 - -£0.00</div><div class="inc_product_desc_ecirp_active_text_msg"></div></div></div><div class="inc_product_desc_ecirp_regular_block"><div class="inc_product_desc_ecirp_regular_text_block"><div class="inc_product_desc_ecirp_regular_text"></div></div></div><div class="inc_product_desc_ecirp_worth_block"><div class="inc_product_desc_ecirp_worth_text_block"><div class="inc_product_desc_ecirp_worth_text"></div><div class="inc_product_desc_ecirp_worth_text_msg"></div></div></div></div><div class="inc_product_desc_ratings_block"></div><div class="inc_variant_error_text"></div><div class="inc_product_desc_att_details_block"><div class="inc_product_variant_simple_block"><div class="inc_product_variant_simple_text">Add To Bag</div></div><div class="inc_product_desc_att_block"><div class="inc_product_desc_variant_popup_close_block"></div><div class="inc_product_desc_add_err_text_block"></div><div class="inc_product_desc_add_title_text_block"></div><div class="inc_product_desc_att_zero_block"><div class="inc_product_desc_att_zero_title_block"><div class="inc_product_desc_att_zero_title_text_block"><div class="inc_product_desc_att_zero_title_text"></div><div class="inc_product_desc_att_zero_title_text_selected"></div></div></div><div class="inc_product_desc_att_zero_list_block"></div></div><div class="inc_product_desc_att_size_block"><div class="inc_product_desc_att_size_title_block"><div class="inc_product_desc_att_size_title_text_block"><div class="inc_product_desc_att_size_title_text"></div><div class="inc_product_desc_att_size_title_text_selected"></div></div></div><div class="inc_product_desc_att_size_list_block"></div></div><div class="inc_product_desc_att_color_block"><div class="inc_product_desc_att_color_title_block"><div class="inc_product_desc_att_color_title_text_block"><div class="inc_product_desc_att_color_title_text"></div><div class="inc_product_desc_att_color_title_text_selected"></div></div></div><div class="inc_product_desc_att_color_list_block"></div></div><div class="inc_product_desc_att_third_block"><div class="inc_product_desc_att_third_title_block"><div class="inc_product_desc_att_third_title_text_block"><div class="inc_product_desc_att_third_title_text"></div><div class="inc_product_desc_att_third_title_text_selected"></div></div></div><div class="inc_product_desc_att_third_list_block"></div></div><div class="inc_product_desc_att_fourth_block"><div class="inc_product_desc_att_fourth_title_block"><div class="inc_product_desc_att_fourth_title_text_block"><div class="inc_product_desc_att_fourth_title_text"></div><div class="inc_product_desc_att_fourth_title_text_selected"></div></div></div><div class="inc_product_desc_att_fourth_list_block"><div class="inc_product_desc_att_fourth_list_item_block"><div class="inc_product_desc_att_fourth_list_item_img_block"><div class="inc_product_desc_att_fourth_list_item_img"></div></div><div class="inc_product_desc_att_fourth_list_item_text_block"><div class="inc_product_desc_att_fourth_list_item_text"></div></div></div></div></div><div class="inc_product_desc_att_edit_block"><div class="inc_product_desc_att_edit_text"></div></div><div class="inc_product_desc_att_variant_add_block"><div class="inc_product_desc_att_variant_text"></div></div></div><div class="inc_product_details_prod_block"><div class="inc_product_details_prod_text"></div></div></div><div class="inc_product_desc_qty_add_btn_block "><label>qty</label><div class="inc_product_qty_block singleqty"><div class="inc_product_qty_down_block"><div class="inc_product_qty_down_btn_block"><div class="inc_product_qty_down_btn"></div></div></div><div class="inc_product_qty_input_block"><div class="inc_product_qty_input_text_block"><div class="inc_product_qty_input_text"><span class="inc_add_text"></span></div></div></div><div class="inc_product_qty_up_block"><div class="inc_product_qty_up_btn_block"><div class="inc_product_qty_up_btn"></div></div></div></div><div class="inc_product_add_block"><div class="inc_product_add_text_block"><div class="inc_product_add_text">Add To Bag</div></div></div><div class="inc_product_desc_add_block"><div class="inc_product_desc_add_img_block"><div class="inc_product_desc_add_img"></div></div><div class="inc_product_desc_add_text_block"><div class="inc_product_desc_add_text">Add To Bag</div><div class="inc_product_desc_add_span"></div></div></div><div class="inc_product_bstxt_block"></div></div></div><div class="inc_product_bstxt_block"></div></div><div class="inc_product_description_main_block"></div></div>'
var modal_productcard = '<div class="inc_product_block "><div class="inc_product_extension_block"></div><div class="inc_product_header_main_block"><div class="inc_product_header_main_title_block"></div><div class="inc_product_header_main_rating_block"><div class="inc_product_desc_ratings_block"></div><span class="product_modal_sku">#</span></div><div class="inc_product_header_block"><div class="inc_product_header_title_block"><div class="inc_product_header_title_text_block"><div class="inc_product_header_title_text">Overview</div></div></div><div class="inc_product_header_new_page"><a class="inc_product_header_new_page_text" href="">Open In A New Tab</a></div></div><div class="inc_product_Description_header_block"><div class="inc_product_Description_header_title_block"><div class="inc_product_Description_header_title_text_block"><div class="inc_product_Description_header_title_text"></div></div></div></div><div class="inc_product_header_img_block"><div class="inc_product_header_img"></div></div></div><div class="inc_product_info_main_block"><div class="inc_product_img_block"><div class="inc_product_img_main_block"><div class="inc_product_img_main_img"></div></div><div class="inc_product_img_gallery_block"><div class="inc_product_img_gallery_left_block" title="Scroll left"><div class="inc_product_img_gallery_left_btn_block"><div class="inc_product_img_gallery_left_btn_img_block"><div class="inc_product_img_gallery_left_btn_img"></div></div><div class="inc_product_img_gallery_left_btn_text_block"><div class="inc_product_img_gallery_left_btn_text"></div></div></div></div><div class="inc_product_img_gallery_list_block"></div><div class="inc_product_img_gallery_right_block" title="Scroll right"><div class="inc_product_img_gallery_right_btn_block"><div class="inc_product_img_gallery_right_btn_img_block"><div class="inc_product_img_gallery_right_btn_img"></div></div><div class="inc_product_img_gallery_right_btn_text_block"><div class="inc_product_img_gallery_right_btn_text"></div></div></div></div></div></div><div class="inc_product_desc_block"><div class="cosproductsku"></div><div class="inc_product_desc_title_block"><div class="inc_product_desc_title_text_block"><div class="inc_product_desc_title_text"></div></div></div><div class="inc_product_desc_ecirp_block"><div class="inc_product_ecirp_label_block">SALE</div><div class="inc_product_desc_ecirp_active_block"><div class="inc_product_desc_ecirp_active_text_block"><div class="inc_product_desc_ecirp_active_text">£0.00 - -£0.00</div><div class="inc_product_desc_ecirp_active_text_msg"></div></div></div><div class="inc_product_desc_ecirp_regular_block"><div class="inc_product_desc_ecirp_regular_text_block"><div class="inc_product_desc_ecirp_regular_text"></div></div></div><div class="inc_product_desc_ecirp_worth_block"><div class="inc_product_desc_ecirp_worth_text_block"><div class="inc_product_desc_ecirp_worth_text"></div><div class="inc_product_desc_ecirp_worth_text_msg"></div></div></div></div><div class="inc_product_desc_ratings_block"></div><div class="inc_product_desc_att_details_block"><div class="inc_product_variant_simple_block"><div class="inc_product_variant_simple_text"></div></div><div class="pc_promo_div empty"></div><div class="inc_product_desc_att_block"><div class="inc_product_desc_variant_popup_close_block"></div><div class="inc_product_desc_add_err_text_block"></div><div class="inc_product_desc_add_title_text_block"></div><div class="inc_product_desc_att_zero_block"><div class="inc_product_desc_att_zero_title_block"><div class="inc_product_desc_att_zero_title_text_block"><div class="inc_product_desc_att_zero_title_text"></div><div class="inc_product_desc_att_zero_title_text_selected"></div></div></div><div class="inc_product_desc_att_zero_list_block"></div></div><div class="inc_product_desc_att_size_block"><div class="inc_product_desc_att_size_title_block"><div class="inc_product_desc_att_size_title_text_block"><div class="inc_product_desc_att_size_title_text"></div><div class="inc_product_desc_att_size_title_text_selected"></div></div></div><div class="inc_product_desc_att_size_list_block"></div></div><div class="inc_product_desc_att_color_block"><div class="inc_product_desc_att_color_title_block"><div class="inc_product_desc_att_color_title_text_block"><div class="inc_product_desc_att_color_title_text"></div><div class="inc_product_desc_att_color_title_text_selected"></div></div></div><div class="inc_product_desc_att_color_list_block"></div></div><div class="inc_product_desc_att_third_block"><div class="inc_product_desc_att_third_title_block"><div class="inc_product_desc_att_third_title_text_block"><div class="inc_product_desc_att_third_title_text"></div><div class="inc_product_desc_att_third_title_text_selected"></div></div></div><div class="inc_product_desc_att_third_list_block"></div></div><div class="inc_product_desc_att_fourth_block"><div class="inc_product_desc_att_fourth_title_block"><div class="inc_product_desc_att_fourth_title_text_block"><div class="inc_product_desc_att_fourth_title_text"></div><div class="inc_product_desc_att_fourth_title_text_selected"></div></div></div><div class="inc_product_desc_att_fourth_list_block"><div class="inc_product_desc_att_fourth_list_item_block"><div class="inc_product_desc_att_fourth_list_item_img_block"><div class="inc_product_desc_att_fourth_list_item_img"></div></div><div class="inc_product_desc_att_fourth_list_item_text_block"><div class="inc_product_desc_att_fourth_list_item_text"></div></div></div></div></div><div class="inc_product_desc_att_edit_block"><div class="inc_product_desc_att_edit_text"></div></div><div class="inc_product_desc_att_variant_add_block"><div class="inc_product_desc_att_variant_text"></div></div></div><div class="inc_product_details_prod_block"><div class="inc_product_details_prod_text"></div></div></div><div class="inc_product_desc_qty_add_btn_block"><div class="inc_product_qty_block singleqty"><div class="inc_product_qty_down_block"><div class="inc_product_qty_down_btn_block"><div class="inc_product_qty_down_btn"></div></div></div><div class="inc_product_qty_input_block"><div class="inc_product_qty_input_text_block"><div class="inc_product_qty_input_text"></div></div></div><div class="inc_product_qty_up_block"><div class="inc_product_qty_up_btn_block"><div class="inc_product_qty_up_btn"></div></div></div></div><div class="inc_product_add_block"><div class="inc_product_add_text_block"><div class="inc_product_add_text"></div></div></div><div class="inc_product_desc_add_block"><div class="inc_product_desc_add_img_block"><div class="inc_product_desc_add_img"></div></div><div class="inc_product_desc_add_text_block"><div class="inc_product_desc_add_text">Add To Bag</div><div class="inc_product_desc_add_span"></div></div></div><div class="inc_product_bstxt_block"></div></div></div><div class="inc_product_bstxt_block"></div></div><div class="inc_product_description_main_block"></div></div>'

var INC = (typeof (INC) == "undefined") ? {} : INC;
var init_flag = true
INC.ENV = "prod";
INC.debug = 0;
INC.initStatus = "";
INC.initStatusCP = "";
var prefix = "inc_";
var postfix = "_block";
var onloadpdp = false;

var onloadpdp_delete = false;
INC.checkProdUserCookie = function() {
    if (INC.ENV == "prod") {
        setTimeout(function() {
            INC.config.pageType = INC.methods.detectPageType();
            if (init_flag) {
                init_flag = false;
                INC.init();
            }
        }, 800);
    }
}
INC.checkProdUserCookie();
var incallowedKeys = [46, 8, 9, 27, 110, 190];
var inc_scroll_height = 100
INC.clientConfig = {};
INC.clientConfig.statusVAT = "";
INC.clientConfig.offset = 0;
INC.clientConfig.slidevalue = 0;
INC.config = {};
INC.config.deviceType = "";
INC.config.clientToken = "aVoR0MA";
INC.config.trackingURL = "https://optimizedby.increasingly.co/ImportData";
INC.config.addToBasketURL = "";
INC.clientConfig.checkoutLink = "https://www2.avoncosmetics.ro/ro-home/orders/sales-tools";
INC.config.affiliateURL = "";
INC.config.pageType = "";
INC.config.ivid = "";
INC.config.pdpaddedProductList = [];
INC.config.inc_slideIndex = 1;
INC.config.bundle_tracking = [];
INC.config.Product_id = null;
INC.config.dupBasket = [];
INC.config.dupDataObjectProducts = [];
INC.clientConfig.OOS = []
INC.config.disablebtn = true;
INC.config.sidebarremovedprod = [];
INC.config.cartproductids = [];
INC.config.bundle_skuPushed = []
INC.config.FBTTitle = "Frequently bought together"
INC.config.AddedText = "Added"
INC.config.BeforeYouChecktext = "Customers also bought"
INC.config.ajaxerr = "I'm sorry we've experienced an error. Please try again."
INC.config.UpdateText = "UPDATE"
INC.config.noimage = "https://www.increasingly.co/Implementation/aVoR0MA/js/no-image.png"
INC.config.recommendation = false;
INC.config.srcImgeLazy = "/Implementation/C1iNq5/images/img_placeholder.gif";
INC.config.bundledid = []
INC.config.DealProducts=[];
INC.config.cldomain = ""
INC.config.checkoutpath = ""
INC.config.add_text = "Adaugă"
INC.config.adding_text = "Adăugând"
INC.config.added_text = "Produs selectat"; //"Adăugat"
INC.config.notadded_text = "Nu adăugat"
INC.config.you_saveText = "Salvați "
INC.config.push_product_to_add = [];
INC.config.cartAdeedprod=[]
function isBase64(str) {
    try {
        return btoa(atob(str)) == str;
    } catch (err) {
        return false;
    }
}
function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ')
            c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0)
            return c.substring(nameEQ.length, c.length);
    }
    return null;
}
function generate_html_tag(element, className) {
    var generateEl = document.createElement(element);
    className ? generateEl.classList.add(className) : null;
    return generateEl;
}
INC.init = function() {
    INC.config.pageType = INC.methods.detectPageType();
    INC.config.deviceType = INC.methods.detectDeviceType();
    INC.methods.clear();
    INC.methods.addVisitorID();
    switch (INC.config.pageType) {
    case "pdp":
        var productId = INC.methods.getProductIdFromWebPage();
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            INC.methods.irbReq(productId, 5, "catalog_product_view");
        }else {
            setTimeout(function() {
                if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                    INC.methods.irbReq(productId, 5, "catalog_product_view");
                }else{
                    setTimeout(function() {
                        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                            INC.methods.irbReq(productId, 5, "catalog_product_view");
                        }
                    },2000)
                }
            },2000)
        }
        break;
    case "cartPage":
        INC.config.cartproductids = []
        //document.querySelectorAll('.item-subDesc')[1].textContent.split('-')[0].trim()
        var productIds=[]
        Array.prototype.forEach.call(document.querySelectorAll('.inc_add_item'), function (elProductCode) {
            var cartId = elProductCode.getAttribute('linenrinc')
            if(INC.config.cartproductids.indexOf(cartId) == -1){
            	INC.config.cartproductids.push(cartId);
            }
        });
        if(typeof(cartData) != "undefined"){
            if(cartData.items != undefined){
                for(p=0;p<cartData.items.length;p++){
                    INC.config.cartproductids.push(cartData.items[p].lineNr);
                }
            }
        } 
        for(var s=0;s<INC.config.cartAdeedprod.length;s++){
        	if(INC.config.cartproductids.indexOf(INC.config.cartAdeedprod[s]) == -1){
            	INC.config.cartproductids.push(INC.config.cartAdeedprod[s]);
            }
        }
        if (INC.config.cartproductids.length > 0) {
            INC.methods.irbReq(INC.config.cartproductids, 12, "checkout_cart_index");
        }
        break;
    case "productList":
        break;
    }
}
INC.dataStore = {};
INC.dataStore.methods = function() {
    var incDataStore = INC.dataStore;
    var dataStoreObj = {};
    function buildDataStoreObj(bundleResponse) {
        INC.config.dupDataObjectProducts = []
        INC.dataStore.clientProductDealsCategory = "";
        if (INC.config.recommendation == true) {
            var bundles = [];
            bundles = bundleResponse.CategoryRecommendations;
        } else {
            var bundles = bundleResponse.Bundles;
        }
        var productDealCount = 0;
        if (bundleResponse.ProductDeals != null) {
            var catcnt=0
            bundleResponse.ProductDeals.forEach(function (productDealObj) {
                bundles.push({
                    BundleId: "offer" + catcnt,
                    ProductIds: [bundles[0].ProductIds[0], productDealObj.ProductId]
                });
                bundleResponse.ProductsDetail.push(productDealObj)
                INC.config.DealProducts.push(productDealObj.ProductId)
                catcnt++
            });
        }
        
        var dataStoreObj = {};
        var bundleproductarray = {}
        var bundleProductsArray = [];
        if (bundleResponse.ProductsDetail != null) {
            for (var ib = 0; ib < bundleResponse.ProductsDetail.length; ib++) {
                bundleproductarray[bundleResponse.ProductsDetail[ib].ProductId] = bundleResponse.ProductsDetail[ib]
            }
        } else if (bundleResponse.CategoryRecommendations != null) {
            for (var ib = 0; ib < bundleResponse.CategoryRecommendations.length; ib++) {
                bundleproductarray[bundleResponse.CategoryRecommendations[ib].ProductId] = bundleResponse.CategoryRecommendations[ib]
            }
        }
        var pdpProductId = ""
        
        for (var i = 0; i < bundles.length; i++) {
            if (INC.config.dupDataObjectProducts.indexOf(bundles[i].BundleId) == -1) {
                if (INC.config.recommendation == false) {
                    INC.config.dupDataObjectProducts.push(bundles[i].BundleId)
                }
                INC.config.bundledid.push({
                    bundleids: bundles[i].BundleId,
                    productids: bundles[i].ProductIds
                })
                var irbBundleObj = bundles[i];
                var bundleObj = {};

                if (INC.config.recommendation == true) {} else {
                    bundleObj.id = irbBundleObj["BundleId"];
                }
                if (INC.config.recommendation == false) {
                    bundleObj.id = irbBundleObj["BundleId"];
                    bundleObj.totalRegularPrice = irbBundleObj["TotalPrice"];
                    bundleObj.totalActivePrice = irbBundleObj["TotalSpecialPrice"];
                    bundleObj.totalBundlePrice = irbBundleObj["TotalBundlePrice"];
                    bundleObj.totalBundleDiscountPrice = irbBundleObj["DiscountPrice"];
                    bundleObj.productCount = irbBundleObj["ProductCount"];
                }
                if (INC.config.recommendation == true) {
                    var irbProductsArray = bundles;
                } else {
                    var irbProductsArray = irbBundleObj["ProductIds"]
                }
                
                if (window.location.href.indexOf('orders/cart') >= 0) {
                    if (INC.config.cartproductids.indexOf(irbProductsArray[0]) >= 0) {
                        pdpProductId = irbProductsArray[0];
                        bundleProductsArray.push(irbProductsArray[1]);
                    } else if (INC.config.cartproductids.indexOf(irbProductsArray[1]) >= 0) {
                        pdpProductId = irbProductsArray[1];
                        bundleProductsArray.push(irbProductsArray[0]);
                    }
                } 
                if (INC.config.recommendation == false) {
                    if (irbProductsArray) {
                        if (window.location.pathname == INC.config.checkoutpath || INC.config.recommendation) {
                            if (INC.config.cartproductids.indexOf(irbProductsArray[0]) >= 0) {
                                pdpProductId = irbProductsArray[0];
                                bundleProductsArray.push(irbProductsArray[1]);
                            } else if (INC.config.cartproductids.indexOf(irbProductsArray[1]) >= 0) {
                                pdpProductId = irbProductsArray[1];
                                bundleProductsArray.push(irbProductsArray[0]);
                            }
                        } else {
                            pdpProductId = irbProductsArray[0];
                            bundleProductsArray.push(irbProductsArray[1]);
                        }
                    }
                }
                if (INC.config.recommendation == true) {
                    bundleProductsArray.push(bundles[i]["ProductId"]);
                }
                for (var j = 0; j < irbProductsArray.length; j++) {
                    var product = bundleproductarray[irbProductsArray[j]] || irbProductsArray[j]
                    var pAttributes = product["Attributes"] || "";
                    if (pAttributes != "" && pAttributes != null) {
                        for (var h = 0; h < pAttributes.length; h++) {
                            if (pAttributes[h].frontEndLabel == "color") {
                                pAttributes[h].frontEndLabel = "Color"
                            }
                            if (pAttributes[h].frontEndLabel == "Shade") {
                                pAttributes[h].frontEndLabel = "Color"
                            }
                            if (pAttributes[h].frontEndLabel == "size") {
                                pAttributes[h].frontEndLabel = "Size"
                            }
                            if (pAttributes.length == 1) {
                                pAttributes[h].frontEndLabel = "Size"
                            }
                            pAttributes[h].attributeCode = pAttributes[h].frontEndLabel;
                        }
                        pAttributes = attribute_listing(pAttributes)
                    }
                    var pAttObj = {};
                    for (t = 0; t < pAttributes.length; t++) {
                        if (pAttributes.length == 1) {
                            if (pAttributes[0].attributeCode == "Color" || pAttributes[0].attributeCode == "color") {
                                pAttributes[0].attributeId = 0;
                                var attr_values = pAttributes[t].attributeValues;
                                for (v = 0; v < attr_values.length; v++) {
                                    attr_values[v].optionId = 0;
                                }
                            } else {
                                pAttributes[0].attributeId = 1;
                                var attr_values = pAttributes[t].attributeValues;
                                for (v = 0; v < attr_values.length; v++) {
                                    attr_values[v].optionId = 1;
                                }
                            }
                        } else {
                            pAttributes[t].attributeId = t
                            var attr_values = pAttributes[t].attributeValues;
                            for (v = 0; v < attr_values.length; v++) {
                                attr_values[v].optionId = t;
                            }
                        }
                    }

                    if (pAttributes.length) {
                        for (var k = 0; k < pAttributes.length; k++) {
                            var pAttributesObj = pAttributes[k];
                            var pAttributesValues = pAttributesObj["attributeValues"];
                            for (var l = 0; l < pAttributesValues.length; l++) {
                                var childProduct = pAttributesValues[l];
                                if (childProduct["childProductId"] == null) {
                                    childProduct["childProductId"] = product["ProductId"];
                                    childProduct["childProductSku"] = product["ProductSku"];
                                    childProduct["childProductName"] = product["ProductName"];
                                    childProduct["childProductImageUrl"] = product["ImageURL"];
                                    childProduct["childProductOtherImageUrl"] = product["OtherImageList"];
                                    childProduct["childProductUrl"] = product["ProductUrl"];
                                    childProduct["childProductPrice"] = product["Price"];
                                    childProduct["childProductSpecialPrice"] = product["SpecialPrice"];
                                    childProduct["childProductDescription"] = product["Description"];
                                    childProduct["childInternalProductId"] = product["ProductId"]
                                }
                                childProduct["ProductType"] = product["ProductType"];
                                childProduct["mainSKU"] = product["ProductSku"];
                                childProduct["childProductIdmain"] = product["ProductId"];
                                childProduct["childProductImageUrlMain"] = product["ImageURL"];
                                childProduct["childProductPriceMain"] = product["Price"];
                                childProduct["childProductSpecialPriceMain"] = product["SpecialPrice"];
                                childProduct["childProductNameMain"] = product["ProductName"];
                                childProduct["childProductUrlMain"] = product["ProductUrl"];
                                childProduct["childreviewsCount"] = product["RatingCount"];
                                childProduct["childRating"] = product["Rating"];
                                childProduct["childCategoryName"] = product["CategoryName"];
                                childProduct["childCategoryId"] = product["CategoryId"];
                                childProduct["childProductDescription"] = product["Description"];
                                var productObj = new INC.classes.ProductAttObj(childProduct);

                                productObj["bundledProductId"] = pdpProductId;
                                productObj.mainId = product["ProductId"];
                                productObj.bundleId = bundleObj.id;
                                productObj.sku = productObj.id;
                                productObj.option[pAttributesObj["attributeId"]].id = pAttributesObj["attributeId"];
                                productObj.option[pAttributesObj["attributeId"]].label = pAttributesObj["frontEndLabel"];
                                productObj.option[pAttributesObj["attributeId"]].code = pAttributesObj["attributeCode"];
                                productObj.Filed3 = product["Field3"] + " | " + product["Field4"];
                                if (!dataStoreObj.hasOwnProperty(product['ProductId'])) {
                                    dataStoreObj[product['ProductId']] = {};
                                }
                                if (!dataStoreObj[product['ProductId']].hasOwnProperty(productObj['id'])) {
                                    dataStoreObj[product['ProductId']][productObj['id']] = {}
                                }
                                pAttObj = dataStoreObj[product['ProductId']][productObj['id']];
                                for (pAtt in productObj) {
                                    if (pAtt == "option") {
                                        if (!pAttObj.hasOwnProperty('option')) {
                                            pAttObj["option"] = {}
                                        }
                                        Object.keys(productObj[pAtt]).forEach(function(key) {
                                            pAttObj[pAtt][key] = productObj[pAtt][key];
                                        });
                                    } else {
                                        pAttObj[pAtt] = productObj[pAtt];
                                    }
                                }
                            }

                        }
                    }
                    if (pAttributes.length == 0) {
                        var productObj = new INC.classes.ProductObj(product);
                        productObj["bundleId"] = irbBundleObj["BundleId"];
                        if (INC.config.recommendation == false) {
                            productObj["bundledProductId"] = pdpProductId;
                        }
                        productObj.sku = productObj.id;
                        productObj.Filed3 = product["Field3"] + " | " + product["Field4"];
                        if (!dataStoreObj.hasOwnProperty(productObj['mainId'])) {
                            dataStoreObj[productObj['mainId']] = {};
                        }
                        dataStoreObj[productObj['mainId']][productObj['id']] = {};
                        if (!!window.MSInputMethodContext && !!document.documentMode) {
                            dataStoreObj[productObj['mainId']][productObj['id']] = JSON.parse(JSON.stringify(productObj));
                        } else {
                            dataStoreObj[productObj['mainId']][productObj['id']] = Object.assign({}, productObj);
                        }
                    }
                }
            }
        }
        incDataStore.dataStoreObj = dataStoreObj;
        incDataStore.bundleProductsArray = bundleProductsArray;
        if (INC.config.recommendation == false) {
            incDataStore.pdpProductId = pdpProductId;
        }
        incDataStore.bundleCartProducts = {};
    }
    function getFirstProductObjByMainId(findObj) {
        var childProductObj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        try {
            if (productListObj != undefined) {
                childProductObj = productListObj[findObj["mainId"]][Object.keys(productListObj[findObj["mainId"]])[0]];
            }
        } catch (e) {}
        return childProductObj;
    }

    function getProductById(findObj) {
        var childProductObj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        if (findObj.hasOwnProperty("id")) {
            for (mainProductId in productListObj) {
                for (childProductId in productListObj[mainProductId]) {
                    if (productListObj[mainProductId][childProductId]["id"] == findObj["id"]) {
                        childProductObj = productListObj[mainProductId][childProductId];
                        break;
                    }
                }
            }
        }
        if (Object.keys(childProductObj).length == 0) {
            if (findObj.hasOwnProperty("id")) {
                for (mainProductId in productListObj) {
                    for (childProductId in productListObj[mainProductId]) {
                        if (productListObj[mainProductId][childProductId]["id"] == findObj["id"]) {
                            childProductObj = productListObj[mainProductId][childProductId];
                            break;
                        }
                    }
                }
            }
        }
        return childProductObj;
    }
    function getProductBySKU(findObj) {
        var childProductObj = {};
        var productListObj = INC.dataStore.dataStoreObj;

        if (findObj.hasOwnProperty('sku')) {
            for (mainProductId in productListObj) {
                for (childProductId in productListObj[mainProductId]) {
                    if (productListObj[mainProductId][childProductId]["sku"] == findObj['sku']) {
                        childProductObj = productListObj[mainProductId][childProductId];
                        break;
                    }
                }
            }
        }
        return childProductObj;
    }
    function getUniqueCatergories() {
        var catergoriesArray = [];

        var productListObj = INC.dataStore.dataStoreObj;
        var bundleProductsArray = INC.dataStore.bundleProductsArray;
        var count_category=0
        var deal_prd_pushed=true;
        if(INC.config.DealProducts.length > 0){
            deal_prd_pushed = false
        }
        var isdealprod=false
        bundleProductsArray.forEach(function (productId) {
            for (childProductId in productListObj[productId]) {
                if(productListObj[productId][childProductId]["categoryName"] == "Offers"){
                    isdealprod=true
                }
            }
        });
        var deal_category=[]
        bundleProductsArray.forEach(function (productId) {
            for (childProductId in productListObj[productId]) {
                count_category++
                
                var indexOfCategoryId = catergoriesArray.indexOf(productListObj[productId][childProductId]["categoryName"]);
                if (indexOfCategoryId == -1 && productListObj[productId][childProductId]["categoryName"] != INC.dataStore.clientProductDealsCategory) {
                    if(productListObj[productId][childProductId]["categoryName"] == "Offers"){
                        deal_prd_pushed=true
                        if(catergoriesArray.indexOf('Offers') == -1){
                            deal_category.push(productListObj[productId][childProductId]["categoryName"])
                        }
                    }else{
                        if(catergoriesArray.length < 4){
                            catergoriesArray.push(productListObj[productId][childProductId]["categoryName"]);
                        }else{
                            if(deal_category.length > 0){
                                if(catergoriesArray.indexOf('Offers') == -1){
                                    catergoriesArray.push(deal_category[0]);
                                }
                            }else{
                                if(isdealprod == false){
                                    catergoriesArray.push(productListObj[productId][childProductId]["categoryName"]);
                                }else if(catergoriesArray.length < 4){
                                    catergoriesArray.push(productListObj[productId][childProductId]["categoryName"]);
                                }
                            }
                        }
                    }
                }
            }
        });
        
        if(catergoriesArray.indexOf('Offers') == -1){
            if(deal_category.length > 0){
                if(catergoriesArray.length == 5){
                    if(catergoriesArray.indexOf('Offers') == -1){
                        catergoriesArray[4] = "Offers"
                    }
                }else{
                    if(catergoriesArray.indexOf('Offers') == -1){
                        catergoriesArray.push(deal_category[0]);
                    }
                }
            }else if(deal_category[0] == "Offers"){
                if(catergoriesArray.length == 5){
                    if(catergoriesArray.indexOf('Offers') == -1){
                        catergoriesArray[4] = "Offers"
                    }
                }else{
                    if(catergoriesArray.indexOf('Offers') == -1){
                        catergoriesArray.push(deal_category[0]);
                    }
                }
            }
       }
        return catergoriesArray;
    }
    function sorting_data(json_object, key_to_sort_by) {
        function sortByKey(a, b) {
            var x = a[key_to_sort_by];
            var y = b[key_to_sort_by];
            return ((x < y) ? -1 : ((x > y) ? 1 : 0));
        }
        json_object.sort(sortByKey);
    }
    function sortByKey(array, key) {
        return array.sort(function(a, b) {
            var x = a[key]
              , y = b[key];
            if (typeof x === 'string') {
                x = x.toLowerCase();
                y = y.toLowerCase();
                if (!isNaN(x) && !isNaN(y)) {
                    x = parseInt(x, 10);
                    y = parseInt(y, 10);
                }
            }
            return (x < y ? -1 : (x > y ? 1 : 0));
        });
    }
    function getProductColorsObj(findObj, type_of) {
        var productColorObj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        var productColorArrayObj = {}
        var productColorObjArray = [];
        var option_ids = ""
        var c_pid = ""
        var is_color = true;
        if (findObj.hasOwnProperty("mainId")) {
            for (mainProductId in productListObj) {
                if (mainProductId == findObj["mainId"]) {
                    for (childProductId in productListObj[mainProductId]) {
                        if (productListObj[mainProductId][childProductId]["option"]["0"] != undefined) {
                            if (productListObj[mainProductId][childProductId]["option"]["0"].code == "Color") {
                                if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["0"] != null && productListObj[mainProductId][childProductId]["option"]["0"] != undefined) {
                                    if (type_of != undefined) {
                                        var attr_block = null;
                                        if (type_of.parentNode.parentNode.parentNode.classList.contains('inc_product_desc_att_block') == false) {
                                            attr_block = type_of.parentNode.parentNode.parentNode.parentNode
                                        } else {
                                            attr_block = type_of.parentNode.parentNode.parentNode
                                        }
                                        if (type_of.parentNode != null) {
                                            var opt_text = attr_block.getAttribute('data-zero');
                                            var opt_size_text = attr_block.getAttribute('data-size');
                                            if (opt_size_text == undefined) {
                                                var opt_size_text = ""
                                            }
                                        } else {
                                            var opt_text = type_of.innerText;
                                            var opt_size_text = ""
                                        }

                                        if (opt_text != "" && opt_size_text != "" && productListObj[mainProductId][childProductId].option[1] != undefined && productListObj[mainProductId][childProductId].option[2] != undefined) {
                                            if (productListObj[mainProductId][childProductId].option[1].text == opt_text && productListObj[mainProductId][childProductId].option[2].text == opt_size_text) {
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]] = {};
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = "";
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = "";
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["0"]["titleText"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = productListObj[mainProductId][childProductId]["option"]["0"]["colorCode"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["0"]["imgSrc"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["0"]["code"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["0"]["cpid"];
                                            }
                                        } else if (opt_text != "" && productListObj[mainProductId][childProductId].option[1] != undefined) {
                                            if (productListObj[mainProductId][childProductId].option[1].text == opt_text) {
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]] = {};
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = "";
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = "";
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["0"]["titleText"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = productListObj[mainProductId][childProductId]["option"]["0"]["colorCode"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["0"]["imgSrc"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["0"]["code"];
                                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["0"]["cpid"];
                                            }
                                        } else {
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]] = {};
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = "";
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = "";
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["0"]["titleText"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = productListObj[mainProductId][childProductId]["option"]["0"]["colorCode"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["0"]["imgSrc"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["0"]["code"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["0"]["cpid"];
                                        }
                                    } else {
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]] = {};
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = "";
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = "";
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["0"]["titleText"];
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["colorCode"] = productListObj[mainProductId][childProductId]["option"]["0"]["colorCode"];
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["0"]["imgSrc"];
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["0"]["code"];
                                        productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["0"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["0"]["cpid"];
                                    }

                                }
                            } else {
                                is_color = false;
                            }
                        }
                    }
                }
            }
        }
        Object.keys(productColorArrayObj).forEach(function(colorText) {
            var colorObj = {}
            colorObj["text"] = colorText;
            // colorObj["imgSrc"] = productColorArrayObj[colorText];
            colorObj["colorCode"] = productColorArrayObj[colorText]["colorCode"];
            colorObj["imgSrc"] = productColorArrayObj[colorText]["imgSrc"];
            colorObj["titleText"] = productColorArrayObj[colorText]["titleText"];
            colorObj["code"] = productColorArrayObj[colorText]["code"];
            colorObj["cpid"] = productColorArrayObj[colorText]["cpid"];
            productColorObjArray.push(colorObj);
        });
        if (type_of == "size") {
            productColorObj["sizeArray"] = productColorObjArray;
        } else if (type_of == "zero") {
            productColorObj["att0Array"] = productColorObjArray;
        } else if (type_of == "third") {
            productColorObj["att3Array"] = productColorObjArray;
        } else {
            productColorObj["colorArray"] = productColorObjArray;
        }
        return productColorObj;
    }
    function getProductSizesObj(findObj, type_of) {
        var productSizeObj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        var productSizesArrayObj = {};
        var productSizesObjArray = [];
        var sizesArray = ["S", "M", "L", "XL", "XX", "XXL"];
        var attr_code = "";
        var c_pid = "";
        var prc = "";
        if (findObj.hasOwnProperty("mainId")) {
            for (mainProductId in productListObj) {
                if (mainProductId == findObj["mainId"]) {
                    for (childProductId in productListObj[mainProductId]) {
                        if (type_of != undefined) {
                            var attr_block = null;
                            if (type_of.parentNode.parentNode.parentNode.classList.contains('inc_product_desc_att_block') == false) {
                                attr_block = type_of.parentNode.parentNode.parentNode.parentNode
                            } else {
                                attr_block = type_of.parentNode.parentNode.parentNode
                            }
                            var opt_text = attr_block.getAttribute('data-zero');
                            var opt_size_text = attr_block.getAttribute('data-color');
                            // var opt_color_text=attr_block.getAttribute('data-color');

                            if (opt_size_text == undefined) {
                                var opt_size_text = ""
                            }
                            if (opt_text == undefined) {
                                var opt_text = ""
                            }
                            if (opt_color_text == undefined) {
                                var opt_color_text = ""
                            }
                            if (opt_text != "" && productListObj[mainProductId][childProductId].option[1] != undefined) {
                                if (opt_text != "" && opt_size_text != "" && productListObj[mainProductId][childProductId].option[0]) {
                                    if (productListObj[mainProductId][childProductId].option[1].text == opt_text && productListObj[mainProductId][childProductId].option[0].text == opt_size_text) {
                                        if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["2"] != null && productListObj[mainProductId][childProductId]["option"]["2"] != undefined) {
                                            productSizesArrayObj[productListObj[mainProductId][childProductId]["option"]["2"]["text"]] = productListObj[mainProductId][childProductId]["option"]["2"]["text"];
                                            attr_code = productListObj[mainProductId][childProductId]["option"]["2"]["code"];
                                            c_pid = productListObj[mainProductId][childProductId]["option"]["2"]["cpid"];
                                            prc = productListObj[mainProductId][childProductId]["option"]["2"]["activePriceChild"];
                                        }
                                    }
                                } else {
                                    if (productListObj[mainProductId][childProductId].option[1].text == opt_text) {
                                        if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["2"] != null && productListObj[mainProductId][childProductId]["option"]["2"] != undefined) {
                                            productSizesArrayObj[productListObj[mainProductId][childProductId]["option"]["2"]["text"]] = productListObj[mainProductId][childProductId]["option"]["2"]["text"];
                                            attr_code = productListObj[mainProductId][childProductId]["option"]["2"]["code"];
                                            c_pid = productListObj[mainProductId][childProductId]["option"]["2"]["cpid"];
                                            prc = productListObj[mainProductId][childProductId]["option"]["2"]["activePriceChild"];
                                        }
                                    }
                                }
                            } else if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["2"] != null && productListObj[mainProductId][childProductId]["option"]["2"] != undefined) {
                                productSizesArrayObj[productListObj[mainProductId][childProductId]["option"]["2"]["text"]] = productListObj[mainProductId][childProductId]["option"]["2"]["text"];
                                attr_code = productListObj[mainProductId][childProductId]["option"]["2"]["code"];
                                c_pid = productListObj[mainProductId][childProductId]["option"]["2"]["cpid"];
                                prc = productListObj[mainProductId][childProductId]["option"]["2"]["activePriceChild"];
                            }
                        } else if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["2"] != null && productListObj[mainProductId][childProductId]["option"]["2"] != undefined) {
                            productSizesArrayObj[productListObj[mainProductId][childProductId]["option"]["2"]["text"]] = productListObj[mainProductId][childProductId]["option"]["2"]["text"];
                            attr_code = productListObj[mainProductId][childProductId]["option"]["2"]["code"];
                            c_pid = productListObj[mainProductId][childProductId]["option"]["2"]["cpid"];
                            prc = productListObj[mainProductId][childProductId]["option"]["2"]["activePriceChild"];
                        }
                    }

                }
            }
        }

        Object.keys(productSizesArrayObj).forEach(function(sizeText) {
            var sizeObj = {};
            sizeObj["text"] = sizeText;
            sizeObj["code"] = attr_code;
            sizeObj["cpid"] = c_pid;
            sizeObj["prc"] = prc;
            productSizesObjArray.push(sizeObj);
        });
        productSizeObj["sizeArray"] = productSizesObjArray.sort(function(a, b) {
            return a["text"].split("-")[0].trim() - b["text"].split("-")[0].trim()
        });
        productSizeObj["sizeArray"] = productSizesObjArray.sort();
        productSizeObj["sizeArray"] = productSizesObjArray.sort(function(a, b) {
            return sizesArray.indexOf(a["text"]) - sizesArray.indexOf(b["text"])
        });

        return productSizeObj;
    }
    function getProductopt0Obj(findObj, type_of) {
        var product0Obj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        var product0ArrayObj = {}
        var product0ObjArray = [];

        if (findObj.hasOwnProperty("mainId")) {
            for (mainProductId in productListObj) {
                if (mainProductId == findObj["mainId"]) {
                    for (childProductId in productListObj[mainProductId]) {

                        if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["1"] != null && productListObj[mainProductId][childProductId]["option"]["1"] != undefined) {

                            var attr_main = true;
                            var first_attr_acodec = ["Connectivity", "Number of SIM", "Device"];
                            if (productListObj[mainProductId][childProductId]["option"][0] != undefined || productListObj[mainProductId][childProductId]["option"][1].code != undefined) {
                                if (first_attr_acodec.indexOf(productListObj[mainProductId][childProductId]["option"][0]) == -1 && first_attr_acodec.indexOf(productListObj[mainProductId][childProductId]["option"][1].code) == -1) {
                                    attr_main = false;
                                }
                            }
                            if (attr_main == true) {
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]] = {};
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["colorCode"] = "";
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = "";
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["1"]["titleText"];

                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["1"]["imgSrc"];
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["1"]["code"];
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["1"]["cpid"];
                                product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["1"]["activePriceChild"];
                            } else {
                                if (findObj.colorText != undefined) {
                                    if (productListObj[mainProductId][childProductId].option["0"].text.trim().toLocaleLowerCase() == findObj.colorText.trim().toLocaleLowerCase()) {
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]] = {};
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["colorCode"] = "";
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = "";
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["1"]["titleText"];
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["1"]["cpid"];
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["1"]["imgSrc"];
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["1"]["code"];
                                        product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["1"]["activePriceChild"];
                                    }
                                } else {
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]] = {};
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["colorCode"] = "";
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = "";
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["1"]["titleText"];
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["1"]["cpid"];
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["1"]["imgSrc"];
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["1"]["code"];
                                    product0ArrayObj[productListObj[mainProductId][childProductId]["option"]["1"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["1"]["activePriceChild"];
                                }
                            }
                        }
                    }
                }
            }
        }

        Object.keys(product0ArrayObj).forEach(function(colorText) {
            var attr0Obj = {}
            attr0Obj["text"] = colorText;
            attr0Obj["text1"] = colorText.replace('g', '').replace('l', '').replace('k', '');
            attr0Obj["imgSrc"] = product0ArrayObj[colorText]["imgSrc"];
            attr0Obj["titleText"] = product0ArrayObj[colorText]["titleText"];
            attr0Obj["code"] = product0ArrayObj[colorText]["code"];
            attr0Obj["cpid"] = product0ArrayObj[colorText]["cpid"];
            attr0Obj["prc"] = product0ArrayObj[colorText]["prc"];
            product0ObjArray.push(attr0Obj);
        });

        product0Obj["att0Array"] = product0ObjArray;
        product0Obj["att0Array"] = product0ObjArray.sort(function(a, b) {
            return a["text1"].split("-")[0].trim() - b["text1"].split("-")[0].trim()
        });
        return product0Obj;
    }
    function getProductopt3Obj(findObj, type_of) {
        var product3Obj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        var productColorArrayObj = {}
        var product3ObjArray = [];

        if (findObj.hasOwnProperty("mainId")) {
            for (mainProductId in productListObj) {
                if (mainProductId == findObj["mainId"]) {
                    for (childProductId in productListObj[mainProductId]) {

                        if (productListObj[mainProductId][childProductId]["option"] != null && productListObj[mainProductId][childProductId]["option"] != undefined && productListObj[mainProductId][childProductId]["option"]["3"] != null && productListObj[mainProductId][childProductId]["option"]["3"] != undefined) {
                            if (type_of != undefined) {
                                var attr_block = null;
                                if (elAttBlock = "elAttBlock") {
                                    attr_block = type_of
                                } else if (type_of.parentNode.parentNode != null) {
                                    if (type_of.parentNode.parentNode.parentNode.classList.contains('inc_product_desc_att_block') == false) {
                                        attr_block = type_of.parentNode.parentNode.parentNode.parentNode
                                    } else {
                                        attr_block = type_of.parentNode.parentNode.parentNode
                                    }
                                } else {
                                    attr_block = type_of.parentNode.parentNode
                                }
                                if (type_of.parentNode.parentNode.parentNode.classList.contains('inc_product_desc_att_block') == true) {
                                    attr_block = type_of.parentNode.parentNode.parentNode
                                }
                                if (type_of.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_desc_att_block') == true) {
                                    attr_block = type_of.parentNode.parentNode.parentNode.parentNode
                                }
                                var opt_text = attr_block.getAttribute('data-zero');
                                var opt_size_text = attr_block.getAttribute('data-size');
                                var opt_color_text = attr_block.getAttribute('data-color');

                                if (opt_size_text == undefined) {
                                    var opt_size_text = ""
                                }
                                if (opt_color_text == undefined) {
                                    var opt_color_text = ""
                                }
                                if (opt_text != "" && opt_size_text != "" && opt_color_text != "") {
                                    if (productListObj[mainProductId][childProductId].option[1] != undefined && productListObj[mainProductId][childProductId].option[2] != undefined && productListObj[mainProductId][childProductId].option[0] != undefined) {
                                        if (productListObj[mainProductId][childProductId].option[1].text == opt_text && productListObj[mainProductId][childProductId].option[2].text == opt_size_text && productListObj[mainProductId][childProductId].option[0].text == opt_color_text) {
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]] = {};
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["colorCode"] = "";
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = "";
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["3"]["titleText"];

                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["3"]["imgSrc"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["3"]["code"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["3"]["cpid"];
                                            productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["3"]["activePriceChild"];
                                        }
                                    }
                                } else {
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]] = {};
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["colorCode"] = "";
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = "";
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["3"]["titleText"];

                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["3"]["imgSrc"];
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["3"]["code"];
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["3"]["cpid"];
                                    productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["3"]["activePriceChild"];
                                }
                            } else {
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]] = {};
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["colorCode"] = "";
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = "";
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["titleText"] = productListObj[mainProductId][childProductId]["option"]["3"]["titleText"];

                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["imgSrc"] = productListObj[mainProductId][childProductId]["option"]["3"]["imgSrc"];
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["code"] = productListObj[mainProductId][childProductId]["option"]["3"]["code"];
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["cpid"] = productListObj[mainProductId][childProductId]["option"]["3"]["cpid"];
                                productColorArrayObj[productListObj[mainProductId][childProductId]["option"]["3"]["text"]]["prc"] = productListObj[mainProductId][childProductId]["option"]["3"]["activePriceChild"];
                            }
                        }
                    }
                }
            }
        }

        Object.keys(productColorArrayObj).forEach(function(colorText) {
            var attr3Obj = {}
            attr3Obj["text"] = colorText;
            attr3Obj["imgSrc"] = productColorArrayObj[colorText]["imgSrc"];
            attr3Obj["titleText"] = productColorArrayObj[colorText]["titleText"];
            attr3Obj["code"] = productColorArrayObj[colorText]["code"];
            attr3Obj["cpid"] = productColorArrayObj[colorText]["cpid"];
            attr3Obj["prc"] = productColorArrayObj[colorText]["prc"];
            product3ObjArray.push(attr3Obj);
        });

        product3Obj["att3Array"] = product3ObjArray;

        return product3Obj;
    }
    function getProductByAtt(findObj) {
        var childProductObj = {};
        var productListObj = INC.dataStore.dataStoreObj;
        if (findObj.mainId != undefined && productListObj != undefined) {
            var mainProductListObj = productListObj[findObj.mainId];
        } else {
            var mainProductListObj = ""
        }
        for (childProductId in mainProductListObj) {
            if (findObj.zeroText != "" && findObj.sizeText != "" && findObj.colorText != "" && findObj.thirdText != "" && mainProductListObj[childProductId]["option"]["0"] != undefined && mainProductListObj[childProductId]["option"]["1"] != undefined && mainProductListObj[childProductId]["option"]["2"] != undefined && mainProductListObj[childProductId]["option"]["3"] != undefined) {
                if (findObj.colorText == mainProductListObj[childProductId]["option"]["0"].text && findObj.zeroText == mainProductListObj[childProductId]["option"]["1"].text && findObj.sizeText == mainProductListObj[childProductId]["option"]["2"].text && findObj.thirdText == mainProductListObj[childProductId]["option"]["3"].text) {
                    childProductObj = mainProductListObj[childProductId];
                    return childProductObj;
                }
            } else if (findObj.zeroText != "" && findObj.sizeText != "" && findObj.colorText != "" && mainProductListObj[childProductId]["option"]["0"] != undefined && mainProductListObj[childProductId]["option"]["1"] != undefined && mainProductListObj[childProductId]["option"]["2"] != undefined) {
                if (findObj.colorText == mainProductListObj[childProductId]["option"]["0"].text && findObj.zeroText == mainProductListObj[childProductId]["option"]["1"].text && findObj.sizeText == mainProductListObj[childProductId]["option"]["2"].text) {
                    childProductObj = mainProductListObj[childProductId];
                    return childProductObj;
                }
            } else if (findObj.zeroText != "" && findObj.colorText != "" && mainProductListObj[childProductId]["option"]["0"] != undefined && mainProductListObj[childProductId]["option"]["1"] != undefined) {
                if (findObj.colorText == mainProductListObj[childProductId]["option"]["0"].text && findObj.zeroText == mainProductListObj[childProductId]["option"]["1"].text) {
                    childProductObj = mainProductListObj[childProductId];
                    return childProductObj;
                }
            } else if (findObj.zeroText == "" && findObj.sizeText == "" && findObj.thirdText == "" && findObj.colorText != "" && mainProductListObj[childProductId]["option"]["0"] != undefined && mainProductListObj[childProductId]["option"]["1"] != undefined) {
                if (findObj.colorText == mainProductListObj[childProductId]["option"]["0"].text) {
                    childProductObj = mainProductListObj[childProductId];
                    return childProductObj;
                }
            } else if (findObj.zeroText != "" && findObj.sizeText == "" && findObj.thirdText == "" && findObj.colorText == "" && mainProductListObj[childProductId]["option"]["1"] != undefined) {
                if (findObj.zeroText == mainProductListObj[childProductId]["option"]["1"].text) {
                    childProductObj = mainProductListObj[childProductId];
                    return childProductObj;
                }
            } else if (mainProductListObj[childProductId]["option"] != null && mainProductListObj[childProductId]["option"] != undefined && mainProductListObj[childProductId]["option"]["0"] != null && mainProductListObj[childProductId]["option"]["0"] != undefined && (findObj.colorText == mainProductListObj[childProductId]["option"]["0"].text)) {
                childProductObj = mainProductListObj[childProductId];
                return childProductObj;

            } else if (mainProductListObj[childProductId]["option"] != null && mainProductListObj[childProductId]["option"] != undefined && mainProductListObj[childProductId]["option"]["1"] != null && mainProductListObj[childProductId]["option"]["1"] != undefined && (findObj.sizeText == mainProductListObj[childProductId]["option"]["1"].text)) {
                childProductObj = mainProductListObj[childProductId];
                return childProductObj;

            }
        }
        return childProductObj;
    }

    return {
        buildDataStoreObj: buildDataStoreObj,
        getFirstProductObjByMainId: getFirstProductObjByMainId,
        getProductById: getProductById,
        getProductBySKU: getProductBySKU,
        getUniqueCatergories: getUniqueCatergories,
        getProductColorsObj: getProductColorsObj,
        getProductSizesObj: getProductSizesObj,
        getProductopt3Obj: getProductopt3Obj,
        getProductopt0Obj: getProductopt0Obj,
        getProductByAtt: getProductByAtt
    }
}

INC.classes = {};
INC.classes.ProductObj = function(product) {
    this.bundleId = "";
    this.id = ((product != null) && (product != undefined)) ? product["ProductId"] : "";
    this.sku = ((product != null) && (product != undefined)) ? product["ProductSku"] : "";
    this.mainsku = ((product != null) && (product != undefined)) ? product["ProductSku"] : "";
    this.childsku = ((product != null) && (product != undefined)) ? product["ProductSku"] : "";
    this.name = ((product != null) && (product != undefined)) ? product["ProductName"] : "";
    this.url = product["ProductUrl"]
    this.imageURL = ((product != null) && (product != undefined)) ? product["ImageURL"].replace('pngg', 'png') : "";
    this.regularPrice = ((product != null) && (product != undefined)) ? product["Price"] : "";
    this.activePrice = ((product != null) && (product != undefined)) ? ((product["SpecialPrice"] != null) ? product["SpecialPrice"] : product["Price"]) : "";
    this.otherImageList = ((product != null) && (product != undefined)) ? product["OtherImageList"] : [];
    this.size = ((product != null) && (product != undefined)) ? ((product["Size"] != null) ? product["Size"] : "") : "";
    this.option = {};
    this.mainId = ((product != null) && (product != undefined)) ? product["ProductId"] : "";
    this.categoryName = ((product != null) && (product != undefined)) ? product["CategoryName"] : "";
    this.categoryId = ((product != null) && (product != undefined)) ? product["CategoryId"] : "";
    this.description = ((product != null) && (product != undefined)) ? product["Description"] : "";
    this.shortDescription = ((product != null) && (product != undefined)) ? product["ShortDescription"] : "";
    this.ratingsCount = ((product != null) && (product != undefined)) ? product["Rating"] : "";
    this.pricingCount = ((product != null) && (product != undefined)) ? product["Field6"] : "";
    this.reviewsCount = ((product != null) && (product != undefined)) ? product["RatingCount"] : "";
    if (product["PromotionalMessage"] != null) {
        this.PromotionalMessage = product["PromotionalMessage"];
    } else {
        this.PromotionalMessage = ""
    }
    if (product["ProductLevelDiscountMessage"] != null) {
        this.ProductLevelDiscountMessage = product["ProductLevelDiscountMessage"]
    } else {
        this.ProductLevelDiscountMessage = ""
    }
    this.worthPrice = ((product != null) && (product != undefined)) ? product["Field5"] : "";
    this.ProductType = ((product != null) && (product != undefined)) ? product["ProductType"] : "";
    this.regularPriceMain = ((product != null) && (product != undefined)) ? product["Price"] : "";
    this.activePriceMain = ((product != null) && (product != undefined)) ? ((product["SpecialPrice"] != null) ? product["SpecialPrice"] : product["Price"]) : "";
    this.nameMain = ((product != null) && (product != undefined)) ? ((INC.config.language == "en") ? product["ProductName"] : product["ProductName"]) : "";
    this.imageURLMain = ((product != null) && (product != undefined)) ? product["ImageURL"].replace('pngg', 'png') : "";
    this.urlMain = ((product != null) && (product != undefined)) ? product["ProductUrl"] : "";
}
INC.classes.ProductAttObj = function(product) {
    this.bundleId = "";
    this.id = ((product != null) && (product != undefined)) ? product["childProductId"] : "";
    this.sku = ((product != null) && (product != undefined)) ? product["childProductSku"] : "";
    this.mainsku = ((product != null) && (product != undefined)) ? product["mainSKU"] : "";
    this.childsku = ((product != null) && (product != undefined)) ? product["childProductSku"] : "";
    this.name = ((product != null) && (product != undefined)) ? ((INC.config.language == "en") ? product["childProductName"] : product["childProductName"]) : '';
    this.url = ((product != null) && (product != undefined)) ? product["childProductUrl"] : "";
    this.imageURL = ((product != null) && (product != undefined)) ? product["childProductImageUrl"].replace('pngg', 'png') : "";
    this.regularPrice = ((product != null) && (product != undefined)) ? product["childProductPrice"] : "";
    this.activePrice = ((product != null) && (product != undefined)) ? ((product["childProductSpecialPrice"] != null) ? product["childProductSpecialPrice"] : product["childProductPrice"]) : "";
    if (product["promotionalMessage"] != null) {
        this.PromotionalMessage = product["promotionalMessage"];
    } else {
        this.PromotionalMessage = ""
    }
    if (product["productLevelDiscountMessage"] != null) {
        this.ProductLevelDiscountMessage = product["productLevelDiscountMessage"]
    } else {
        this.ProductLevelDiscountMessage = ""
    }
    this.otherImageList = ((product != null) && (product != undefined)) ? product["childProductOtherImageUrl"] : [];

    this.size = "";
    this.option = {};
    if (((product != null) && (product != undefined))) {
        this.option[product["optionId"]] = {};
        this.option[product["optionId"]].text = product["optionText"];
        this.option[product["optionId"]].titleText = (product["childProductField2"] != null) ? product["childProductField2"] : "";
        this.option[product["optionId"]].imgSrc = (product["optionImageUrl"] != null) ? product["optionImageUrl"] : "";
        this.option[product["optionId"]].colorCode = (product["colorCode"] != null) ? product["colorCode"] : "";
        this.option[product["optionId"]].cpid = (product["childProductId"] != null) ? product["childProductId"] : "";
    }
    this.categoryName = ((product != null) && (product != undefined)) ? product["childCategoryName"] : "";
    this.categoryId = ((product != null) && (product != undefined)) ? product["childCategoryId"] : "";
    this.description = ((product != null) && (product != undefined)) ? product["childProductDescription"] : "";
    this.shortDescription = ((product != null) && (product != undefined)) ? ((INC.config.language == "en") ? product["ShortDescription"] : product["Field5"]) : "";
    this.ratingsCount = ((product != null) && (product != undefined)) ? product["childRating"] : "";
    this.pricingCount = ((product != null) && (product != undefined)) ? product["childProductField6"] : product["Field6"];
    this.reviewsCount = ((product != null) && (product != undefined)) ? product["childreviewsCount"] : "";
    this.worthPrice = ((product != null) && (product != undefined)) ? product["Field5"] : "";
    this.ProductType = ((product != null) && (product != undefined)) ? product["ProductType"] : "";

    this.regularPriceMain = product["childProductPriceMain"];
    this.activePriceMain = ((product != null) && (product != undefined)) ? ((product["childProductSpecialPriceMain"] != null) ? product["childProductSpecialPriceMain"] : product["childProductPriceMain"]) : "";
    this.nameMain = ((product != null) && (product != undefined)) ? ((INC.config.language == "en") ? product["childProductNameMain"] : product["childProductNameMain"]) : "";
    this.imageURLMain = ((product != null) && (product != undefined)) ? ((INC.config.language == "en") ? product["childProductImageUrlMain"].replace('pngg', 'png') : product["childProductImageUrlMain"].replace('pngg', 'png')) : "";
    this.urlMain = ((product != null) && (product != undefined)) ? product["childProductUrlMain"] : "";
}
INC.classes.FindObj = function(findObj) {
    this.id = (findObj != null && findObj != undefined) ? findObj.id : "";
    this.sku = (findObj != null && findObj != undefined) ? findObj.sku : "";
    this.mainId = (findObj != null && findObj != undefined) ? findObj.mainId : "";
    this.colorText = (findObj != null && findObj != undefined) ? findObj.colorText : "";
    this.sizeText = (findObj != null && findObj != undefined) ? findObj.sizeText : "";
}

INC.classes.NWConfig = function(nwConfigObj) {
    this.url = (nwConfigObj != null && nwConfigObj != undefined) ? nwConfigObj.url : "";
    this.method = (nwConfigObj != null && nwConfigObj != undefined) ? nwConfigObj.method : "GET";
    this.params = (nwConfigObj != null && nwConfigObj != undefined) ? nwConfigObj.params : "";
}

INC.methods = {};
INC.methods.networkReq = function(nwConfigObj, cb) {
    var nwConfigObj = new INC.classes.NWConfig(nwConfigObj);
    var xhr = new XMLHttpRequest();
    xhr.open(nwConfigObj.method, nwConfigObj.url, true);
    xhr.onload = function() {}
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status === 200) {
            if (xhr.response != "") {
                if (INC.config.pageType == "pdp" && document.querySelector('.kaxsdc') != null) {
                    cb(xhr.response);
                } else {
                    cb(xhr.response);
                }
                if (INC.config.pageType == "pdp") {
                    var p_ids = INC.methods.getProductIdFromWebPage()
                    // INC.methods.irbReq_is_tc(p_ids, 10, "catalog_product_view");
                }
            } else {
                if (INC.config.pageType == "productList") {
                    INC.config.modal_called = true
                }
            }
        }
    }
    xhr.send(JSON.stringify(nwConfigObj.params));
}

INC.methods.irbReq = function(productId, bundleCount, elementName) {
    var elementName = elementName || "";
    var productId = productId;
    var apiKey = INC.config.clientToken;
    var bundleReqCount = bundleCount || 5;
    var irbPATH = "//rapidload.increasingly.co/increasingly_bundles?irb/";
    if (INC.config.pageType == "pdp" || INC.config.pageType == "cartPage") {
        var irbReqParams = "product_ids=" + productId + "&category_id=" + "&api_key=" + apiKey + "&client_id=" + "&page_type=" + elementName + "&fr=" + "1" + "&client_visitor_id=" + INC.config.ivid;
    } else {
        var irbReqParams = "product_ids=" + productId + "&category_id=" + "&api_key=" + apiKey + "&client_id=" + "&page_type=" + elementName + "&fr=" + "1" + "&client_visitor_id=" + INC.config.ivid + "&is_tc=" + "1" + "&no_of_bundles=" + bundleReqCount;
    }
    var irbReqURL = decodeURI(irbPATH + btoa(irbReqParams));
    var networkConfigObj = new INC.classes.NWConfig();
    networkConfigObj["url"] = irbReqURL;
    return this.refreshBundles(networkConfigObj);
}

INC.methods.refreshBundles = function(nwConfigObj) {
    var incDataStore = INC.dataStore;
    INC.methods.networkReq(nwConfigObj, function(response) {
        if (response.length == 0)
            return;
        if (typeof (response) != "object") {
            var responseJSON = JSON.parse(response);
        } else {
            var responseJSON = response;
        }
        if (responseJSON.hasOwnProperty('Bundles') && (responseJSON.Bundles != null)) {
            INC.config.recommendation = false;
            responseJSON.timeStamp = Date.now();
            var bundleResponse = responseJSON;
            INC.dataStore.methods().buildDataStoreObj(bundleResponse);
            if ((incDataStore.dataStoreObj == null) || (incDataStore.dataStoreObj == undefined))
                return;
            switch (INC.config.pageType) {
            case "pdp":
                // INC.methods.createPDPBlock();
                INC.methods.createAMBlock("PDP");
                break;
            case "cartPage":
                INC.methods.createAMBlock();
                break;
            case "productList":
                INC.methods.createSidebarBlock();
                INC.methods.showSidebar();
                break;
            }
        } else if (responseJSON.hasOwnProperty('CategoryRecommendations') && (responseJSON.CategoryRecommendations.length > 0)) {
            responseJSON.timeStamp = Date.now();
            var bundleResponse = responseJSON;
            INC.dataStore.methods().buildDataStoreObj(bundleResponse);
            if ((incDataStore.dataStoreObj == null) || (incDataStore.dataStoreObj == undefined))
                return;
            INC.config.recommendation = true
            switch (INC.config.pageType) {
            case "pdp":
                INC.methods.createAMBlock("PDP");
                break;
            }
        }
    });
}
INC.methods.irbReq_is_tc = function(productId, bundleCount, elementName) {
    var elementName = elementName || "";
    var productId = productId;
    var apiKey = INC.config.clientToken;
    var bundleReqCount = bundleCount || 5;
    var irbPATH = "//rapidload.increasingly.co/increasingly_bundles?irb/";
    var irbReqParams = "product_ids=" + productId + "&category_id=" + "&api_key=" + apiKey + "&client_id=" + "&page_type=" + elementName + "&fr=" + "1" + "&client_visitor_id=" + INC.config.ivid + "&is_tc=" + "1" + "&no_of_bundles=" + bundleReqCount;

    var irbReqURL1 = decodeURI(irbPATH + btoa(irbReqParams));
    var networkConfigObj = new INC.classes.NWConfig();
    networkConfigObj["url"] = irbReqURL1;
    var xhr = new XMLHttpRequest();
    xhr.open("GET", networkConfigObj["url"], true);
    xhr.onload = function() {}
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status === 200) {
            if (xhr.response != "") {
                if (INC.config.pageType == "pdp") {
                    cb_tc(JSON.parse(xhr.response));
                }
            }
        }
    }
    xhr.send(JSON.stringify(networkConfigObj["params"]));
}
INC.methods.get_product_ratings = function(filed3, field2, rating_containers) {
    var reviewc = filed3
    var count = document.createElement('span');
    count.classList.add('rating_count')
    rating_containers.appendChild(count);
    var avg = document.createElement('span');
    avg.classList.add('rating_avg')
    if (field2 == undefined) {
        count.textContent = "(0)";
    } else {
        count.textContent = "(" + field2 + ")";

    }
    if (filed3 != undefined && filed3 != "") {
        var rating = filed3;
        var reviewc = field2
        if (rating == "" || rating == undefined || rating == "NaN" || rating == "norating") {
            rating = 0
        }
        var ratingAvg = filed3
        rating = parseFloat(rating).toFixed(1)
        rating = rating.toString();
        var rating_m = null;
        var rating_container = rating_containers;
        if (rating != 0 && rating != 1 && rating != 2 && rating != 3 && rating != 4 && rating != 5) {
            rating_m = rating.replace(".", "-");
        }
        if (rating == 0) {
            rating = "0-0"
        }
        if (rating == 1) {
            rating = "1-0"
        }
        if (rating == 2) {
            rating = "2-0"
        }
        if (rating == 3) {
            rating = "3-0"
        }
        if (rating == 4) {
            rating = "4-0"
        }
        if (rating == 5) {
            rating = "5-0"
        }
        if (rating == "") {
            rating = 0;
        }
        if ((rating_m != null && rating_m != "NaN")) {
            rating_containers.classList.add("rating_" + rating_m);
        } else if (isNaN(rating_m)) {
            rating_containers.classList.add("rating_" + rating);
        } else {
            rating_containers.classList.add("rating_" + rating);
        }

        var stars = document.createElement('span');
        stars.classList.add('rating_stars');
        rating_containers.appendChild(stars);
    } else {
        var stars = document.createElement('span');
        stars.innerText = "."
        stars.style.color = "#fff"
        stars.classList.add('rating_stars');
        stars.classList.add('noratings');
        rating_containers.appendChild(stars);
    }
}
INC.methods.getProductIdFromWebPage = function() {
    var product_id = '';
    if (window.location.href.indexOf('orders/offers') != null) {
        product_id = 'dummy'
    } 
    INC.config.Product_id = product_id
    return product_id;
}

INC.methods.detectPageType = function() {
    if (window.location.href.indexOf('orders/offers') >= 0) {
        return "pdp";
    } 
    if (window.location.href.indexOf('orders/cart') >= 0) {
        return "cartPage";
    } 
}
INC.methods.detectDeviceType = function () {
    if (window.innerWidth > 820) {
        return "desktop";
    } else {
        return "mobile";
    }
}
INC.methods.showSidebar = function() {
    if (document.querySelector('.inc_sidebar_modal_block') != null) {
        if (document.querySelector('.sidebar_outer') != null) {
            var elSidebarOverlay = document.querySelector(".inc_sidebar_overlay_block");
            if (elSidebarOverlay != null) {
                elSidebarOverlay.style.display = "block";
            }
            document.querySelector('.sidebar_outer').style.display = "block"
            document.querySelector('.inc_sidebar_modal_block').style.display = "block"
            document.querySelector('.inc_sidebar_modal_block').classList.add('inc_active')
            document.querySelector('.sidebar_outer').classList.add('sidebar_outer_active')
        }
        setTimeout(function() {
            _isVisible._init({
                classSelector: ".inc_pdp_block source[data-src], .inc_sidebar_modal_block img[data-src], .inc_sidebar_modal_block source[data-src]",
                index: 0
            });
        }, 2000)
    }
    if (document.querySelector('.inc_pdp_bundle_cart_summary_add_btn_block') != null) {
        document.querySelector('.inc_pdp_bundle_cart_summary_add_btn_block').classList.remove('inc_loading');
    }
}
INC.methods.hideSidebar = function() {
    INC.config.sidebarremovedprod = []
    document.querySelector('html').style = '';
    document.querySelector('html').classList.remove('inc_overlay')
    document.querySelector('body').classList.remove('inc_popup_open');
    if (document.querySelector('.sidebar_outer') != null) {
        document.querySelector('.inc_sidebar_modal_block').style.display = "none"
        document.querySelector('.sidebar_outer').style.display = "none"
        document.querySelector('.sidebar_outer').classList.remove('sidebar_outer_active')
    }
    var allchecked = document.querySelectorAll('.inc_pdp_bundle_product_list_main_block .inc_product_showcase_block .inc_product_desc_add_img.checked')
    for (re = 0; re < allchecked.length; re++) {
        if (allchecked[re] != undefined) {
            allchecked[re].click()
        }
    }
    INC.config.pdpaddedProductList = Object.keys(INC.dataStore.bundleCartProducts)
    if (window.innerWidth > 767) {
        if (document.querySelector('.sidebar_outer') != null) {
            Array.prototype.forEach.call(document.querySelectorAll('.sidebar_outer'), function(el) {
                el.parentNode.removeChild(el);
            });

            Array.prototype.forEach.call(document.querySelectorAll(".sidebar_outer"), function(el) {
                el.parentNode.removeChild(el);
            });
            Array.prototype.forEach.call(document.querySelectorAll(".inc_sidebar_overlay_block"), function(elm) {
                elm.parentNode.removeChild(elm);
            });
        }
    } else {
        Array.prototype.forEach.call(document.querySelectorAll(".inc_sidebar_overlay_block"), function(elm) {
            elm.parentNode.removeChild(elm);
        });
    }
    setTimeout(function() {
        if (document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block') != null) {
            document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block').classList.remove('is_special_ecirp');
        }
    }, 30)
    window.location.reload();
}
INC.methods.createAMBlock = function(PDP_type) {
    if (INC.dataStore.dataStoreObj.undefined == undefined) {
        document.querySelector('html').classList.add('inc-prevent-hor-scroll');
        var amBlock = generate_html_tag('div', 'inc_af_block')
        amBlock.classList.add('af_cart_page')
        amBlock.innerHTML = cart_html
        if (document.querySelector('.o-navigation__bag .a-bag-count') != null) {
            var totalbagcountside = document.querySelector('.o-navigation__bag .a-bag-count').innerText
            if (totalbagcountside == 0) {
                amBlock.style.display = "none"
            }
        }
        amBlock.querySelector(".inc_af_product-list_block").innerHTML = "";
        var elAmTitleText = amBlock.querySelector(".inc_af_title_text_block")
        if (PDP_type == "PDP" || PDP_type == "productList") {
            elAmTitleText.innerText = "Other customers also viewed";
        }
        var productListObj = INC.dataStore.dataStoreObj;
        var productListArray = Object.keys(productListObj);
        var amProductListBlock = amBlock.querySelector(".inc_af_product-list_block");
        var bundleProductsArray = INC.dataStore.bundleProductsArray;
        if (INC.config.pageType == "pdp") {
            if (INC.dataStore.bundleProductsArray.indexOf(INC.config.Product_id) == -1){
                INC.dataStore.bundleProductsArray.push(INC.config.Product_id)
                INC.config.cartproductids = []
            }
        }
        var bundle_avail_=false
        var addeddupl = []
        var p_count = 0
        var duplamid = []
        var countmodule = 0
        if (PDP_type == "PDP") {
            bundleProductsArray.forEach(function(mainProductId) {
                if (duplamid.indexOf(mainProductId) == -1) {
                    duplamid.push(mainProductId)
                    if(INC.config.DealProducts.indexOf(mainProductId) >= 0){
                        if(mainProductId != "dummy"){
                        	bundle_avail_ = true
                            amProductListBlock.appendChild(INC.methods.createProductModuleBlock(mainProductId, "am", false, amBlock));
                            elAmTitleText.innerText = "Produse de top cu reduceri";
                        }
                    }
                }
            });
        } else {
            bundleProductsArray.forEach(function(mainProductId) {
                if (duplamid.indexOf(mainProductId) == -1) {
                    duplamid.push(mainProductId)
                    if(mainProductId != "dummy"){
                        if (INC.config.cartproductids.indexOf(mainProductId) == -1) {
                            if (INC.config.recommendation == false) {
                                var firstProductObjByMainId = INC.dataStore.methods().getFirstProductObjByMainId({
                                    mainId: mainProductId
                                });
                                var prd_module = INC.methods.createProductModuleBlock(firstProductObjByMainId.id, "am", false, amBlock);
                            } else {
                                var firstProductObjByMainId = INC.dataStore.methods().getFirstProductObjByMainId({
                                    mainId: mainProductId
                                });
                                var prd_module = INC.methods.createProductModuleBlock(firstProductObjByMainId.id, "am", false, amBlock);
                            }
                            bundle_avail_ = true
                            if (prd_module.getAttribute('data-id') != "undefined") {
                            	
                                amProductListBlock.appendChild(prd_module);
                                elAmTitleText.innerText = "Cele mai vandute produse";
                                countmodule++
                            }
                        }
                    }
                }
            });
        }

        var amProductBlocks = amBlock.querySelectorAll('.inc_product_block');
        Array.prototype.forEach.call(amProductBlocks, function(productBlock) {
            productBlock.querySelector('.inc_product_desc_add_block').addEventListener("click", function(e) {
                var productBlockNode = this.parentNode.parentNode;
                var flag_check = INC.methods.checkVariantSelection(productBlockNode)
                if (INC.config.pageType != "cartPage") {
                    if (this.parentNode.parentNode.className == "inc_product_desc_block") {
                        productBlockNode = this.parentNode.parentNode.parentNode.parentNode
                    }
                    if (productBlockNode.classList.contains('inc_product_block') == true) {
                        productBlockNode = productBlockNode.parentNode.parentNode
                    }
                    var sku = productBlockNode.getAttribute('data-sku');
                    var findObj = new INC.classes.FindObj({
                        id: sku
                    });
                    var qty = productBlockNode.querySelector('input').value;
                    var add_btn = productBlockNode.querySelector('.inc_product_add_text')
                    var add_btn_click = productBlockNode.querySelector('.inc_product_add_text');
                    var add_prod_im = productBlockNode.querySelectorAll('.inc_product_desc_add_img');
                    if (flag_check == 1 && productBlockNode.querySelector('.inc_product_add_text_block.disable_btn') == null) {
                        if(productBlockNode.classList.contains('configurable') == true && document.querySelector('.inc_product_modal_block.inc_active') == null){
                            productBlockNode.querySelector('.inc_product_img_main_img').click()
                        }else{
                            if (this.parentNode.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_showcase_block') == true || this.parentNode.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_modal_block') == true) {
                                var newbtntext = productBlockNode.querySelector('.inc_product_modal_block .inc_product_desc_add_text')
                                if(document.querySelector('.fullscreen-spinner') != null){
                                    document.querySelector('.fullscreen-spinner').style.display = "block"
                                }
                                var btnclick = productBlockNode.querySelector('.inc_product_add_text')
                                newbtntext.textContent = INC.config.adding_text + "..."
                                btnclick.textContent = INC.config.adding_text + "...";
                                var selbtn = productBlockNode.querySelector('.inc_product_variant_simple_text')
                                selbtn.textContent = INC.config.adding_text + "...";
                                setTimeout(function(){
                                    INC.methods.addProductToCart(findObj, qty, "am", productBlockNode, btnclick, add_prod_im, selbtn, newbtntext);
                                },300)
                            }
                        }
                    }
                }
            });
        });
        var prod_sl_c = 1
        if (amBlock != null) {
            Array.prototype.forEach.call(document.querySelectorAll('.inc_af_block'), function(el) {
                el.parentNode.removeChild(el);
            });
        }
        if(bundle_avail_ == false){
        	amBlock.style.display="none"
        }
        if (document.querySelector('body') != null) {
            // if (PDP_type == "PDP") {
                var CartPos = document.querySelector('.disc-section')
                if(CartPos != null){
                    var offersibling = CartPos.parentNode
                    offersibling.parentNode.insertBefore(amBlock, offersibling)
                }
            // } else{
            //     var CartPos = document.querySelector('#cadru_automat')
            //     if(CartPos != null){
            //         CartPos.parentNode.insertBefore(amBlock, CartPos)
            //     }
            // }
        }
        if (INC.config.pageType == "cartPage") {
            var inc_checkout_bk = generate_html_tag('div','inc_checkout_bk');
            amBlock.appendChild(inc_checkout_bk)
            
            var inc_checkout_prc_bk = generate_html_tag('div','inc_checkout_prc_bk');
            inc_checkout_bk.appendChild(inc_checkout_prc_bk)
            var inc_checkout_prc_title = generate_html_tag('div','inc_checkout_prc_title');
            inc_checkout_prc_title.innerText = "Pretul Total"
            inc_checkout_prc_bk.appendChild(inc_checkout_prc_title)
            var inc_checkout_prc_blk = generate_html_tag('div','inc_checkout_prc_blk');
            inc_checkout_prc_bk.appendChild(inc_checkout_prc_blk)
            
            var inc_checkout_prc_active_text = generate_html_tag('div','inc_checkout_prc_active_text');
            inc_checkout_prc_active_text.innerText = "00.00 Lei"
            inc_checkout_prc_blk.appendChild(inc_checkout_prc_active_text)
            var inc_checkout_prc_regular_text = generate_html_tag('div','inc_checkout_prc_regular_text');
            inc_checkout_prc_blk.appendChild(inc_checkout_prc_regular_text)

            var inc_basket_btn = generate_html_tag('div','inc_basket_btn');
            inc_checkout_bk.appendChild(inc_basket_btn)

            var inc_chk_add_btn = generate_html_tag('div','inc_chk_add_btn');
            //Adaugă 1 produse în coș
            inc_chk_add_btn.innerText = "Adaugă coș"
            inc_checkout_bk.classList.add('disable_btn')
            inc_chk_add_btn.setAttribute('style','pointer-events: none;opacity: 0.5;')
            // inc_checkout_prc_bk.setAttribute('style','visibility: hidden;')
            inc_basket_btn.appendChild(inc_chk_add_btn)

            inc_chk_add_btn.addEventListener('click',function(){
                inc_chk_add_btn.classList.add('inc_loading')
                add_multiple_prod(inc_chk_add_btn)
            })
        }
        amBlock.querySelector('.inc_af_right_btn_block').style.visibility = "hidden";
        amBlock.querySelector('.inc_af_right_btn_img').style.visibility = "hidden";
        amBlock.querySelector('.inc_af_left_btn_block').style.visibility = "hidden";
        amBlock.querySelector('.inc_af_left_btn_img').style.visibility = "hidden";
        var productBlocks = amProductListBlock.querySelectorAll('.inc_product_module_block');
        var sliderBtnCounter = 0;
        if (productBlocks.length > prod_sl_c) {
            amBlock.querySelector('.inc_af_right_btn_block').style.visibility = "visible";
            amBlock.querySelector('.inc_af_left_btn_block').style.visibility = "visible";
            amBlock.querySelector('.inc_af_left_btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
            amBlock.querySelector('.inc_af_right_btn_img').style.visibility = "visible";
            amBlock.querySelector('.inc_af_left_btn_img').style.visibility = "visible";
            amBlock.querySelector('.inc_af_left_btn_img').setAttribute("style", "pointer-events: none;opacity:0.5");
        }
        var cc_ount = 1;
        if (window.innerWidth > 768) {
            cc_ount = 4
        }
        if (productBlocks.length <= cc_ount) {
            amBlock.querySelector('.inc_af_right_btn_block').style.visibility = "hidden";
            amBlock.querySelector('.inc_af_right_btn_img').style.visibility = "hidden";
            amBlock.querySelector('.inc_af_left_btn_block').style.visibility = "hidden";
            amBlock.querySelector('.inc_af_left_btn_img').style.visibility = "hidden";
        }
        amBlock.querySelector('.inc_af_right_btn_block').addEventListener("click", function() {
            sliderBtnCounter++;
            if (sliderBtnCounter > productBlocks.length - 1) {
                sliderBtnCounter--;
            }
            var all_p_length = document.querySelectorAll('.inc_af_product-list_block .inc_product_module_block').length
            var cc_ount = 1;
            if (window.innerWidth > 768) {
                cc_ount = 4
            }
            var width_slide = ""
            if (INC.config.pageType == "pdp" || INC.config.pageType == "productList") {
                width_slide=document.querySelector('.inc_product_module_block').clientWidth
            } else {
                width_slide=document.querySelector('.inc_product_module_block').clientWidth
            }
            if (+INC.clientConfig.slidevalue + +cc_ount < all_p_length) {
                amBlock.parentNode.parentNode.querySelector('.inc_af_left_btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
                amBlock.parentNode.parentNode.querySelector('.inc_af_left_btn_img').setAttribute("style", "pointer-events: auto;opacity:1");
                INC.clientConfig.slidevalue++
                INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) - width_slide) + 'px';
                var menu = amBlock.parentNode.parentNode.querySelector('.inc_af_product-list_block');
                menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
                if (document.querySelector('.inc_af_product-list-dots-main_block .inc_dots.inc_active') != null) {
                    document.querySelector('.inc_af_product-list-dots-main_block .inc_dots.inc_active').classList.remove('inc_active')
                }
                if (document.querySelectorAll('.inc_af_product-list-dots-main_block .inc_dots')[+INC.clientConfig.slidevalue] != null)
                    document.querySelectorAll('.inc_af_product-list-dots-main_block .inc_dots')[+INC.clientConfig.slidevalue].classList.add('inc_active')
            }

            if (+INC.clientConfig.slidevalue + +cc_ount == all_p_length) {
                amBlock.parentNode.parentNode.querySelector('.inc_af_right_btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                amBlock.parentNode.parentNode.querySelector('.inc_af_right_btn_img').setAttribute("style", "pointer-events: none;opacity:0.5");
            }
        });

        amBlock.querySelector('.inc_af_left_btn_block').addEventListener("click", function() {
            sliderBtnCounter--;
            if (sliderBtnCounter == -1)
                sliderBtnCounter = 0;
            var all_p_length = document.querySelectorAll('.inc_af_product-list_block .inc_product_module_block').length
            if (INC.clientConfig.slidevalue == -1)
                INC.clientConfig.slidevalue = 0;
            var width_slide = ""
            if (INC.config.pageType == "pdp" || INC.config.pageType == "productList") {
                width_slide=document.querySelector('.inc_product_module_block').clientWidth
            } else {
                width_slide=document.querySelector('.inc_product_module_block').clientWidth
            }
            if (INC.clientConfig.slidevalue > 0) {
                amBlock.parentNode.parentNode.querySelector('.inc_af_right_btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
                amBlock.parentNode.parentNode.querySelector('.inc_af_right_btn_img').setAttribute("style", "pointer-events: auto;opacity:1");
                INC.clientConfig.slidevalue--
                INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) + width_slide) + 'px';
                var menu = amBlock.parentNode.parentNode.querySelector('.inc_af_product-list_block');
                menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
                if (document.querySelector('.inc_af_product-list-dots-main_block .inc_dots.inc_active') != null) {
                    document.querySelector('.inc_af_product-list-dots-main_block .inc_dots.inc_active').classList.remove('inc_active')
                }
                if (document.querySelectorAll('.inc_af_product-list-dots-main_block .inc_dots')[+INC.clientConfig.slidevalue] != null)
                    document.querySelectorAll('.inc_af_product-list-dots-main_block .inc_dots')[+INC.clientConfig.slidevalue].classList.add('inc_active')
            }
            if (INC.clientConfig.slidevalue == 0) {
                amBlock.parentNode.parentNode.querySelector('.inc_af_left_btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                amBlock.parentNode.parentNode.querySelector('.inc_af_left_btn_img').setAttribute("style", "pointer-events: none;opacity:0.5");
            }
        });
        setTimeout(function() {
            var all_list_el = document.querySelectorAll('.inc_af_product-list_block .inc_product_showcase_block')
            for (q1 = 0; q1 < all_list_el.length; q1++) {
                if (all_list_el[q1].querySelector('.inc_product_desc_att_zero_block.inc_active') != null) {
                    var clrtext = ""
                    if (document.querySelector('.js-size-picker-label p') != null) {
                        clrtext = document.querySelector('.js-size-picker-label p').innerText.toLocaleLowerCase()
                    }
                    var prd_moduleb = all_list_el[q1].parentNode
                    var main_idsd = prd_moduleb.getAttribute('data-main_id')
                    if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"]') != null) {
                        if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block') != null) {
                            prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block').click()
                        } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                            all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                        }
                    } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                        all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                    }
                }
            }
            onloadpdp = true
            _isVisible._init({
                classSelector: ".inc_pdp_block img[data-src], .inc_pdp_block source[data-src], .inc_sidebar_modal_block img[data-src], .inc_sidebar_modal_block source[data-src], .inc_af_block img[data-src], .inc_af_block source[data-src]",
                index: 0
            });
        }, 400)
    }
    if (document.querySelector('.inc_af_block') != null) {
        if (INC.config.pageType == "cartPage") {
            document.querySelector('.inc_af_block').classList.add('af_cart_page')
        } else if (INC.config.pageType == "pdp") {
            document.querySelector('.inc_af_block').classList.add('inc_recommendations')
        }
    }
}
INC.methods.createPDPBlock = function(sidebar) {
    document.querySelector('body').classList.add('inc_bundles');
    document.querySelector('html').classList.add('inc-prevent-hor-scroll');
    var empty_sidebarflag = false
    if (INC.dataStore.dataStoreObj[INC.config.Product_id] != undefined) {
        if (INC.dataStore.dataStoreObj[INC.config.Product_id][INC.config.Product_id] != undefined) {
            if (INC.dataStore.dataStoreObj[INC.config.Product_id][INC.config.Product_id].bundleId == "12345679") {
                empty_sidebarflag = true
            }
        }
    }
    if (sidebar != "sidebar") {
        if (INC.dataStore.dataStoreObj.undefined != undefined || empty_sidebarflag == false) {
            var pdpBlock = generate_html_tag('div', 'inc_pdp_block')
            pdpBlock.innerHTML = pdp_html
            pdpBlock.setAttribute('style', 'clear: both;')
            var modalTitle = pdpBlock.querySelector('.inc_pdp_title_text');
            modalTitle.innerText = INC.config.FBTTitle
            var productListObj = INC.dataStore.dataStoreObj;
            if (document.querySelector('.js-right-column-section .elc-service-view-renderer[data-rendered-view="product-notify-me"] .elc-product-notify-me-button') != null) {
                pdpBlock.style.display = "none"
            }
            var pdpProductId = INC.dataStore.methods().getFirstProductObjByMainId({
                mainId: INC.dataStore.pdpProductId
            }).id;
            //if (window.innerWidth > 820) {
                var mainProductBlock = this.createProductModuleBlock(pdpProductId, "pdp", false, pdpBlock, "mainprod");
                var bundleProductsArray = INC.dataStore.bundleProductsArray;
                var elPdpMainProductBlock = pdpBlock.querySelector('.inc_pdp_product-main_block');
                var tumbnail_array = [];
                var mainprodtitletext = elPdpMainProductBlock.querySelector('.mainprodtitletext');
                mainprodtitletext.innerText = "This item"
                elPdpMainProductBlock.appendChild(mainProductBlock);

                var pdpBundleProductListMainBlock = pdpBlock.querySelector('.inc_pdp_bundle_product_list_main_block');
                pdpBundleProductListMainBlock.innerHTML = "";
                var pdpBundleProductListItemsBlock = pdpBlock.querySelector('.inc_pdp_bundle_product_list_items_block');
                pdpBundleProductListItemsBlock.innerHTML = "";

                var productVisibleCount = (bundleProductsArray.length > 5) ? 5 : bundleProductsArray.length;
                //if (INC.config.deviceType == "mobile") productVisibleCount = (bundleProductsArray.length > 2) ? 2 : bundleProductsArray.length;
                
                for (var i = 0; i < productVisibleCount; i++) {
                    var firstProductObjByMainId = INC.dataStore.methods().getFirstProductObjByMainId({
                        mainId: bundleProductsArray[i]
                    });
                    var productBlock = this.createProductModuleBlock(firstProductObjByMainId.id, "pdp", true, pdpBlock);
                    if (INC.config.deviceType == "mobile")  productBlock.setAttribute('style', 'display: none!important'); 
                    pdpBundleProductListMainBlock.appendChild(productBlock);
                    var productListItemBlock = this.createProductListItemBlock(firstProductObjByMainId, "pdp");
                    pdpBundleProductListItemsBlock.appendChild(productListItemBlock);
                    tumbnail_array.push(firstProductObjByMainId);
                }

            //} 
            var header = pdpBlock.querySelector('.inc_pdp_bundle_product_header_text');
            if (header != null) {
                header.innerText = "Frequently bought with"
                header.style.textTransform = "none"
            }
            //if (window.innerWidth > 820) {
                //pdpBlock.querySelector('.inc_pdp_bundle_product_list_items_block').classList.add("inc_active");
                var pdpBundleCartBlock = this.createPDPBundleCartBlock(pdpBlock);
                var rpdpBundleCartBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_block')
                rpdpBundleCartBlock.parentNode.removeChild(rpdpBundleCartBlock);
                pdpBlock.querySelector('.inc_pdp_bundle_block').appendChild(pdpBundleCartBlock);
           // }

            if (INC.config.deviceType == "mobile") pdpBlock.querySelector(".inc_pdp_bundle_product_list_item_block").classList.add("inc_active");
            pdpBundleProductListMainBlock.querySelector(".inc_product_module_block").style.display = "block";
            
            INC.methods.clear();
            if (window.innerWidth < 821 && document.querySelector('.device-mobile') != null) {
                var mobileplacement = document.querySelector('.js-right-column-section .elc-product-overview') || document.querySelector('.js-right-column-section .js-product-overview');
                if (mobileplacement != null) {
                    mobileplacement.insertBefore(pdpBlock, mobileplacement.childNodes[0]);
                } else {
                    var pdpsibling1 = document.querySelector('.spp-product-layout__content');
                    var pdpBlockeinstienSibling = document.querySelector('.sd-product-spp__product-full');
                    if (pdpBlockeinstienSibling != null || pdpBlockeinstienSibling != undefined) {
                        var nextpdpsibling = pdpBlockeinstienSibling.nextElementSibling
                        nextpdpsibling.parentNode.insertBefore(pdpBlock, nextpdpsibling);
                    } else if (pdpsibling1 != null) {
                        pdpsibling1.parentNode.insertBefore(pdpBlock, pdpsibling1);
                    }
                }
            } else {
                var recsibling = document.querySelector('#shopify-section-text-with-icons')
                var pdpsibling1 = document.querySelector('.spp-product-layout__content');
                var pdpBlockeinstienSibling = document.querySelector('.sd-product-spp__product-full');
                var pdpsibling2 = document.querySelector('.sd-product-spp.spp__container');
                var pdpsibling3 = document.querySelector('.product-full__cross-sell');
                if (pdpBlockeinstienSibling != null || pdpBlockeinstienSibling != undefined) {
                    var nextpdpsibling = pdpBlockeinstienSibling.nextElementSibling
                    nextpdpsibling.parentNode.insertBefore(pdpBlock, nextpdpsibling);
                } else if (recsibling != null) {
                    recsibling.parentNode.insertBefore(pdpBlock, recsibling);
                } else if (pdpsibling1 != null) {
                    pdpsibling1.parentNode.insertBefore(pdpBlock, pdpsibling1);
                } else if (pdpsibling2 != null) {
                    pdpsibling2.insertBefore(pdpBlock, pdpsibling2.childNodes[1]);
                } else if (pdpsibling3 != null) {
                    pdpsibling3.parentNode.insertBefore(pdpBlock, pdpsibling3);
                }
            }
            //debugger

            //var productBlocks = getViewElement("pdpBundleProductListBlock").querySelectorAll(getSelectorClassName(classNames, "productModuleBlock"));
            var show_more_less_block = pdpBlock.querySelector(".inc_pdp_bundle_product_list_items_show_more_less_block")
            var show_more_less_text = pdpBlock.querySelector(".inc_pdp_bundle_product_list_items_show_more_less_text ");
            show_more_less_text.innerHTML = "Show more products";
            show_more_less_text.classList.add('down_wrrow');

            // getViewElement("pdpBundleProductListMainBlock").classList.add('inc_active')pdpBundleProductListMainBlock
            pdpBlock.querySelector(".inc_pdp_bundle_product_list_items_show_more_less_block").addEventListener("click", function (ev) {
                var show_more_less_text = pdpBlock.querySelector(".inc_pdp_bundle_product_list_items_show_more_less_text");
                var clickshowmore = ev.target.parentNode;
                if (clickshowmore.querySelector('.inc_pdp_bundle_product_list_items_show_more_less_text') != null && clickshowmore.querySelector('.inc_pdp_bundle_product_list_items_show_more_less_text').classList.contains('down_wrrow') == true) {
                    show_more_less_text.innerHTML = "Show less products";
                    show_more_less_text.classList.remove('down_wrrow');
                    show_more_less_text.classList.add('up_wrrow');
                    document.querySelector('.inc_pdp_bundle_product_list_items_block').classList.add('inc_active');
                } else {
                    show_more_less_text.innerHTML ="Show more products";
                    show_more_less_text.classList.remove('up_wrrow');
                    show_more_less_text.classList.add('down_wrrow');
                    document.querySelector('.inc_pdp_bundle_product_list_items_block').classList.remove('inc_active');
                }
            });

            /////////

            var rightBtn = pdpBlock.querySelector(".inc_pdp_bundle_product_list_right_block");

            var leftBtn = pdpBlock.querySelector(".inc_pdp_bundle_product_list_left_block");

            // var findObj = new INC.classes.FindObj({
            //     id: pdpProductId
            // });
            // var productObj = INC.dataStore.methods().getProductById(findObj);
        
            // rightBtn.addEventListener("click", function(e) {
            //     debugger
            //     var pListId = e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block').classList.contains("inc_active")
            //     if(pListId == true){
            //         var a= e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block.inc_active').getAttribute("data-id")
            //     }
            //     Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
            //         attSizeListBlock.classList.remove("inc_active");
            //     });
        
            //     var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
            //     Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
            //         productBlock.setAttribute('style', 'display: none!important');
            //     });
            //     elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + a + "\"").style.display = "block";
        
            //     Array.prototype.forEach.call(productBlock.querySelectorAll(".inc_pdp_bundle_product_list_item_block"), function(pListItemBlock) {
            //         pListItemBlock.classList.remove("inc_active");
            //     });
        
            //     e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block').classList.add("inc_active");
            // });
            // leftBtn.addEventListener("click", function(e) {
            //     var pListId = e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block').classList.contains("inc_active")
            //     if(pListId == true){
            //         var a= e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block.inc_active').getAttribute("data-id")
            //     }
            //     Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
            //         attSizeListBlock.classList.remove("inc_active");
            //     });
        
            //     var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
            //     Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
            //         productBlock.setAttribute('style', 'display: none!important');
            //     });
            //     elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + a + "\"]").style.display = "block";
        
            //     Array.prototype.forEach.call(productBlock.querySelectorAll(".inc_pdp_bundle_product_list_item_block"), function(pListItemBlock) {
            //         pListItemBlock.classList.remove("inc_active");
            //     });
        
            //     e.currentTarget.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block').classList.add("inc_active");
            // });

            // var findObj = new INC.classes.FindObj({
            //     id: pdpProductId
            // });
            // var productObj = INC.dataStore.methods().getProductById(findObj);
    
           // var rightBtn = document.querySelector(".inc_pdp_bundle_product_list_right_block");
            // rightBtn.innerHTML = "Previous";

            //var leftBtn = document.querySelector(".inc_pdp_bundle_product_list_left_block");
            // leftBtn.innerHTML = "Next";
            
            // document.querySelector('.inc_pdp_bundle_product_list_left_block').addEventListener("click", function() {
            //     console.log("left")
            // });
            // document.querySelector('.inc_pdp_bundle_product_list_right_block').addEventListener("click", function() {
            //     console.log("right")
            // });

            //rightBtn.addEventListener("click", function(e) {
                //pdpBlock.querySelector(".inc_pdp_bundle_product_list_item_block").click()
                // debugger
                // // var pListId = this.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block').classList.contains("inc_active")
                // // if(pListId == true){
                // //     var a= this.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_wrapper_items_block .inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block.inc_active').getAttribute("data-id")
                // // }
                
                // // var prod_card = this.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_main_block .inc_product_module_block[data-id="' + a + '"]');
                // // var pr_id = prod_card.getAttribute('data-main_id')
                // // slideTo(pr_id, 0, prod_card, "right", "arrow")
                // Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
                //     attSizeListBlock.classList.remove("inc_active");
                // });

                // var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
                // Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
                //     productBlock.setAttribute('style', 'display: none!important');
                // });
                // elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + productObj.mainId + "\"]").style.display = "block";

                // Array.prototype.forEach.call(productListItemBlock.parentNode.querySelectorAll('.inc_pdp_bundle_product_list_item_block'), function(pListItemBlock) {
                //     pListItemBlock.classList.remove("inc_active");
                // });

                // productListItemBlock.classList.add("inc_active");
           // });
            //leftBtn.addEventListener("click", function(e) {
              //  pdpBlock.querySelector(".inc_pdp_bundle_product_list_item_block").click()
                // var prod_card = this.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_pdp_bundle_product_list_main_block .inc_product_module_block');
                // var pr_id = prod_card.getAttribute('data-main_id')
                // slideTo(pr_id, 0, prod_card, "left", "arrow")
            //});

            var productBlocks = "";
            //var sliderBtnCounter = 0;
            leftBtn.setAttribute("style","pointer-events: none;opacity:0.5");
            rightBtn.addEventListener("click", function () {
                //debugger
                productBlocks = pdpBlock.querySelectorAll(".inc_pdp_bundle_product_list_item_block");
                var a = pdpBlock.querySelector('.inc_pdp_bundle_product_list_item_block.inc_active')
                leftBtn.setAttribute("style","pointer-events: auto;opacity:1");
                if(a.nextElementSibling.nextElementSibling == null){
                    rightBtn.setAttribute("style","pointer-events: none;opacity:0.5");

                    Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
                        attSizeListBlock.classList.remove("inc_active");
                    });
    
                    a.classList.remove("inc_active")
                    a.nextElementSibling.classList.add("inc_active")
                    var id = a.nextElementSibling.getAttribute('data-main_id')
    
                    
            
                    var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
                    Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
                        productBlock.setAttribute('style', 'display: none!important');
                    });
                    
                    elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + id + "\"").style.display = "block";
                    return;
                }

                Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
                    attSizeListBlock.classList.remove("inc_active");
                });

                a.classList.remove("inc_active")
                a.nextElementSibling.classList.add("inc_active")
                var id = a.nextElementSibling.getAttribute('data-main_id')

                
        
                var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
                Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
                    productBlock.setAttribute('style', 'display: none!important');
                });
                
                elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + id + "\"").style.display = "block";
        
               
               
            });
    
            leftBtn.addEventListener("click", function () {
                //debugger
                productBlocks = pdpBlock.querySelectorAll(".inc_pdp_bundle_product_list_item_block");
                var a = pdpBlock.querySelector('.inc_pdp_bundle_product_list_item_block.inc_active')
                rightBtn.setAttribute("style","pointer-events: auto;opacity:1");
                if(a.previousElementSibling.previousElementSibling == null){
                    leftBtn.setAttribute("style","opacity:0.5;pointer-events:none");
                    Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
                        attSizeListBlock.classList.remove("inc_active");
                    });
    
                    a.classList.remove("inc_active")
                    a.previousElementSibling.classList.add("inc_active")
                    var id = a.previousElementSibling.getAttribute('data-main_id')
            
                    var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
                    Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
                        productBlock.setAttribute('style', 'display: none!important');
                    });
                    
                    elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + id + "\"").style.display = "block";
                    return;
                }
                Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
                    attSizeListBlock.classList.remove("inc_active");
                });

                a.classList.remove("inc_active")
                a.previousElementSibling.classList.add("inc_active")
                var id = a.previousElementSibling.getAttribute('data-main_id')
        
                var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
                Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
                    productBlock.setAttribute('style', 'display: none!important');
                });
                
                elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + id + "\"").style.display = "block";
            });

            //////////

            var elProductAddBlock = pdpBlock.querySelectorAll('.inc_product_desc_add_block')
            var productBlocks = pdpBlock.querySelector('.inc_pdp_bundle_product_list_block').querySelectorAll('.inc_product_module_block');
            if (document.querySelector('.inc_pdp_product-main_block .inc_product_desc_title_text_header') != null) {
                document.querySelector('.inc_pdp_product-main_block .inc_product_desc_title_text_header').innerHTML = "Selected Product"
                document.querySelector('.inc_pdp_product-main_block .inc_product_desc_title_text_header').style.textTransform = "none"
            }
            //if (window.innerWidth > 820) {
                pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute("style", "opacity:0.5");
                pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute('title', 'Scroll left')
                pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_img').setAttribute('title', 'Scroll right')
                var sliderBtnCounter = 0;
                var lengthCount = productBlocks.length + 1;
                if (window.innerWidth < 1185) {
                    var prd_length = 1
                } else {
                    var prd_length = 2
                }
                if (productBlocks.length > prd_length) {
                    pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_block').addEventListener("click", function() {
                        var prod_c = 1;
                        var width_prod = 256;
                        if (window.innerWidth >= 840 && window.innerWidth < 1190) {
                            width_prod = 266;
                        } else if (window.innerWidth > 1189) {
                            prod_c = 2
                            if (window.innerWidth > 1368) {
                                width_prod = 306;
                            } else {
                                width_prod = 276;
                            }
                        }

                        if (INC.clientConfig.slidevalue + prod_c < productBlocks.length) {
                            pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
                            pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute("style", "opacity:1");
                            INC.clientConfig.slidevalue++
                            INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) - width_prod) + 'px';
                            var menu = pdpBlock.querySelector('.inc_pdp_bundle_product_list_main_block');
                            menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
                        }
                        if (INC.clientConfig.slidevalue + prod_c == productBlocks.length) {
                            pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                            pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_img').setAttribute("style", "opacity:0.5");
                        }
                        sliderBtnCounter++;
                        if (sliderBtnCounter > lengthCount - 3) {
                            sliderBtnCounter--;
                        }
                    });
                    pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_block').addEventListener("click", function() {
                        var prod_c = 1;
                        var width_prod = 256;
                        if (window.innerWidth >= 840 && window.innerWidth < 1190) {
                            width_prod = 266;
                        } else if (window.innerWidth > 1189) {
                            prod_c = 2
                            if (window.innerWidth > 1368) {
                                width_prod = 306;
                            } else {
                                width_prod = 276;
                            }
                        }
                        if (INC.clientConfig.slidevalue == -1)
                            INC.clientConfig.slidevalue = 0;
                        if (INC.clientConfig.slidevalue > 0) {
                            pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
                            pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_img').setAttribute("style", "opacity:1");
                            INC.clientConfig.slidevalue--
                            INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) + width_prod) + 'px';
                            var menu = pdpBlock.querySelector('.inc_pdp_bundle_product_list_main_block');
                            menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
                        }
                        if (INC.clientConfig.slidevalue == 0) {
                            pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                            pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute("style", "opacity:0.5");
                        }
                        sliderBtnCounter--;
                        if (sliderBtnCounter == -1)
                            sliderBtnCounter = 0;
                    });
                }

                if (!(productBlocks.length > prd_length)) {
                    pdpBlock.querySelector('.inc_pdp_bundle_product_right-btn_block').style.visibility = "hidden";
                    pdpBlock.querySelector('.inc_pdp_bundle_product_left-btn_block').style.visibility = "hidden";
                }
            //}
            setTimeout(function() {
                for (var i = 0; i < 8; i++) {
                    if (typeof (elProductAddBlock[i]) != "undefined" && i % 2 != 0) {
                        var productBlockNode = elProductAddBlock[i].parentNode.parentNode.parentNode.parentNode.parentNode;
                        //if (window.innerWidth > 820) { 
                            //debugger
                            if (i == 1) {
                                var module_block = elProductAddBlock[i].parentNode.parentNode.parentNode.parentNode.parentNode;
                                var showcase_block = elProductAddBlock[i].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                                elProductAddBlock[i].click();
                            }
                        //}
                    }
                }
            }, 100)
            setTimeout(function() {
                // if (window.innerWidth < 821) {
                //     var client_var = ""
                //     if (document.querySelector('.js-size-picker-label p') != null) {
                //         client_var = document.querySelector('.js-size-picker-label p').innerText.trim().toLocaleLowerCase()
                //     } else if (document.querySelector('.js-size-picker-dropdown input[data-test-id="product_size_dropdown"]') != null) {
                //         client_var = document.querySelector('.js-size-picker-dropdown input[data-test-id="product_size_dropdown"]').value
                //     }
                //     var elshowcase = document.querySelectorAll('.inc_pdp_product-main_block .inc_product_showcase_block')
                //     for (ms = 0; ms < elshowcase.length; ms++) {
                //         if (elshowcase[ms].querySelector('.inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block[datasize="' + client_var + '"]') != undefined) {
                //             elshowcase[ms].querySelector('.inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block[datasize="' + client_var + '"]').click()
                //         } else if (elshowcase[ms].querySelector('.inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block') != undefined) {
                //             elshowcase[ms].querySelector('.inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block').click()
                //         }
                //     }
                // } else {
                    var client_var = ""
                    if (document.querySelector('.js-size-picker-label p') != null) {
                        client_var = document.querySelector('.js-size-picker-label p').innerText.trim().toLocaleLowerCase()
                    } else if (document.querySelector('.js-size-picker-dropdown input[data-test-id="product_size_dropdown"]') != null) {
                        client_var = document.querySelector('.js-size-picker-dropdown input[data-test-id="product_size_dropdown"]').value
                    }
                    if (document.querySelector('.inc_pdp_product-main_block .inc_product_showcase_block .inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block[datasize="' + client_var + '"]') != undefined) {
                        document.querySelector('.inc_pdp_product-main_block .inc_product_showcase_block .inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block[datasize="' + client_var + '"]').click()
                    } else if (document.querySelector('.inc_pdp_product-main_block .inc_product_showcase_block .inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block') != undefined) {
                        document.querySelector('.inc_pdp_product-main_block .inc_product_showcase_block .inc_product_desc_att_zero_block .inc_product_desc_att_size_list_item_img_block').click()
                    }
                //}
                var client_varc = ""
                if (document.querySelector('.js-product-shades-view-button') != null) {
                    client_varc = document.querySelector('.js-product-shades-view-button').innerText.trim().toLocaleLowerCase()
                }
                var el_all_list_main1 = document.querySelectorAll('.inc_pdp_product-main_block .inc_product_showcase_block')
                for (m2 = 0; m2 < el_all_list_main1.length; m2++) {
                    if (el_all_list_main1[m2].querySelector('.inc_product_desc_att_color_block .inc_product_desc_att_color_list_item_img_block[datacolor="' + client_varc + '"] div') != null) {
                        el_all_list_main1[m2].querySelector('.inc_product_desc_att_color_block .inc_product_desc_att_color_list_item_img_block[datacolor="' + client_varc + '"] div').click()
                    }
                }
                var all_list_el = document.querySelectorAll('.inc_pdp_bundle_product_list_block .inc_product_showcase_block');
                for (q1 = 0; q1 < all_list_el.length; q1++) {
                    if (all_list_el[q1].querySelector('.inc_product_desc_att_zero_block.inc_active') != null) {
                        var clrtext = ""
                        if (document.querySelector('.js-size-picker-label p') != null) {
                            clrtext = document.querySelector('.js-size-picker-label p').innerText.trim().toLocaleLowerCase()
                        }
                        var prd_moduleb = all_list_el[q1].parentNode
                        var main_idsd = prd_moduleb.getAttribute('data-main_id')
                        if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"]') != null) {
                            if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block') != null) {
                                prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block').click()
                            } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block[datasize="' + clrtext + '"] div') != undefined) {
                                all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block[datasize="' + clrtext + '"] div').click()
                            } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                                all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                            }
                        } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block[datasize="' + clrtext + '"] div') != undefined) {
                            all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block[datasize="' + clrtext + '"] div').click()
                        } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                            all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                        }
                    }
                }
            }, 200)
            setTimeout(function() {
                onloadpdp = true
                onloadpdp_delete = true
                _isVisible._init({
                    classSelector: ".inc_pdp_block img[data-src], .inc_pdp_block source[data-src], .inc_sidebar_modal_block img[data-src], .inc_sidebar_modal_block source[data-src], .inc_af_block img[data-src], .inc_af_block source[data-src]",
                    index: 0
                });
                var eltotalbundle = document.querySelectorAll('.inc_pdp_bundle_block')
                for (t = 0; t < eltotalbundle.length; t++) {
                    INC.methods.updateallbasketprice(eltotalbundle[t])
                }
            }, 1000)
        }
    }
    if (sidebar == "sidebar") {
        this.createSidebarBlock();
    }
}
INC.methods.createPDPBundleCartBlock = function(pdpBlock) {
    var pdpBundleCartBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_block')
    var elBundleCartTitleBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_title_block')
    var elBundleCartTitleText = pdpBlock.querySelector('.inc_pdp_bundle_cart_title_text')
    var elBundleCartAddedBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_added_block')
    var elBundleCartSummaryViewBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_summary_view_block');
    var elBundleCartSummaryViewBtnText = pdpBlock.querySelector('.inc_pdp_bundle_cart_summary_view_btn_text');
    var elBundleCartAddBtnBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_summary_add_btn_block');
    var elBundleCartAddBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_summary_add_block');
    var elBundleCartsummaryBlock = pdpBlock.querySelector('.inc_pdp_bundle_cart_summary_block');
    var elBundleCartTitleTextblock = pdpBlock.querySelector('.inc_pdp_bundle_cart_title_text_block')
    if (window.innerWidth < 821) {
        elBundleCartTitleTextblock.addEventListener('click', function () {
            var cartsummaryel = this.parentNode.parentNode.parentNode;
            this.classList.toggle('inc_active')
            cartsummaryel.querySelector('.inc_pdp_bundle_cart_added_block').classList.toggle('inc_active')
        })
    }else{
        elBundleCartTitleText.innerText = "Price Summary";
        elBundleCartAddedBlock.innerHTML = "";
        elBundleCartSummaryViewBtnText.innerText = "Added items";
    }
    if (elBundleCartAddBtnBlock != null) {
        elBundleCartAddBtnBlock.addEventListener("click", function(e) {
            //debugger
            console.log("Cart Button Clicked!")
            checkAddedProductInJustAdded()
            this.classList.add('inc_loading');
            INC.clientConfig.offset = 0;
            INC.clientConfig.slidevalue = 0;
            if (window.innerWidth < 1185) {
                var prd_length = 2
            } else {
                var prd_length = 3
            }
            document.querySelector('.inc_pdp_bundle_product_list_main_block').setAttribute('style', 'margin-left: 0')
            if (document.querySelectorAll('.inc_pdp_block .inc_product_module_block').length > prd_length) {
                document.querySelector('.inc_pdp_bundle_product_left-btn_block').setAttribute('style', 'pointer-events: none;opacity:0.5')
                document.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute('style', 'opacity:0.5')
                document.querySelector('.inc_pdp_bundle_product_right-btn_block').setAttribute('style', 'pointer-events: auto;opacity:1')
                document.querySelector('.inc_pdp_bundle_product_right-btn_img').setAttribute('style', 'opacity:1')
            }
            //debugger
            if (INC.config.disablebtn == true) {
                var btn_cart = e.target
                INC.config.disablebtn = false
                btn_cart.classList.add('inc_loading')
                btn_cart.parentNode.parentNode.classList.add('inc_hide_icon')
                setTimeout(function() {
                    btn_cart.classList.add('inc_loading')
                    // document.querySelector('.inc_pdp_bundle_cart_title_img_block').click()
                    document.querySelector('body').classList.remove('inc_sidebar_avail')
                    INC.methods.addBundleToCart(btn_cart);
                    INC.methods.showSidebar();
                    INC.methods.updateSidebarBlock();
                })
            }
        });
    }
    return pdpBundleCartBlock;
}
INC.methods.createSidebarBlock = function() {
    var dataStore = INC.dataStore;
    var sidebar_dialoge_block = document.createElement('div')
    sidebar_dialoge_block.classList.add('sidebar_outer')
    sidebar_dialoge_block.innerHTML = sidebar_html
    var sbBlock = sidebar_dialoge_block.querySelector('.inc_sidebar_modal_block');

    sbBlock.querySelector(".inc_cart_added_list_block").innerHTML = "";

    var elHeaderContinueText = sbBlock.querySelector(".inc_header_continue_text");
    var elHeaderTitleText = sbBlock.querySelector(".inc_header_title_text");
    var elHeaderItemCountBlock = sbBlock.querySelector(".inc_header_item_count_block");
    var elHeaderItemCountTitleText = sbBlock.querySelector(".inc_header_item_count_title_text");
    var elHeaderItemCountFigureText = sbBlock.querySelector(".inc_header_item_count_figure_text");
    var elRecommendedTitleText = sbBlock.querySelector(".inc_recommended_title_text");
    var elRecommendedTabsListBlock = sbBlock.querySelector(".inc_recommended_tabs_list_block")
    var elRecommendedProductsBlock = sbBlock.querySelector(".inc_recommended_products_block");
    var elRecommendedProductsListBlock = sbBlock.querySelector(".inc_recommended_products_list_block");
    var elCheckoutContinueBtnText = sbBlock.querySelector(".inc_checkout_continue_btn_text");
    var elCheckoutBasketBtnText = sbBlock.querySelector(".inc_checkout_basket_btn_text");
    var elheaditemblock = sbBlock.querySelector(".inc_header_item_block");
    var elheadtitleblock = sbBlock.querySelector(".inc_header_title_block");
    var elrectitleblock = sbBlock.querySelector(".inc_recommended_title_block")
    var elcheckoutblock = sbBlock.querySelector(".inc_sidebar_checkout_block");
    var elrecblock = sbBlock.querySelector(".inc_recommended_tabs_block");
    var elcardaddelist = sbBlock.querySelector(".inc_recommended_products_list_block");
    var eladedblk = sbBlock.querySelector(".inc_cart_added_list_block")
    var elsidebarheadblock = sbBlock.querySelector(".inc_sidebar_header_block")

    elheaditemblock.addEventListener('click', function() {
        var cnt = document.querySelector('.inc_header_item_count_title_text').getAttribute('added_counts')
        if (cnt >= 1) {
            if (document.querySelector('.inc_sidebar_cart_added_block').classList.contains('inc_active') == true) {
                document.querySelector('.inc_sidebar_cart_added_block').classList.remove('inc_active')
                var alladdedprodlength = document.querySelectorAll('.inc_cart_added_product_block').length;
                var morecount = 2
                if (window.innerWidth < 821) {
                    morecount = 1
                }
                if (alladdedprodlength > morecount) {
                    var tcount = alladdedprodlength - morecount + " more item(s)"
                    document.querySelector('.inc_header_item_count_title_text').innerText = "+" + tcount
                    document.querySelector('.inc_header_item_count_title_text').setAttribute('added_counts', (alladdedprodlength - morecount))
                } else {
                    document.querySelector('.inc_header_item_count_title_text').innerText = ""
                }
            } else {
                document.querySelector('.inc_header_item_count_title_text').innerText = ""
                document.querySelector('.inc_sidebar_cart_added_block').classList.add('inc_active')
            }
        }
    })
    var close_sisebar_icon = generate_html_tag('span', 'close_sisebar_icon')
    elheadtitleblock.appendChild(close_sisebar_icon)
    elRecommendedProductsListBlock.setAttribute('role', "contentinfo")
    elRecommendedProductsListBlock.setAttribute('tabindex', 0)
    elHeaderContinueText.innerText = "Back";
    elHeaderTitleText.innerText = "Just added to your cart";
    elHeaderTitleText.style.textTransform = "none"
    if (dataStore.bundleCartProducts != undefined) {
        elHeaderItemCountTitleText.innerText = "Subtotal" + " " + "(" + Object.keys(dataStore.bundleCartProducts).length + " items)";
        elRecommendedTitleText.innerText = INC.config.BeforeYouChecktext
        elRecommendedTitleText.style.textTransform = "none"
        elCheckoutContinueBtnText.innerText = "Continue shopping";
        var elCheckoutLink = elCheckoutBasketBtnText.querySelector('.view_basket_checkout')
        elCheckoutLink.setAttribute('href', INC.clientConfig.checkoutLink);
        var productCategoriesArray = dataStore.methods().getUniqueCatergories();
        elRecommendedTabsListBlock.innerHTML = "";
        elRecommendedProductsListBlock.innerHTML = "";
        var category_count = 0
        elRecommendedTabsListBlock.classList.add('inc_categ_' + Object.keys(productCategoriesArray).length)
        productCategoriesArray.forEach(function(productCategory) {
            if (category_count < 5 && productCategory != undefined) {
                category_count++
                var sidebarTabsListItemBlock = generate_html_tag('div', 'inc_recommended_tabs_list_item_block')
                var tablistitm = '<div class="inc_recommended_tabs_list_item_text_block"><div class="inc_recommended_tabs_list_item_text"></div></div>'
                sidebarTabsListItemBlock.innerHTML = tablistitm
                var sidebarTabsListItemText = sidebarTabsListItemBlock.querySelector('.inc_recommended_tabs_list_item_text');
                sidebarTabsListItemText.parentNode.parentNode.setAttribute('title', productCategory)
                sidebarTabsListItemText.innerText = productCategory.toLocaleLowerCase();
                sidebarTabsListItemText.setAttribute('style', 'text-transform:capitalize;')
                sidebarTabsListItemBlock.addEventListener("click", function() {
                    var elRecommendedProductsListBlock = sbBlock.querySelector(".inc_recommended_products_list_block")
                    if (elRecommendedProductsListBlock != null) {
                        elRecommendedProductsListBlock.innerHTML = "";
                    }
                    Array.prototype.forEach.call(elRecommendedTabsListBlock.querySelectorAll('.inc_recommended_tabs_list_item_block'), function(elTabsItemBlock) {
                        elTabsItemBlock.classList.remove("inc_active");
                    });
                    sidebarTabsListItemBlock.classList.add("inc_active");
                    INC.methods.updateSidebarProductsList(elRecommendedProductsListBlock, productCategory);
                });
                elRecommendedTabsListBlock.setAttribute('tabindex', 0)
                elRecommendedTabsListBlock.appendChild(sidebarTabsListItemBlock);
            }
        });
        if (elRecommendedTabsListBlock.querySelector('.inc_recommended_tabs_list_item_block') != null) {
            elRecommendedTabsListBlock.querySelector('.inc_recommended_tabs_list_item_block').click();
        } else {
            elRecommendedTitleText.style.display = "none";
        }
        sbBlock.querySelector(".inc_header_continue_block").addEventListener("click", function() {
            document.querySelector('html').classList.remove('inc_overlay');
            INC.methods.hideSidebar();
            INC.config.pdpaddedProductList = []
            INC.clientConfig.offset = 0;
            INC.clientConfig.slidevalue = 0;
        });
        sbBlock.querySelector(".inc_checkout_continue_block").addEventListener("click", function() {
            document.querySelector('html').classList.remove('inc_overlay');
            INC.clientConfig.offset = 0;
            INC.config.pdpaddedProductList = []
            INC.clientConfig.slidevalue = 0;
            INC.methods.hideSidebar();
        });
        sbBlock.querySelector(".inc_checkout_basket_block").addEventListener("click", function() {
            this.querySelector('.inc_checkout_basket_btn_block').classList.add('inc_loading')
            window.location.href = INC.clientConfig.checkoutLink;
        });
        var addedProductBlocks = "";
        var addedSliderBtnCounter = 0;

        var body = document.querySelector('body');
        if (body != null) {
            body.appendChild(sidebar_dialoge_block);
        }
        var elSideBarOverlayBlock = document.createElement('div');
        elSideBarOverlayBlock.setAttribute("class", "inc_sidebar_overlay_block");
        elSideBarOverlayBlock.addEventListener("click", function() {
            document.querySelector('html').classList.remove('inc_overlay');
            INC.methods.hideSidebar();
            INC.config.pdpaddedProductList = []
            INC.clientConfig.offset = 0;
            INC.clientConfig.slidevalue = 0;
        });
        close_sisebar_icon.addEventListener("click", function() {
            document.querySelector('html').classList.remove('inc_overlay');
            INC.methods.hideSidebar();
            INC.config.pdpaddedProductList = []
            INC.clientConfig.offset = 0;
            INC.clientConfig.slidevalue = 0;
        });
        elSideBarOverlayBlock.style.display = "none";
        body.appendChild(elSideBarOverlayBlock);
        if (INC.dataStore.dataStoreObj.undefined != undefined) {
            if (document.querySelector('.inc_recommended_products_block') != null) {
                document.querySelector('.inc_recommended_products_block').style.display = "none"
            }
            if (document.querySelector('.s7staticimage img') != null && document.querySelector('.inc_cart_added_product_img') != null) {
                var p_img = document.querySelector('.s7staticimage img').src
                document.querySelector('.inc_cart_added_product_img').src = p_img
            }
        }
    }
    setTimeout(function() {
        if (document.querySelector('.inc_recommended_products_list_block') != null) {
            document.querySelector('.inc_recommended_products_list_block').setAttribute('role', "contentinfo")
        }
    }, 100)
}
INC.methods.updateSidebarBlock = function() {
    var subtotalactiveprice = 0
    var subtotalregukarprice = 0
    var dataStore = INC.dataStore;
    var sbBlock = document.querySelector('.inc_sidebar_modal_block');
    if (sbBlock != null) {
        var total_count = 0
        var sidebarHeaderItemCountTitleText = sbBlock.querySelector(".inc_header_item_count_title_text");
        var elHeaderItemCountFigureText = sbBlock.querySelector(".inc_header_item_count_figure_text");
        var elHeadersubtotalactivetext = sbBlock.querySelector(".inc_cart_added_product_desc_subtotal_ecirp_active_text");
        var elHeadersubtotalregulartext = sbBlock.querySelector(".inc_cart_added_product_desc_subtotal_ecirp_regular_text");
        var sbCartBlock = sbBlock.querySelector(".inc_cart_added_list_block");
        var sidebarHeaderseelesstext = sbBlock.querySelector(".inc_header_item_count_figure_text");
        sidebarHeaderseelesstext.innerText = ""
        sbCartBlock.innerHTML = "";
        var bundleCartProductsArray = Object.keys(dataStore.bundleCartProducts);
        sidebarHeaderItemCountTitleText.innerHTML = "Subtotal (" + Object.keys(dataStore.bundleCartProducts).length + " item)";
        var headerItemCountFigureText = 0;
        var subtotalactiveprice = 0
        var subtotalregukarprice = 0
        var error_message = ""
        var oosname = []
        var oosids = []
        var remerrorjust = document.querySelectorAll('.inc_justerror')
        for (r = 0; r < remerrorjust.length; r++) {
            if (remerrorjust[r] != null) {
                remerrorjust[r].parentNode.removeChild(remerrorjust[r])
            }
        }
        bundleCartProductsArray.forEach(function(productSKU) {
            if (dataStore.bundleCartProducts[productSKU] < 1)
                dataStore.bundleCartProducts[productSKU] = 1
            var findObj = new INC.classes.FindObj({
                sku: productSKU
            });
            var productObj = INC.dataStore.methods().getProductBySKU(findObj);
            if (INC.clientConfig.OOS.indexOf(productObj.mainId) >= 0) {
                if (oosname.indexOf(productObj.name) == -1 && oosids.indexOf(productObj.mainId) == -1) {
                    error_message = ""
                    oosids.push(productObj.mainId)
                    oosname.push(productObj.name)
                    if (error_message == "") {
                        error_message = "<span>" + productObj.name + "</span>" + " - " + "<span>Cannot be purchased at this time</span>"
                    } else {
                        error_message = error_message + " <br> " + "<span>" + productObj.name + "</span>" + " - " + "<span>Cannot be purchased at this time</span>"
                    }
                    var headertitle = sbBlock.querySelector('.inc_sidebar_modal_cart_and_title_block')
                    var errormes = generate_html_tag('div', 'inc_justerror')
                    var errorimg = generate_html_tag('img', 'errorimg')
                    errorimg.src = productObj.imageURL
                    errormes.appendChild(errorimg)
                    var errormestext = generate_html_tag('span', 'inc_justerror_text')
                    errormestext.innerHTML = error_message
                    errormes.appendChild(errormestext)
                    headertitle.parentNode.insertBefore(errormes, headertitle)
                    setTimeout(function() {
                        var remerrorjust = document.querySelectorAll('.inc_justerror')
                        for (r = 0; r < remerrorjust.length; r++) {
                            if (remerrorjust[r] != null) {
                                remerrorjust[r].parentNode.removeChild(remerrorjust[r])
                            }
                        }
                    }, 5000)
                }
            } else {
                headerItemCountFigureText = headerItemCountFigureText + parseInt(dataStore.bundleCartProducts[productSKU]);
                var color = "";
                var size = "";
                var just_check_prod_block = document.querySelector('.inc_product_module_block[data-main_id="' + productObj.mainId + '"]')
                if (just_check_prod_block != null) {
                    if (just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div') != null) {
                        size = just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div').innerText
                    }
                    if (just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block') != null) {
                        color = just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block').getAttribute('data-color')
                    }
                }
                if (color != "" && color != undefined && color != null) {
                    var sel_size = "Color" + color;
                } else if (size != "" && size != undefined && size != null) {
                    var sel_size = "Size" + size;
                }
                var activePrice = parseFloat(productObj.activePrice).toFixed(2);
                var regularPrice = parseFloat(productObj.regularPrice).toFixed(2);
                subtotalactiveprice = (+subtotalactiveprice + (+productObj.activePrice * dataStore.bundleCartProducts[productSKU]));
                subtotalregukarprice = (+subtotalregukarprice + (+productObj.regularPrice * dataStore.bundleCartProducts[productSKU]));

                var addedhtml = '<div class="inc_cart_added_product_img_block"><div class="inc_cart_added_product_img"><img class="inc_lazy" src="' + productObj.imageURL + '" data-src="' + productObj.imageURL + '" alt="' + productObj.name + '"><div class="sidebar_product_quantity_label">' + dataStore.bundleCartProducts[productSKU] + '</div></div><div class="inc_cart_added_product_desc_block"><div class="inc_cart_added_product_desc_title_block"><div class="inc_cart_added_product_desc_title_text_block"><div class="inc_cart_added_product_desc_title_text" title="Easidri Cooling Coat Wide Fit" style="text-transform: unset;">' + dataStore.bundleCartProducts[productSKU] + ' X ' + productObj.name + '</div></div></div><div class="inc_cart_added_product_desc_att_block"><div class="inc_cart_added_product_desc_att_color_block"><div class="inc_cart_added_product_desc_att_color_text_block"><div class="inc_cart_added_product_desc_att_color_text_block"></div></div></div><div class="inc_cart_added_product_desc_att_size_block"><div class="inc_cart_added_product_desc_att_size_text_block"><div class="inc_cart_added_product_desc_att_size_text">' + sel_size + '</div></div></div></div><div class="inc_cart_added_product_desc_ecirp_block"><div class="inc_cart_added_product_desc_ecirp_active_block"><div class="inc_cart_added_product_desc_ecirp_active_text_block"><div class="inc_cart_added_product_desc_ecirp_active_text">' + formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de',''); + '</div><div class="inc_cart_added_product_desc_ecirp_active_text_msg"></div></div></div><div class="inc_cart_added_product_desc_ecirp_regular_block"><div class="inc_cart_added_product_desc_ecirp_regular_text_block"><div class="inc_cart_added_product_desc_ecirp_regular_text"></div></div></div></div><div class="inc_cart_added_product_qty_block"></div></div></div>'
                var productBlock = generate_html_tag('div', 'inc_cart_added_product_block');
                productBlock.innerHTML = addedhtml
                productBlock.setAttribute('data-id', productObj.id);
                productBlock.setAttribute('data-sku', productObj.sku);
                productBlock.setAttribute('data-main_id', productObj.mainId);
                productBlock.setAttribute('data-bundle_id', productObj.bundleId);
                productBlock.setAttribute('data-childsku', productObj.childsku);
                productBlock.setAttribute('data-mainsku', productObj.mainsku);
                productBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
                productBlock.querySelector('.inc_cart_added_product_img img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
                sbCartBlock.appendChild(productBlock);
            }
        });
        if (+subtotalactiveprice != null && (+subtotalactiveprice < +subtotalregukarprice)) {
            elHeadersubtotalactivetext.setAttribute('subtotalActiveprice', subtotalactiveprice)
            elHeadersubtotalregulartext.setAttribute('subtotalRegularprice', subtotalregukarprice)
            elHeadersubtotalactivetext.innerHTML = formatter.format(subtotalactiveprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elHeadersubtotalregulartext.innerHTML = "<span>" + "Was" + "</span>" + formatter.format(subtotalregukarprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            if (document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block') != null)
                document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block').classList.add("is_special_ecirp")
            elHeadersubtotalactivetext.style.color = "#ee1c31"
        } else {
            elHeadersubtotalactivetext.setAttribute('subtotalActiveprice', subtotalactiveprice)
            elHeadersubtotalactivetext.style.color = "#000"
            elHeadersubtotalregulartext.setAttribute('subtotalRegularprice', subtotalregukarprice)
            elHeadersubtotalactivetext.innerHTML = formatter.format(subtotalregukarprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elHeadersubtotalregulartext.innerHTML = ""
        }
        if (headerItemCountFigureText == 1) {
            sidebarHeaderItemCountTitleText.innerHTML = "Subtotal " + "(" + headerItemCountFigureText + " item)";
        } else {
            sidebarHeaderItemCountTitleText.innerHTML = "Subtotal " + "(" + headerItemCountFigureText + " items)";
        }
        if (window.innerWidth > 767) {
            if (document.querySelectorAll('.inc_sidebar_cart_added_block .inc_cart_added_product_block').length > 5) {
                document.querySelector('.inc_sidebar_cart_added_block').classList.add('flex-start')
            }
        } else {
            if (document.querySelectorAll('.inc_sidebar_cart_added_block .inc_cart_added_product_block').length > 3) {
                document.querySelector('.inc_sidebar_cart_added_block').classList.add('flex-start')
            }
        }
    }
}
INC.methods.updateSidebarProductsList = function(elRecommendedProductsListBlock, productCategory) {
    var productListArray = INC.dataStore.bundleProductsArray;
    var dupl_sidebar_prod = []
    var addCheck = INC.config.pdpaddedProductList;
    for (var i = 0; i < productListArray.length; i++) {
        var firstProductObjByMainId = INC.dataStore.methods().getFirstProductObjByMainId({
            mainId: productListArray[i]
        });
        if (firstProductObjByMainId["categoryId"] == productCategory) {
            if (INC.dataStore.dataStoreObj.undefined == undefined) {
                if (addCheck.indexOf(productListArray[i]) == -1) {
                    if (INC.config.sidebarremovedprod.indexOf(firstProductObjByMainId.id) == -1) {
                        if (dupl_sidebar_prod.indexOf(firstProductObjByMainId.id) == -1) {
                            dupl_sidebar_prod.push(firstProductObjByMainId.id)
                            var prdblck = INC.methods.createProductModuleBlock(firstProductObjByMainId.id, "sidebar", false, elRecommendedProductsListBlock);
                            prdblck.querySelector('.inc_product_desc_add_block').addEventListener("click", function(e) {
                                var productModuleBlock = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                                if (productModuleBlock.classList.contains('inc_product_module_block') == false) {
                                    productModuleBlock = this.parentNode.parentNode.parentNode.parentNode.parentNode
                                }
                                // var productModuleBlock = prdblck
                                var flag_check = INC.methods.checkVariantSelection(productModuleBlock)
                                var sku = productModuleBlock.getAttribute('data-sku');
                                var findObj = new INC.classes.FindObj({
                                    id: sku
                                });
                                var qty = productModuleBlock.querySelector('input').value;
                                var add_btn_click = prdblck.querySelector('.inc_product_add_text')
                                var add_prod_im = prdblck.querySelector('.inc_product_desc_add_img')

                                var dataid = productModuleBlock.getAttribute('data-id');
                                var sku = productModuleBlock.getAttribute('data-sku');
                                var findObj = new INC.classes.FindObj({
                                    id: sku
                                });
                                var qty = productModuleBlock.querySelector('input').value;
                                var add_prod_im = productModuleBlock.querySelector('.inc_product_desc_add_img')
                                if (flag_check == 1 && productModuleBlock.querySelector('.inc_product_add_text_block.disable_btn') == null) {
                                    if(productBlockNode.classList.contains('configurable') == true  && document.querySelector('.inc_product_modal_block.inc_active') == null){
                                        productBlockNode.querySelector('.inc_product_img_main_img').click()
                                    }else{
                                        if (this.parentNode.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_showcase_block') == true || this.parentNode.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_modal_block') == true) {
                                            if (INC.config.disablebtn == true) {
                                                if(document.querySelector('.fullscreen-spinner') != null){
                                                    document.querySelector('.fullscreen-spinner').style.display = "block"
                                                }
                                                INC.config.disablebtn = false;
                                                var newbtntext = productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_add_text')
                                                var btnclick = productModuleBlock.querySelector('.inc_product_add_text')
                                                newbtntext.textContent = INC.config.adding_text + "..."
                                                btnclick.textContent = INC.config.adding_text + "...";
                                                var selbtn = productModuleBlock.querySelector('.inc_product_variant_simple_text')
                                                selbtn.textContent = INC.config.adding_text + "...";
                                                //inc_product_add_text_block disable_btn
                                                setTimeout(function(){
                                                    INC.methods.addProductToCart(findObj, qty, "am", productModuleBlock, btnclick, add_prod_im, selbtn, newbtntext);
                                                },400)
                                            }
                                        }
                                    }
                                }
                            });
                            elRecommendedProductsListBlock.appendChild(prdblck);
                        }
                    }
                }
            }
        }
        ;
    }
    INC.clientConfig.offset = 0;
    INC.clientConfig.slidevalue = 0;
    elRecommendedProductsListBlock.setAttribute('style', 'margin-left: 0')
    if ((document.querySelector('.inc_recommended_tabs_list_item_block') == null && elRecommendedProductsListBlock.querySelector('.inc_product_module_block') == null)) {
        elRecommendedProductsListBlock.parentNode.parentNode.parentNode.parentNode.style.display = "none"
    }
    if (!(elRecommendedProductsListBlock.childNodes.length > 2)) {
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_right_block').style.visibility = "hidden";
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').style.visibility = "hidden";
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').setAttribute("style", "pointer-events: none;opacity:0.5;visibility: hidden;");
    }

    if (elRecommendedProductsListBlock.childNodes.length > 2) {
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_right_block').style.visibility = "visible";
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').style.visibility = "visible";
        elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').setAttribute("style", "pointer-events: none;opacity:0.5");
    }
    elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_img').setAttribute("style", "opacity:0.5");
    var sliderBtnCounter = 0;
    elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_img').setAttribute('title', 'Scroll left')
    elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_right_btn_img').setAttribute('title', 'Scroll right')

    var productBlocks = elRecommendedProductsListBlock.querySelectorAll('.inc_product_module_block');
    elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommeded_products_right_btn_block').addEventListener("click", function() {
        var productBlocks = document.querySelectorAll('.inc_recommended_products_list_block .inc_product_module_block')
        if (INC.clientConfig.slidevalue + 1 < productBlocks.length) {
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').setAttribute("style", "pointer-events: auto;opacity:1");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_img').setAttribute("style", "opacity:1");
            INC.clientConfig.slidevalue++
            var slide_w = 274
            if (window.innerWidth > 1590) {
                var slide_w = 274
            }
            INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) - slide_w) + 'px';
            var menu = elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_list_block');
            menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
        }
        var cc_ount = 1;
        if (window.innerWidth > 820) {
            cc_ount = 2
        }
        if (+INC.clientConfig.slidevalue + +cc_ount == productBlocks.length) {
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommeded_products_right_btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
            document.querySelector('.inc_recommended_products_right_btn_img').setAttribute("style", "pointer-events: none;opacity:0.5");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_right_btn_img').setAttribute("style", "opacity:0.5");
        }
        sliderBtnCounter++;
        if (sliderBtnCounter > productBlocks.length - cc_ount) {
            sliderBtnCounter--;
        }
    });

    elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_block').addEventListener("click", function() {
        var productBlocks = document.querySelectorAll('.inc_recommended_products_list_block .inc_product_module_block')
        if (INC.clientConfig.slidevalue == -1)
            INC.clientConfig.slidevalue = 0;
        if (INC.clientConfig.slidevalue > 0) {
            var slide_w = 274
            if (window.innerWidth > 1590) {
                var slide_w = 274
            }
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommeded_products_right_btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
            document.querySelector('.inc_recommended_products_right_btn_img').setAttribute("style", "pointer-events: auto;opacity:1");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_right_btn_img').setAttribute("style", "opacity:1");
            INC.clientConfig.slidevalue--
            INC.clientConfig.offset = (parseInt(INC.clientConfig.offset) + slide_w) + 'px';
            var menu = elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_list_block');
            menu.setAttribute('style', 'margin-left:' + INC.clientConfig.offset + ';transition-duration:0.5s;-webkit-transition-duration:0.5s;-moz-transition-duration:0.5s;-ms-transition-duration:0.5s;-o-transition-duration:0.5s;')
        }
        if (INC.clientConfig.slidevalue == 0) {
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_block').setAttribute("style", "pointer-events: none;opacity:0.5");
            elRecommendedProductsListBlock.parentNode.parentNode.querySelector('.inc_recommended_products_left_btn_img').setAttribute("style", "opacity:0.5");
        }
        sliderBtnCounter--;
        if (sliderBtnCounter == -1)
            sliderBtnCounter = 0;
    });
    setTimeout(function() {
        var all_list_el = document.querySelectorAll('.inc_recommended_products_list_block .inc_product_showcase_block')
        for (q1 = 0; q1 < all_list_el.length; q1++) {
            if (all_list_el[q1].querySelector('.inc_product_desc_att_zero_block.inc_active') != null) {
                var clrtext = ""
                if (document.querySelector('.js-size-picker-label p') != null) {
                    clrtext = document.querySelector('.js-size-picker-label p').innerText.toLocaleLowerCase()
                }
                var prd_moduleb = all_list_el[q1].parentNode
                var main_idsd = prd_moduleb.getAttribute('data-main_id')
                if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"]') != null) {
                    if (prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block') != null) {
                        prd_moduleb.querySelector('.inc_product_desc_att_size_list_item_img_block[data-cpid="' + main_idsd + '"] .inc_product_desc_att_size_list_item_img_block').click()
                    } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                        all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                    }
                } else if (all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block') != null) {
                    all_list_el[q1].querySelector('.inc_product_desc_att_size_list_item_img_block').click()
                }
            }
        }
        var allimgSid = document.querySelectorAll('.inc_sidebar_modal_block img[data-src]')
        for (img = 0; img < allimgSid.length; img++) {
            allimgSid[img].src = allimgSid[img].getAttribute('data-src')
        }
        _isVisible._init({
            classSelector: ".inc_pdp_block img[data-src], .inc_pdp_block source[data-src], .inc_sidebar_modal_block img[data-src], .inc_sidebar_modal_block source[data-src], .inc_af_block img[data-src], .inc_af_block source[data-src]",
            index: 0
        });
    }, 10)
}
INC.methods.addProductToSidebarCart = function(findObj, qty, productBlock, client_add_btn, btn_addtocart) {
    if (qty == 0) {
        qty = 1;
    }
    var dataStore = INC.dataStore;
    var sbBlock = document.querySelector('.inc_sidebar_modal_block');
    var subtotal_activeprice = 0;
    var subtotal_regular = 0;
    if (document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block .inc_cart_added_product_desc_subtotal_ecirp_active_text') != null) {
        var subtotal_activeprice = document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block .inc_cart_added_product_desc_subtotal_ecirp_active_text').getAttribute('subtotalactiveprice')
    }
    if (document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block .inc_cart_added_product_desc_subtotal_ecirp_regular_text') != null) {
        var subtotal_regular = document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block .inc_cart_added_product_desc_subtotal_ecirp_regular_text').getAttribute('subtotalregularprice')
    }
    if (subtotal_activeprice == null) {
        subtotal_activeprice = 0
    }
    if (subtotal_regular == null) {
        subtotal_regular = 0
    }
    if (client_add_btn == "client_add_btn") {
        var subtotal_activeprice = 0;
        var subtotal_regular = 0;
    }
    if (document.querySelector('.inc_sidebar_cart_added_block.inc_active') != null) {
        if (document.querySelector('.inc_header_item_count_title_block') != null) {
            document.querySelector('.inc_header_item_count_title_block').click()
        }
    }
    var bundleaddedpriceblock = sbBlock.querySelector(".inc_cart_added_product_desc_subtotal_ecirp_block");
    var elHeadersubtotalactivetext = sbBlock.querySelector(".inc_cart_added_product_desc_subtotal_ecirp_active_text");
    var elHeadersubtotalregulartext = sbBlock.querySelector(".inc_cart_added_product_desc_subtotal_ecirp_regular_text");
    var elHeaderItemCountFigureText = sbBlock.querySelector(".inc_header_item_count_figure_text");
    var sidebarHeaderItemCountTitleText = sbBlock.querySelector(".inc_header_item_count_title_text");
    var sbCartBlock = sbBlock.querySelector(".inc_cart_added_list_block");
    if (client_add_btn == "client_add_btn") {
        sbCartBlock.innerHTML = ""
    }
    var productObj = dataStore.methods().getProductById(findObj);
    var productBlock = generate_html_tag('div', 'inc_cart_added_product_block');

    if (INC.clientConfig.OOS.indexOf(productObj.mainId) >= 0) {
        productBlock.classList.add('cross')
        for (e = 0; e < INC.clientConfig.OOS.length; e++) {
            if (INC.clientConfig.OOS_MESG[e] != undefined) {
                var remerrorjust = document.querySelector('.inc_justerror')
                if (remerrorjust != null) {
                    remerrorjust.parentNode.removeChild(remerrorjust)
                }
                if (document.querySelector('.inc_justerror') == null) {
                    var headertitle = sbBlock.querySelector('.inc_sidebar_modal_cart_and_title_block')
                    var errormes = generate_html_tag('div', 'inc_justerror')
                    var errormestext = generate_html_tag('span', 'inc_justerror_text')
                    errormestext.innerHTML = "<span>" + productObj.name + "</span>" + " - " + "<span>Cannot be purchased at this time</span>"
                    errormes.appendChild(errormestext)
                    headertitle.parentNode.insertBefore(errormes, headertitle)
                    setTimeout(function() {
                        var remerrorjust = document.querySelector('.inc_justerror')
                        if (remerrorjust != null) {
                            remerrorjust.parentNode.removeChild(remerrorjust)
                        }
                    }, 500)
                }
            }
        }
    } else {
        var color = "";
        var size = "";
        if (document.querySelector('.inc_sidebar_modal_block.inc_active') != null) {
            var just_check_prod_block = document.querySelector('.inc_sidebar_modal_block .inc_product_module_block[data-main_id="' + productObj.sku + '"]')
        } else {
            var just_check_prod_block = document.querySelector('.inc_product_module_block[data-main_id="' + productObj.mainId + '"]')
        }
        if (just_check_prod_block != null) {
            if (just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div') != null) {
                size = just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div').innerText
            }
            if (just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block') != null) {
                color = just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block').getAttribute('data-color')
            }
        }
        if (btn_addtocart != undefined) {
            if (btn_addtocart.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.classList.contains('inc_product_module_block') == true) {
                var module_blk = btn_addtocart.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                if (module_blk.querySelector('.inc_product_modal_block .inc_product_desc_att_block') != null) {
                    var sel_attr = module_blk.querySelector('.inc_product_modal_block .inc_product_desc_att_block')
                    var zero_text = sel_attr.getAttribute('data-zero');
                    var size_text = sel_attr.getAttribute('data-size');
                    var color_text = sel_attr.getAttribute('data-color');
                    var third_text = sel_attr.getAttribute('data-third');

                    var size = ""
                    var color = ""
                    if (color_text != undefined) {
                        color = color_text
                    }
                    if (zero_text != undefined) {
                        if (size == "") {
                            size = zero_text
                        } else {
                            size = size + "|" + zero_text
                        }
                    }
                    if (size_text != undefined) {
                        size = size + "|" + size_text
                    }
                    if (third_text != undefined) {
                        size = size + "|" + third_text
                    }
                }
            }
        }

        if (color != "" && color != undefined && color != null) {
            var sel_size = "Color" + color;
        } else if (size != "" && size != undefined && size != null) {
            var sel_size = "Size : " + size;
        }
        var pdpprice = 0
        if (client_add_btn == "client_add_btn" && INC.config.pageType == "pdp" && document.querySelector('.js-product-original-price') != null) {
            pdpprice = document.querySelector('.js-product-original-price').innerText.replace('$', '').replace(',', '').trim()
        }
        if (pdpprice != 0 && client_add_btn == "client_add_btn") {
            var activePrice = parseFloat(pdpprice).toFixed(2).toString();
            var regularPrice = parseFloat(pdpprice).toFixed(2).toString();
        } else {
            var activePrice = parseFloat(productObj.activePrice).toFixed(2).toString();
            var regularPrice = parseFloat(productObj.regularPrice).toFixed(2).toString();
        }

        var addedhtml = '<div class="inc_cart_added_product_img_block"><div class="inc_cart_added_product_img"><img class="inc_lazy" src="' + productObj.imageURL + '" data-src="' + productObj.imageURL + '"  alt="' + productObj.name + '"><div class="sidebar_product_quantity_label">' + qty + '</div></div></div><div class="inc_cart_added_product_desc_block"><div class="inc_cart_added_product_desc_title_block"><div class="inc_cart_added_product_desc_title_text_block"><div class="inc_cart_added_product_desc_title_text" title="Easidri Cooling Coat Wide Fit" style="text-transform: unset;">' + qty + ' X ' + productObj.name + '</div></div></div><div class="inc_cart_added_product_desc_att_block"><div class="inc_cart_added_product_desc_att_color_block"><div class="inc_cart_added_product_desc_att_color_text_block"><div class="inc_cart_added_product_desc_att_color_text_block"></div></div></div><div class="inc_cart_added_product_desc_att_size_block"><div class="inc_cart_added_product_desc_att_size_text_block"><div class="inc_cart_added_product_desc_att_size_text">' + sel_size + '</div></div></div></div><div class="inc_cart_added_product_desc_ecirp_block"><div class="inc_cart_added_product_desc_ecirp_active_block"><div class="inc_cart_added_product_desc_ecirp_active_text_block"><div class="inc_cart_added_product_desc_ecirp_active_text">' + formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de',''); + '</div><div class="inc_cart_added_product_desc_ecirp_active_text_msg"></div></div></div><div class="inc_cart_added_product_desc_ecirp_regular_block"><div class="inc_cart_added_product_desc_ecirp_regular_text_block"><div class="inc_cart_added_product_desc_ecirp_regular_text"></div></div></div></div><div class="inc_cart_added_product_qty_block"></div></div>'
        productBlock.innerHTML = addedhtml
        productBlock.querySelector('.inc_cart_added_product_img img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
        if (client_add_btn == "client_add_btn") {
            if (subtotal_regular == "" && +regularPrice != 0 && regularPrice != "") {
                var subtotalactiveprice = +subtotal_activeprice + (+activePrice * qty)
                var subtotalregukarprice = +subtotal_activeprice + (+regularPrice * qty)
            } else {
                var subtotalactiveprice = +subtotal_activeprice + (+activePrice * qty)
                var subtotalregukarprice = +subtotal_regular + (+regularPrice * qty)
            }
        } else {
            if (subtotal_regular == "" && +regularPrice != 0 && regularPrice != "") {
                var subtotalactiveprice = +subtotal_activeprice + (+activePrice * qty)
                var subtotalregukarprice = +subtotal_activeprice + (+regularPrice * qty)
            } else {
                var subtotalactiveprice = +subtotal_activeprice + (+activePrice * qty)
                var subtotalregukarprice = +subtotal_regular + (+regularPrice * qty)
            }
        }
        var old_qty = 0
        if (document.querySelector('.inc_header_item_count_title_text') != null)
            old_qty = document.querySelector('.inc_header_item_count_title_text').textContent.split('(')[1].split('ite')[0].trim();
        if (sbCartBlock != null) {
            if (document.querySelector('.inc_cart_added_product_block[data-id="' + productObj.id + '"]') == null) {
                if (sbCartBlock != null) {
                    sbCartBlock.insertBefore(productBlock, sbCartBlock.querySelector('.inc_cart_added_product_block'));
                }
            } else {
                // var addedel = document.querySelector('.inc_cart_added_product_block[data-id="' + productObj.id + '"]')
                // addedel.parentNode.removeChild(addedel)
                if (sbCartBlock != null) {
                    sbCartBlock.insertBefore(productBlock, sbCartBlock.querySelector('.inc_cart_added_product_block'));
                }
            }
        }
        if (qty < 1)
            qty = 1
        if (elHeaderItemCountFigureText != null)
            elHeaderItemCountFigureText.style.display = "none";
        if (client_add_btn == "client_add_btn") {
            if (qty == 1) {
                sidebarHeaderItemCountTitleText.innerHTML = "Subtotal" + " " + "(" + (parseInt(qty)) + " item)";
            } else {
                sidebarHeaderItemCountTitleText.innerHTML = "Subtotal" + " " + "(" + (parseInt(qty)) + " items)";
            }
        } else {
            sidebarHeaderItemCountTitleText.innerHTML = "Subtotal" + " " + "(" + (parseInt(qty) + parseInt(old_qty)) + " items)";
        }
        elHeadersubtotalactivetext.setAttribute('subtotalactiveprice', subtotalactiveprice)
        elHeadersubtotalregulartext.setAttribute('subtotalregularprice', subtotalregukarprice)
        if (+subtotalactiveprice != null && (+subtotalactiveprice < +subtotalregukarprice)) {
            elHeadersubtotalactivetext.innerHTML = formatter.format(subtotalactiveprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elHeadersubtotalregulartext.innerHTML = "<span>" + "Was" + "</span>" + formatter.format(subtotalregukarprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');;
            if (document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block') != null)
                document.querySelector('.inc_cart_added_product_desc_subtotal_ecirp_block').classList.add("is_special_ecirp")
            elHeadersubtotalactivetext.style.color = "#ee1c31"
        } else {
            elHeadersubtotalactivetext.style.color = "#000"
            elHeadersubtotalactivetext.innerHTML = formatter.format(subtotalactiveprice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');;
            elHeadersubtotalregulartext.innerHTML = ""
        }
        if (window.innerWidth > 767) {
            if (document.querySelectorAll('.inc_sidebar_cart_added_block .inc_cart_added_product_block').length > 5) {
                document.querySelector('.inc_sidebar_cart_added_block').classList.add('flex-start')
            }
        } else {
            if (document.querySelectorAll('.inc_sidebar_cart_added_block .inc_cart_added_product_block').length > 3) {
                document.querySelector('.inc_sidebar_cart_added_block').classList.add('flex-start')
            }
        }
        if (document.querySelectorAll('.inc_sidebar_cart_added_block .inc_cart_added_product_block').length > 7) {
            document.querySelector('.inc_sidebar_cart_added_block').classList.add('more_than_seven')
        }
    }
}
INC.methods.sendBundleClickTracking = function(productId) {
    var pageType = "";
    switch (INC.config.pageType) {
    case "pdp":
        pageType = "107";
        break;
    case "productList":
        pageType = "101";
        break;
    case "cartPage":
        pageType = "103";
        break;
    case "ticket":
        pageType = "103";
        break;
    case "other":
        pageType = "101";
    }
    if (document.querySelector('.inc_sidebar_modal_block.inc_active') == null && INC.config.pageType == "pdp") {
        pageType = "100";
    }
    if (document.querySelector('.header-gnav-cart__overlay.visible') == null && INC.config.pageType == "pdp") {
        pageType = "100"
    }
    if (document.querySelector('.header-gnav-cart__overlay.visible') != null && INC.config.pageType == "pdp") {
        pageType = "107"
    }
    INC.methods.trackingEvents("bundleProductClickTracking", {
        "product_id": productId,
        "core_product_id": INC.dataStore.pdpProductId
    }, pageType);
}

INC.methods.createProductModuleBlock = function(pdpProductId, blockType, bundleProductListCheck, parentblock, mainprod) {
    if (INC.dataStore.dataStoreObj.undefined == undefined) {
        var productModuleBlock = generate_html_tag('div', 'inc_product_module_block')
        var findObj = new INC.classes.FindObj({
            id: pdpProductId
        });
        var productObj = INC.dataStore.methods().getProductById(findObj);
        productModuleBlock.style.userSelect = "none";
        productModuleBlock.setAttribute('data-id', productObj.id);
        productModuleBlock.setAttribute('data-sku', productObj.sku);
        productModuleBlock.setAttribute('data-main_id', productObj.mainId);
        productModuleBlock.setAttribute('data-bundle_id', productObj.bundleId);
        productModuleBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
        productModuleBlock.classList.add(productObj.ProductType)

        var elProductShowcaseBlock = generate_html_tag('div', 'inc_product_showcase_block');
        elProductShowcaseBlock.innerHTML = showcase_productcard
        var elProductModalBlock = generate_html_tag('div', 'inc_product_modal_block');
        elProductModalBlock.innerHTML = modal_productcard
        if (elProductShowcaseBlock != null) {
            elProductShowcaseBlock.setAttribute('role', "contentinfo")
        }
        if (elProductModalBlock != null) {
            elProductModalBlock.setAttribute('role', "contentinfo")
        }
        var productShowcaseBlock = INC.methods.createProductShowcaseBlock(pdpProductId, blockType, bundleProductListCheck, parentblock, elProductShowcaseBlock, mainprod);
        var productModalBlock = INC.methods.createProductModalBlock(pdpProductId, blockType, bundleProductListCheck, parentblock, elProductModalBlock, mainprod);

        elProductShowcaseBlock.appendChild(productShowcaseBlock);
        elProductModalBlock.appendChild(productModalBlock);
        productModuleBlock.appendChild(elProductShowcaseBlock)
        productModuleBlock.appendChild(elProductModalBlock)
        return productModuleBlock;
    }
}

INC.methods.createProductShowcaseBlock = function(pdpProductId, blockType, bundleProductListCheck, parentblock, elProductShowcaseBlock, mainprod) {
    var productBlock = elProductShowcaseBlock.querySelector('.inc_product_block')
    if (window.innerWidth < 821) {
        var qty_html = productBlock.querySelector('.inc_product_qty_block').innerHTML
        var qty_sibling = productBlock.querySelector('.inc_product_desc_att_details_block')
        var html_qty_block = document.createElement('div');
        html_qty_block.classList.add('inc_product_qty_block')
        html_qty_block.classList.add('singleqty')
        html_qty_block.innerHTML = qty_html
        var qty_html_rem = productBlock.querySelector('.inc_product_qty_block');
        qty_html_rem.parentNode.removeChild(qty_html_rem);
        qty_sibling.parentNode.insertBefore(html_qty_block, qty_sibling)
    }
    var findObj = new INC.classes.FindObj({
        id: pdpProductId
    });
    var productObj = INC.dataStore.methods().getProductById(findObj);
    //console.log(productObj)
    productBlock.setAttribute('data-id', productObj.id);
    productBlock.setAttribute('data-sku', productObj.sku);
    productBlock.setAttribute('data-main_id', productObj.mainId);
    productBlock.setAttribute('data-bundle_id', productObj.bundleId);
    productBlock.setAttribute('data_main_variant', productObj.mainProdVariant);
    productBlock.setAttribute('data-category_name', productObj.categoryName);
    productBlock.setAttribute('product_type', productObj.ProductType);
    productBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
    productBlock.classList.add(productObj.ProductType)

    var elHeaderInfoBlck = productBlock.querySelector('.inc_product_info_main_block');
    var elHeader = productBlock.querySelector('.inc_product_header_main_block');
    var elImgBlock = productBlock.querySelector('.inc_product_img_block');
    var elImgGalleryListBlock = productBlock.querySelector('.inc_product_img_gallery_list_block');
    var elTitleBlock = productBlock.querySelector('.inc_product_desc_title_block');
    var elTitleTextBlock = productBlock.querySelector('.inc_product_desc_title_text_block');
    var elTitleText = productBlock.querySelector('.inc_product_desc_title_text');
    var elproductPriceBlock = productBlock.querySelector('.inc_product_desc_ecirp_block');
    var elproductPriceLabel = productBlock.querySelector('.inc_product_ecirp_label_block');
    var elPriceActiveText = productBlock.querySelector('.inc_product_desc_ecirp_active_text');
    ;var elPriceActiveMsg = productBlock.querySelector('.inc_product_desc_ecirp_active_text_msg');
    var elPriceRegularText = productBlock.querySelector('.inc_product_desc_ecirp_regular_text');
    var eleditblock = productBlock.querySelector('.inc_product_desc_att_edit_block');
    var elAttBlock = productBlock.querySelector('.inc_product_desc_att_block');
    var elAttColorBlock = productBlock.querySelector('.inc_product_desc_att_color_block');
    var elAttColorTitleText = productBlock.querySelector('.inc_product_desc_att_color_title_text');
    var elAttColorTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_color_title_text_selected');
    var elAttColorListBlock = productBlock.querySelector('.inc_product_desc_att_color_list_block');
    var elAttSizeBlock = productBlock.querySelector('.inc_product_desc_att_size_block');
    var elAttSizeTitleBlock = productBlock.querySelector('.inc_product_desc_att_size_title_block');
    var elAttSizeTitleText = productBlock.querySelector('.inc_product_desc_att_size_title_text');
    var elAttSizeTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_size_title_text_selected');
    var elAttSizeListBlock = productBlock.querySelector('.inc_product_desc_att_size_list_block');
    var elAtt0ListBlock = productBlock.querySelector('.inc_product_desc_att_zero_list_block');
    var elAtt3ListBlock = productBlock.querySelector('.inc_product_desc_att_third_list_block');
    var elAtt4ListBlock = productBlock.querySelector('.inc_product_desc_att_fourth_list_block');

    var elAtt0Block = productBlock.querySelector('.inc_product_desc_att_zero_block');
    var elAtt3Block = productBlock.querySelector('.inc_product_desc_att_third_block');
    var elAtt4Block = productBlock.querySelector('.inc_product_desc_att_fourth_block');
    var elAtt0TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_zero_title_text_selected');
    var elAtt0TitleText = productBlock.querySelector('.inc_product_desc_att_zero_title_text');
    var elAtt3TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_third_title_text_selected');
    var elAtt3TitleText = productBlock.querySelector('.inc_product_desc_att_third_title_text');
    var elAtt4TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_fourth_title_text_selected');
    var elAtt4TitleText = productBlock.querySelector('.inc_product_desc_att_fourth_title_text');
    var elQtyBlock = productBlock.querySelector('.inc_product_qty_block');
    var elQtyInputText = productBlock.querySelector('.inc_product_desc_qty_input_text');
    var elQtyDownBlock = productBlock.querySelector('.inc_product_qty_down_block');
    var elQtyUpBlock = productBlock.querySelector('.inc_product_qty_up_block');
    var elAddBlock = productBlock.querySelector('.inc_product_desc_add_block');
    var elAddText = productBlock.querySelector('.inc_product_desc_add_text');
    var elAddImg = productBlock.querySelector('.inc_product_desc_add_img');
    var elratingsBlock = productBlock.querySelector('.inc_product_desc_ratings_block');
    var elworthPrice = productBlock.querySelector('.inc_product_desc_ecirp_worth_text');
    var eldetailsprodblock = productBlock.querySelector('.inc_product_desc_att_details_block');
    var eladdvarianttext = productBlock.querySelector('.inc_product_variant_simple_text');
    var elconfigtitle = productBlock.querySelector('.inc_product_desc_add_title_text_block');
    var elvariantaddbtn = productBlock.querySelector('.inc_product_desc_att_variant_add_block');
    var elvariantaddbtntext = productBlock.querySelector('.inc_product_desc_att_variant_text');
    var elvariantviewdetails = productBlock.querySelector('.inc_product_desc_att_variant_view_details_block');
    var elvariantviewdetailstext = productBlock.querySelector('.inc_product_desc_att_variant_view_details_text');
    var eldescblock = productBlock.querySelector('.inc_product_desc_block');
    var elbstxtblock = productBlock.querySelector('.inc_product_bstxt_block');
    var elvariantpopupclose = productBlock.querySelector('.inc_product_desc_variant_popup_close_block');
    var elselectoptaddbtn = productBlock.querySelector('.inc_product_variant_simple_block');
    var elsizetitleblock = productBlock.querySelector('.inc_product_desc_att_zero_title_block');
    var eldescrpionblock = productBlock.querySelector('.inc_product_desc_block');

    var productDescQtyInputText = productBlock.querySelector('.inc_product_qty_input_text');
    var productDescQtyBlock = productBlock.querySelector('.inc_product_qty_block');
    var productDescAddText = productBlock.querySelector('.inc_product_add_text');
    var elQtyAddBtnBlock = productBlock.querySelector('.inc_product_desc_qty_add_btn_block');
    if (INC.config.pageType == "cartPage") {
        var inc_checkbox = generate_html_tag('div', 'inc_checkbox');
        inc_checkbox.innerText = 'checkbox'
        inc_checkbox.addEventListener('click',function(e){
            e.preventDefault()
            if(productBlock.classList.contains('inc_checked') == true){
                productBlock.classList.remove('inc_checked')
                productBlock.parentNode.parentNode.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = 'Selecteaza produsul';
                productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = 'Selecteaza produsul';
            }else{
                productBlock.classList.add('inc_checked')
                productBlock.parentNode.parentNode.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = INC.config.added_text;
                productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = INC.config.added_text;
            }
            setTimeout(function(){
                updateplpactivemodalprc()
            },100)
        })
        elImgBlock.parentNode.insertBefore(inc_checkbox,elImgBlock)
    }
    
    var elcosprodsku = productBlock.querySelector('.cosproductsku')
    elcosprodsku.innerHTML = "<span>"+productObj.id+"</span>"
    elQtyAddBtnBlock.classList.add(productObj.ProductType);
    elproductPriceLabel.innerHTML = "SALE"
    elvariantpopupclose.addEventListener('click', function() {
        if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
            document.querySelector('html').classList.remove('inc_overlay')
            document.querySelector('body').style.position = "relative"
            document.querySelector('body').style.overflow = "auto"
        }
        this.parentNode.classList.remove('inc_active')
        productBlock.classList.remove('show_overlay')
    });
    elHeaderInfoBlck.setAttribute('data-id', productObj.id);
    elHeaderInfoBlck.setAttribute('data-sku', productObj.sku);
    elHeaderInfoBlck.setAttribute('data-main_id', productObj.mainId);
    elHeaderInfoBlck.setAttribute('data-bundle_id', productObj.bundleId);
    elHeaderInfoBlck.setAttribute('bundledprod_id', productObj.bundledProductId);

    elHeader.querySelector('.inc_product_header_img_block').addEventListener("click", function() {
        productBlock.parentNode.classList.remove("inc_active");
    });
    var elImgMainImg = elImgBlock.querySelector('.inc_product_img_main_img');
    var elImgTag1 = generate_html_tag('img');
    elImgTag1.src = productObj.imageURLMain
    if (elImgTag1 == true) {
        elImgTag.src = productObj.imageURLMain
    }
    elImgTag1.setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
    elImgTag1.setAttribute('role', 'img')
    elImgTag1.setAttribute('aria-label', 'Image')
    elImgTag1.setAttribute('alt', productObj.nameMain)
    elImgTag1.setAttribute('data-mouseover', productObj["otherImageList"])
    elImgTag1.setAttribute('data-imageURL', productObj["imageURLMain"])
    var productLink = document.createElement('a');
    productLink.target = "_blank";
    productLink.setAttribute('rel', 'noopener noreferrer')
    productLink.href = productObj.url;
    productLink.appendChild(elImgTag1);
    productLink.setAttribute('otherImageList', productObj["otherImageList"])
    productLink.setAttribute('imageURL', productObj["imageURLMain"])
    add_swipe(productLink)

    elImgMainImg.appendChild(productLink);

    productLink.addEventListener('click', function(e) {
        if (blockType != "sidebar" || blockType != "am" || mainprod == "mainprod") {
            e.preventDefault();
        }
    })
    elImgMainImg.addEventListener("click", function() {
        if (document.querySelector('.inc_pdp_block') != null) {
            var doc = document.querySelector('.inc_pdp_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        } else if (document.querySelector('.inc_af_block') != null) {
            var doc = document.querySelector('.inc_af_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        }
        if (productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_block') != null) {
            productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_block').click()
        }
        Array.prototype.forEach.call(document.querySelectorAll('.inc_product_modal_block'), function(el) {
            el.classList.remove("inc_active");
        });
        if (document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
            document.querySelector('html').classList.add('inc_overlay');
        }

        productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_title_text_block').click()
        document.querySelector('html').classList.add('inc_overlay');
        if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block') != null) {
            document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.add('overflow_visible')
            document.querySelector('body').classList.add('inc_popup_open');
        }
        productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block').classList.add("inc_active")
    });
 

    elImgGalleryListBlock.innerHTML = "";
    if ((productObj.otherImageList != null) && productObj.otherImageList.length > 1) {
        var otimg = 0
        productObj.otherImageList.forEach(function(otherImgURL) {
            otherImgURL = otherImgURL;
            var elImgGalleryListItemBlock = generate_html_tag('div', 'inc_product_img_gallery_list_item_block')
            var imglist = '<div class="inc_product_img_gallery_list_item_img_block"><div class="inc_product_img_gallery_list_item_img"><img class="inc_lazy" data-src="' + otherImgURL + '" src="' + otherImgURL + '" role="img" aria-label="Image"  alt="' + productObj.name + '"></div></div><div class="inc_product_img_gallery_list_item_text_block"><div class="inc_product_img_gallery_list_item_text"></div></div>'
            elImgGalleryListItemBlock.innerHTML = imglist

            var elImgGalleryListItemImg = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img');

            var elOtherImgTag = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img img')
            elOtherImgTag.src = otherImgURL
            elOtherImgTag.setAttribute('alt', productObj.name)
            elOtherImgTag.setAttribute('role', 'img')
            elOtherImgTag.setAttribute('aria-label', 'Image')
            elOtherImgTag.setAttribute('onerror', "this.src='" + INC.config.noimage + "'");

            if (productObj.otherImageList.length > 4) {
                elImgGalleryListItemImg.classList.add('OthImg4');
            }

            elImgGalleryListItemBlock.setAttribute('index', otimg)
            elImgGalleryListItemBlock.addEventListener("click", function() {
                Array.prototype.forEach.call(productBlock.querySelectorAll('.inc_product_img_gallery_list_item_block'), function(galleryListItemBlock) {
                    galleryListItemBlock.classList.remove("inc_active");
                });

                elImgGalleryListItemBlock.classList.add("inc_active");

                elImgMainImg.querySelector('img').src = otherImgURL;
                elImgMainImg.querySelector('img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
            })

            elImgGalleryListBlock.appendChild(elImgGalleryListItemBlock);
            if (otimg == 0) {
                elImgGalleryListItemBlock.classList.add('inc_active')
            }
            otimg++;
            if (productObj.otherImageList.length > 5) {
                elImgGalleryListItemBlock.parentNode.classList.add("flex-start")
            }
        });
    }


    elTitleTextBlock.addEventListener("click", function(e) {
        if (document.querySelector('.inc_pdp_block') != null) {
            var doc = document.querySelector('.inc_pdp_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        } else if (document.querySelector('.inc_af_block') != null) {
            var doc = document.querySelector('.inc_af_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        }
        if (productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_block') != null) {
            productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_block').click()
        }
        Array.prototype.forEach.call(document.querySelectorAll('.inc_product_modal_block'), function(el) {
            el.classList.remove("inc_active");
        });

        productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_header_title_text_block').click()
        document.querySelector('html').classList.add('inc_overlay');
        if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block') != null) {
            document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.add('overflow_visible')
            document.querySelector('body').classList.add('inc_popup_open');
        }
        productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block').classList.add("inc_active")
        setTimeout(function() {
            if (document.querySelector('.inc_product_modal_block.inc_active') != null)
                document.querySelector('html').classList.add('inc_overlay');
        }, 300)
    });

    var pTitleDiv = document.createElement('div');
    if (window.innerWidth < 821 && mainprod == "mainprod" && INC.config.pageType == "pdp") {
        pTitleDiv.innerHTML = "<strong>This item </strong>" + productObj.nameMain;
    } else {
        pTitleDiv.innerHTML = productObj.nameMain;
    }
    var field1 = productObj.ratingsCount
    var field2 = productObj.reviewsCount
    INC.methods.get_product_ratings(field1, field2, elratingsBlock);
    var pLink = document.createElement('a');
    if (blockType == "pdp" && INC.config.Product_id == productObj.mainId) {
        pLink.setAttribute('style', 'cursor: default;text-decoration: none;')
    } else {
        pLink.setAttribute('style', 'cursor: default;text-decoration: none;')
    }
    pLink.href = productObj.url;
    pLink.addEventListener('click', function(e) {
        if (blockType != "sidebar" || blockType != "am" || window.innerWidth < 821 || mainprod == "mainprod") {
            e.preventDefault()
        }
    })
    pLink.setAttribute('style', 'text-transform: unset;')
    pLink.setAttribute('title', productObj.nameMain)
    if (INC.config.pageType == "pdp" && INC.config.recommendation) {
        pLink.setAttribute('href', productObj.url)
    }
    pLink.appendChild(pTitleDiv);
    elTitleText.appendChild(pLink);
    var activePrice = parseFloat(productObj.activePriceMain).toFixed(2).toString();
    var regularPrice = parseFloat(productObj.regularPriceMain).toFixed(2).toString();
    var totalsaveprc = get_discount_price(productObj.regularPriceMain, productObj.activePriceMain)
    var totalsaveper = get_discount_price_percentage(productObj.regularPriceMain, productObj.activePriceMain)
    var fromTxt = generate_html_tag('span', 'fromTxt');
    var actPrc = elPriceActiveText.parentNode.parentNode
    elPriceRegularText.textContent = "";
    if (activePrice != regularPrice && regularPrice != "" && regularPrice != null && regularPrice != 0) {
        elPriceActiveText.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
        if (productObj.pricingCount != "") {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        } else {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        }
    } else {
        if (productObj.pricingCount != "") {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        } else {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        }
        elworthPrice.innerHTML = ""
    }
    if (window.innerWidth < 821) {
        var inc_empty_popup = generate_html_tag('div', 'inc_empty_popup');
        eldetailsprodblock.appendChild(inc_empty_popup);
    }
    if (INC.config.pageType == "cartPage") {
        productDescAddText.innerText = 'Selecteaza produsul'
    } else if (blockType == "sidebar" || INC.config.pageType == "pdp") {
        productDescAddText.innerText = INC.config.add_text
    } else {
        productDescAddText.innerText = "Add to bundle"
    }
    productDescAddText.addEventListener('click', function() {
        this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_add_block').click()
    });
    var elQtyInput = generate_html_tag('input');
    elQtyInput.setAttribute('type', "number");
    elQtyInput.setAttribute('aria-label', "quantity");
    elQtyInput.setAttribute('min', 1);
    elQtyInput.setAttribute('max', 999);
    elQtyInput.setAttribute('maxlength', 1);
    elQtyInput.value = 1;
    elQtyInput.setAttribute('old_qty', '1');
    elQtyInput.setAttribute('pattern', '/^-?\d+\.?\d*$/');
    elQtyInput.setAttribute("onkeydown", "if(event.key==='.'){event.preventDefault();}");
    elQtyInput.setAttribute('onKeyPress', 'if(this.value.length==3) return false;');
    elQtyInput.setAttribute("oninput", "validity.valid||(value='');");
    // elQtyInput.setAttribute('readOnly', '');
    elQtyInput.addEventListener("keydown", function(event) {
        var old_qty = this.value
        var keyCode = event.which || event.keyCode;
        if (keyCode === 13) {
            event.preventDefault();
        } else if (($.inArray(event.keyCode, incallowedKeys) !== -1) || (keyCode === 65 && (event.ctrlKey || event.metaKey)) || (keyCode >= 35 && keyCode <= 40)) {
            return;
        }
        var charValue = String.fromCharCode(keyCode)
          , valid = /^[0-9]+$/.test(charValue);
        if (!valid) {
            event.preventDefault();
        } else {
            setTimeout(function() {
                if (elQtyInput.value.length == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value > 99)
                    elQtyInput.value = 99;

                var productModuleBlock = productBlock.parentNode.parentNode;
                var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
                var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
                showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
                modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
                showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
                modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')

                var id = productBlock.getAttribute('data-id');
                var qty = parseInt(elQtyInput.value);
                var main_id = productBlock.getAttribute('data-main_id');
                var bundle_id = productBlock.getAttribute('data-bundle_id');
                var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
                var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');
                if (elAddText.textContent == 'Added' || elAddText.textContent == "Update") {
                    INC.methods.updateBundleCart({
                        sku: id,
                        qty: qty
                    }, "add", main_id, bundle_id, pname, pprice);
                }
                if (elQtyInput.value == 1) {
                    elQtyBlock.classList.add('singleqty')
                }
                if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                }
                updateplpactivemodalprc()
            }, 50);
        }
    });
    elQtyInput.addEventListener('focusout', function(ev) {
        var old_qty = this.value
        var elm = ev.currentTarget
        if (elm.tagName != "INPUT") {
            elm = elm.querySelector('input')
        }
        var prod_card = elm.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        if (prod_card.classList.contains('inc_product_showcase_block') == true) {
            prod_card = elm.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        }
        // if (elm.value.length == 0) {
        setTimeout(function() {
            if (elQtyInput.value.length == 0)
                elQtyInput.value = 1;
            if (elQtyInput.value == 0)
                elQtyInput.value = 1;
            if (elQtyInput.value > 99)
                elQtyInput.value = 99;

            var productModuleBlock = productBlock.parentNode.parentNode;
            var productModuleBlock = productBlock.parentNode.parentNode;
            var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
            var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
            showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
            modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
            showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
            modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
            var id = productBlock.getAttribute('data-id');
            var qty = parseInt(elQtyInput.value);
            var main_id = productBlock.getAttribute('data-main_id');
            var bundle_id = productBlock.getAttribute('data-bundle_id');
            var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
            var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');
            if (elAddText.textContent == 'Added' || elAddText.textContent == "Update") {
                INC.methods.updateBundleCart({
                    sku: id,
                    qty: qty
                }, "add", main_id, bundle_id, pname, pprice);
            }
            if (elQtyInput.value == 1) {
                elQtyBlock.classList.add('singleqty')
            }

            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            }
            updateplpactivemodalprc()
        }, 50);
        // }
    });

    productDescQtyInputText.appendChild(elQtyInput);

    var added_text = document.createElement('span');
    added_text.classList.add("inc_add_text");
    productDescQtyInputText.appendChild(added_text);

    elQtyDownBlock.addEventListener('click', function() {
        var prod_card = elQtyInput.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        elQtyInput.value = (elQtyInput.value - 1 < 1) ? 1 : elQtyInput.value - 1;
        var productModuleBlock = productBlock.parentNode.parentNode;
        var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
        var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')

        showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
        modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
        showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
        modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
        var id = productBlock.getAttribute('data-id');
        var sku = productBlock.getAttribute('data-sku');
        var qty = parseInt(elQtyInput.value);
        var bundle_id = productBlock.getAttribute('data-bundle_id');
        var main_id = productBlock.getAttribute('data-main_id');
        var pname = productBlock.querySelector('.inc_product_desc_title_text').innerText;
        var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').innerText.replace('$', '');
        if (parseInt(elQtyInput.value) == 1 && productDescQtyBlock.classList.contains('singleqty') == true) {
            if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {

                document.querySelector('html').classList.remove('inc_overlay')
                var modal_blck = productModuleBlock.querySelector('.inc_product_modal_block')
                var showcase_blck = productModuleBlock.querySelector('.inc_product_showcase_block')
                var elAddTextshowcase = showcase_blck.querySelector('.inc_product_desc_add_text')
                var elAddTextmodal = modal_blck.querySelector('.inc_product_desc_add_text')
                if (INC.config.pageType == "pdp" && blockType == "pdp")
                    INC.methods.updateBundleCart({
                        sku: id,
                        qty: qty
                    }, "add", main_id, bundle_id, pname, pprice);
            }
        } else {
            if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {
                INC.methods.updateBundleCart({
                    sku: id,
                    qty: qty
                }, "add", main_id, bundle_id, pname, pprice);
            }
        }
        if (elQtyInput.value == 1) {
            elQtyBlock.classList.add('singleqty')
            productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.add('singleqty')
            productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.add('singleqty')
            modalProductBlock.querySelector('.inc_product_qty_input_text input').parentNode.parentNode.parentNode.parentNode.classList.add('singleqty');
        }
        setTimeout(function() {
            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            }
            updateplpactivemodalprc()
        }, 200)
    });

    elQtyUpBlock.addEventListener('click', function() {
        var prod_card = elQtyInput.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        elQtyInput.value = (parseInt(elQtyInput.value) + 1 > 99) ? 99 : parseInt(elQtyInput.value) + 1;
        var productModuleBlock = productBlock.parentNode.parentNode;
        var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
        var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')

        showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
        modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
        showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
        modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
        modalProductBlock.querySelector('.inc_product_qty_input_text input').parentNode.parentNode.parentNode.parentNode.classList.remove('singleqty');

        productDescQtyBlock.classList.remove('singleqty')
        productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.remove('singleqty')
        var id = productBlock.getAttribute('data-id');
        var qty = parseInt(elQtyInput.value);
        var bundle_id = productBlock.getAttribute('data-bundle_id');
        var main_id = productBlock.getAttribute('data-main_id');
        var pname = productBlock.querySelector('.inc_product_desc_title_text').innerText;
        var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').innerText.replace('$', '');
        if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {
            INC.methods.updateBundleCart({
                sku: id,
                qty: qty
            }, "add", main_id, bundle_id, pname, pprice);
        }
        setTimeout(function() {
            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            }
            updateplpactivemodalprc()
        }, 200)
    });

    findObj = new INC.classes.FindObj({
        mainId: productObj.mainId
    });

    var productColorsObj = INC.dataStore.methods().getProductColorsObj(findObj);
    if (productColorsObj.colorArray.length == 0) {
        var productSizesObj = INC.dataStore.methods().getProductSizesObj(findObj);
    }
    var product0Obj = INC.dataStore.methods().getProductopt0Obj(findObj);

    var productSizesObj = INC.dataStore.methods().getProductSizesObj(findObj);

    var productColorsObj = INC.dataStore.methods().getProductColorsObj(findObj);

    var product3Obj = INC.dataStore.methods().getProductopt3Obj(findObj);

    elAtt0ListBlock.innerHTML = "";
    elAttSizeListBlock.innerHTML = "";
    elAttColorListBlock.innerHTML = "";
    elAtt3ListBlock.innerHTML = "";

    if (product0Obj.att0Array.length > 0) {
        if (product0Obj["att0Array"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });
            elAtt0ListBlock.innerHTML = "";
            var product0Obj = product0Obj;
            var productSizeText = "";
            if (product0Obj["att0Array"].length > 0) {
                elAtt0TitleText.innerText = 'Selectati optiunile';
                elAtt0Block.classList.add("inc_active");
                elAtt0Block.classList.add("inc_total_" + product0Obj["att0Array"].length)
                product0Obj["att0Array"].forEach(function(sizeObj) {
                    var attSizeBlock0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_block');
                    var attSizeImgBlock0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img_block');
                    var attSizeImg0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img');
                    attSizeImgBlock0.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"zero")')
                    attSizeImgBlock0.classList.add('avail')
                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];
                    reg.test(chckType);

                    if (sizeObj["imgSrc"].length > 0) {
                        if (sizeObj["colorCode"] == "" || sizeObj["colorCode"] == undefined) {
                            var sizeimg = generate_html_tag('img');
                            sizeimg.setAttribute('alt', sizeObj["text"])
                            sizeimg.src = sizeObj["imgSrc"]
                            attSizeImgBlock0.setAttribute('data-optionimge', sizeObj["imgSrc"])
                            attSizeImgBlock0.appendChild(sizeimg);
                            elAtt0TitleText.classList.add('img_tag_avail')
                            elAtt0TitleText.style.display = "flex"
                            attSizeImgBlock0.classList.add('img_avail')
                        }
                    }
                    attSizeImg0.innerText = sizeObj["text"];
                    attSizeImgBlock0.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock0.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock0.setAttribute('data-option', "1");
                    attSizeImgBlock0.setAttribute('data-cpid', sizeObj["cpid"])
                    if (product0Obj["att0Array"][0].code == "size") {
                        attSizeImgBlock0.setAttribute('title', sizeObj["text"].toUpperCase());
                    } else if (product0Obj["att0Array"][0].code == "letter") {
                        attSizeImgBlock0.setAttribute('title', "Letter" + " " + sizeObj["text"].toUpperCase());
                    } else if (product0Obj["att0Array"][0].code == "choose") {
                        attSizeImgBlock0.setAttribute('title', "Number " + sizeObj["text"].toUpperCase());
                    } else {
                        attSizeImgBlock0.setAttribute('title', sizeObj["text"].toUpperCase());
                    }
                    attSizeImgBlock0.appendChild(attSizeImg0);
                    elAtt0ListBlock.appendChild(attSizeImgBlock0);
                });

            }
        }
    }
    if (productSizesObj.sizeArray.length > 0) {
        if (productSizesObj["sizeArray"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });

            elAttSizeListBlock.innerHTML = "";
            var productSizeText = "";
            if (productSizesObj["sizeArray"].length > 0) {
                elAttSizeTitleText.innerText = productSizesObj["sizeArray"][0].code;
                elAttSizeBlock.classList.add("inc_active");
                productSizesObj["sizeArray"].forEach(function(sizeObj) {
                    var attSizeBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_block');
                    var attSizeImgBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img_block');
                    var attSizeImg = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img');
                    elAttSizeTitleTextSelected.innerText = "Please select option"
                    if (elAttSizeTitleTextSelected.innerText == "Please select option") {// elAttSizeTitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                    attSizeImgBlock.classList.add('avail')
                    attSizeImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"size")')
                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];

                    reg.test(chckType);
                    attSizeImg.innerText = sizeObj["text"];
                    attSizeImgBlock.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock.setAttribute('data-option', "2");
                    if (productSizesObj["sizeArray"][0].code == "size") {
                        attSizeImgBlock.setAttribute('title', sizeObj["text"].toUpperCase());
                    } else if (productSizesObj["sizeArray"][0].code == "letter") {
                        attSizeImgBlock.setAttribute('title', "Letter" + " " + sizeObj["text"].toUpperCase());
                    } else if (productSizesObj["sizeArray"][0].code == "choose") {
                        attSizeImgBlock.setAttribute('title', "Number " + sizeObj["text"].toUpperCase());
                    } else {
                        attSizeImgBlock.setAttribute('title', sizeObj["text"].toUpperCase());
                    }
                    attSizeImgBlock.appendChild(attSizeImg);
                    elAttSizeListBlock.appendChild(attSizeImgBlock);

                });

            }
        }
    }
    if (productColorsObj.colorArray.length > 0) {
        elAttColorListBlock.innerHTML = "";
        var one_attr_flag = false
        if (productColorsObj["colorArray"].length == 1) {
            one_attr_flag = true
        }
        if (productColorsObj["colorArray"].length > 0) {
            productColorsObj["colorArray"].forEach(function(colorObj) {
                elAttColorBlock.classList.add("inc_active");
                elAttColorTitleText.innerText = "Selectati optiunile";
                var attColorBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_block')
                var attColorImgBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img_block');
                var attColorImg = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img');
                var attColorTextBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text_block');
                var attColorText = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text');

                attColorImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"color")')
                if (true) {
                    elAttColorTitleTextSelected.innerText = "Please select a Color"
                    if (elAttColorTitleTextSelected.innerText == "Please select a Color") {// elAttColorTitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                }
                if (colorObj["colorCode"] != "" && colorObj["colorCode"] != undefined) {
                    var spancolorcode = generate_html_tag('span');
                    spancolorcode.setAttribute('alt', colorObj["text"])
                    spancolorcode.style.backgroundColor = colorObj["colorCode"];
                    attColorImg.appendChild(spancolorcode);
                } else if (colorObj["imgSrc"].length > 0) {
                    if (colorObj["colorCode"] == "") {
                        var colorImg = generate_html_tag('img');
                        colorImg.setAttribute('alt', colorObj["text"])
                        colorImg.src = colorObj["imgSrc"]
                        // if (productObj.categoryName != "") {
                        //     colorImg.classList.add(productObj.categoryName.replace(/\s/g, ''))
                        // }
                        attColorImg.appendChild(colorImg);
                    }
                }
                var colorTitle = generate_html_tag('a');
                colorTitle.innerText = colorObj["text"]
                colorTitle.title = colorObj["text"].toUpperCase();
                colorTitle.addEventListener('click', function(e) {
                    e.preventDefault();
                })
                attColorImg.appendChild(colorTitle);

                attColorImgBlock.setAttribute('data-color', colorObj["text"]);
                attColorImgBlock.setAttribute("datacolor", colorObj["text"].toLocaleLowerCase());
                attColorImgBlock.setAttribute('data-option', "0");
                attColorImgBlock.setAttribute('data-cpid', colorObj["cpid"])
                attColorImgBlock.setAttribute('data-colorcode', colorObj["colorCode"])
                attColorImgBlock.setAttribute('data-optionimge', colorObj["imgSrc"])

                attColorImgBlock.appendChild(attColorImg);
                attColorBlock.appendChild(attColorImgBlock);
                elAttColorListBlock.appendChild(attColorBlock);
                var prod_id = productBlock.getAttribute('data-main_id');
                if (one_attr_flag == true) {
                    setTimeout(function() {
                        if (INC.methods.getProductIdFromWebPage() == prod_id) {
                            attColorImgBlock.click()
                        }
                    }, 0)
                }
            });

        }
    }
    if (product3Obj.att3Array.length > 0) {
        if (product3Obj["att3Array"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });

            elAtt3ListBlock.innerHTML = "";
            var productSizeText = "";
            if (product3Obj["att3Array"].length > 0) {
                product3Obj["att3Array"].forEach(function(sizeObj) {
                    elAtt3TitleTextSelected.innerText = "Please select option"
                    if (elAtt3TitleTextSelected.innerText == "Please select option") {// elAtt3TitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                    elAtt3TitleText.innerText = product3Obj["att3Array"][0].code;
                    elAtt3Block.classList.add("inc_active");
                    var attSizeBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_block');
                    var attSizeImgBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img_block');
                    var attSizeImg3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img');

                    attSizeImgBlock3.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"third")')
                    attSizeImgBlock3.classList.add('avail')

                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];
                    reg.test(chckType);
                    attSizeImg3.innerText = sizeObj["text"];
                    attSizeImgBlock3.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock3.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock3.setAttribute('data-option', "3");

                    attSizeImgBlock3.appendChild(attSizeImg3);
                    elAtt3ListBlock.appendChild(attSizeImgBlock3);

                });

            }
        }
    }
    if (product0Obj.att0Array.length > 0 && productColorsObj.colorArray.length > 0) {
        elAttBlock.classList.add('clr_size_avl')
    }
    if (product0Obj["att0Array"].length > 0) {
        productBlock.querySelector('.inc_product_desc_att_zero_title_block').addEventListener('click', function(e) {
            //debugger
            if (document.querySelector('.inc_product_desc_att_zero_block.show_dropdown') != e.currentTarget) {
                if (document.querySelector('.inc_product_desc_att_zero_block.show_dropdown') != null) {
                    if (e.currentTarget.parentNode.classList.contains('show_dropdown') == false) {
                        document.querySelector('.inc_product_desc_att_zero_block.show_dropdown').classList.remove('show_dropdown')
                    }
                }
            }
            if (document.querySelector('.inc_product_desc_att_color_block.show_dropdown') != null) {
                document.querySelector('.inc_product_desc_att_color_block.show_dropdown').classList.remove('show_dropdown')
            }
            this.parentNode.classList.toggle('show_dropdown')
        })
    }
    if (productColorsObj["colorArray"].length > 0) {
        productBlock.querySelector('.inc_product_desc_att_color_title_block').addEventListener('click', function(e) {
            if (document.querySelector('.inc_product_desc_att_color_block.show_dropdown') != e.currentTarget) {
                if (document.querySelector('.inc_product_desc_att_color_block.show_dropdown') != null) {
                    if (e.currentTarget.parentNode.classList.contains('show_dropdown') == false) {
                        document.querySelector('.inc_product_desc_att_color_block.show_dropdown').classList.remove('show_dropdown')
                    }
                }
            }
            if (document.querySelector('.inc_product_desc_att_zero_block.show_dropdown') != null) {
                document.querySelector('.inc_product_desc_att_zero_block.show_dropdown').classList.remove('show_dropdown')
            }
            this.parentNode.classList.toggle('show_dropdown')
        })
    }
    var sizezero = INC.dataStore.methods().getProductopt0Obj(findObj)
    if (productColorsObj["colorArray"].length == 0 && sizezero["att0Array"].length == 0) {
        elAttBlock.classList.add('attributes_not_avail')
        eladdvarianttext.textContent = "Add"
        switch (blockType) {
        case "pdp":
            eladdvarianttext.textContent = "Add to bundle";
            break;
        case "sidebar":
            eladdvarianttext.textContent = INC.config.add_text;
            break;
        case "am":
            eladdvarianttext.textContent = INC.config.add_text;
            break;
        }
        eladdvarianttext.classList.add('simple')
    } else if (productColorsObj["colorArray"].length > 0) {
        elAttBlock.classList.add('attributes_avail')
        elAttSizeTitleText.textContent = "View colours";
        eladdvarianttext.textContent = "Selectati optiunile";
        eladdvarianttext.classList.add('config')
        elconfigtitle.textContent = "Please select a Color";
        switch (blockType) {
        case "pdp":
            elvariantaddbtntext.textContent = "Add to bundle";
            break;
        case "sidebar":
            elvariantaddbtntext.textContent = INC.config.add_text;
            break;
        case "am":
            elvariantaddbtntext.textContent = INC.config.add_text;
            break;
        }
        eladdvarianttext.classList.remove('simple')
    } else if (sizezero["att0Array"].length > 0) {
        eladdvarianttext.classList.remove('simple')
        eladdvarianttext.textContent = "Selectati optiunile";
        eladdvarianttext.classList.add('config')
        elAttBlock.classList.add('attributes_avail')
        elAttSizeTitleText.textContent = "View Sizes";
        elconfigtitle.textContent = "Please select your Size";
        switch (blockType) {
        case "pdp":
            elvariantaddbtntext.textContent = "Add to bundle";
            break;
        case "sidebar":
            elvariantaddbtntext.textContent = INC.config.add_text;
            break;
        case "am":
            elvariantaddbtntext.textContent = INC.config.add_text;
            break;
        }
    }

    elvariantaddbtn.addEventListener('click', function() {
        //debugger
        if ((this.textContent.trim() == "Update" || this.parentNode.classList.contains('config_avail') == true) && this.innerText.trim() != "Add To Bag") {
            var moduleblk = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
            var flag_check = INC.methods.checkVariantSelection(moduleblk)
            if (flag_check == 1 || flag_check == 3) {
                if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
                    document.querySelector('html').classList.remove('inc_overlay')
                }
                this.parentNode.parentNode.querySelector('.inc_product_desc_variant_popup_close_block').click()
                this.parentNode.parentNode.querySelector('.inc_product_desc_variant_popup_close_block').click()
                var delayset = 0
                productBlock.classList.remove('show_overlay')
                if (this.textContent.trim() == "Add") {
                    this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_add_block').click()
                }
            } else {
                if (flag_check == 2 || flag_check == 0) {
                    if (flag_check != 0) {
                        if (this.parentNode.parentNode.querySelector('.inc_variant_tag') != null) {
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select a Color";
                            this.parentNode.parentNode.querySelector('.inc_variant_tag').setAttribute('style', 'border:1px solid #E52B45;')
                        }
                    }

                    if (this.parentNode.querySelector('.inc_product_desc_add_title_text_block') != null) {
                        if (this.parentNode.getAttribute('data-color') == null && this.parentNode.getAttribute('data-zero') != null && this.parentNode.getAttribute('data-size') != null) {
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size and Color options";
                        } else if (this.parentNode.getAttribute('data-color') != null && this.parentNode.querySelectorAll('inc_product_desc_att_color_list_item_block.inc_active').length > 0) {
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size";
                        } else if (this.parentNode.getAttribute('data-zero') != null || this.parentNode.getAttribute('data-size') != null) {
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select a Color";
                        }
                        this.parentNode.querySelector('.inc_product_desc_add_title_text_block').setAttribute('style', 'display:block;')
                    }

                }
            }
        } else {
            if (this.innerText.trim() == "Add To Bag" || this.innerText.trim() == "SELECT") {
                var moduleblk = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                var flag_check = INC.methods.checkVariantSelection(moduleblk)
                if (flag_check == 1 || flag_check == 3) {
                    if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
                        document.querySelector('html').classList.remove('inc_overlay')
                    }
                    this.parentNode.parentNode.querySelector('.inc_product_desc_variant_popup_close_block').click()
                    this.parentNode.parentNode.querySelector('.inc_product_desc_variant_popup_close_block').click()

                    productBlock.classList.remove('show_overlay')
                    if (this.textContent.trim() == "Add To Bag" || this.textContent.trim() == "SELECT" || this.textContent.trim() == "Add") {
                        this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_add_block').click()
                    }
                } else {
                    if (flag_check == 2 || flag_check == 0) {
                        if (this.parentNode.querySelector('.inc_product_desc_add_title_text_block') != null) {
                            if (this.parentNode.getAttribute('data-color') == null && this.parentNode.getAttribute('data-zero') == null && this.parentNode.getAttribute('data-size') == null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size and Color options";
                            } else if (this.parentNode.getAttribute('data-zero') == null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size";
                            } else if (this.parentNode.getAttribute('data-zero') != null || this.parentNode.getAttribute('data-size') != null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select a Color";
                            }
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').setAttribute('style', 'display:block;')
                        }

                        if (flag_check == 0) {
                            if (this.parentNode.querySelector('.inc_product_desc_add_title_text_block') != null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your size";
                            }
                        }
                    }
                }
            } else {
                var moduleblk = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                var flag_check = INC.methods.checkVariantSelection(moduleblk)
                if (flag_check == 1 || flag_check == 3) {
                    this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_add_block').click()
                    this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_variant_popup_close_block').click()
                } else {
                    if (flag_check == 2 || flag_check == 0) {
                        if (flag_check != 0) {
                            if (this.parentNode.parentNode.querySelector('.inc_variant_tag') != null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select a Color";
                            }
                        }

                        if (this.parentNode.querySelector('.inc_product_desc_add_title_text_block') != null) {
                            if (this.parentNode.getAttribute('data-color') == null && this.parentNode.getAttribute('data-zero') == null && this.parentNode.getAttribute('data-size') == null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size and Color options";
                            } else if (this.parentNode.getAttribute('data-color') != null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your Size";
                            } else if (this.parentNode.getAttribute('data-zero') != null || this.parentNode.getAttribute('data-size')) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select a Color";
                            }
                            this.parentNode.querySelector('.inc_product_desc_add_title_text_block').setAttribute('style', 'display:block;')
                        }

                        if (flag_check == 0) {
                            if (this.parentNode.querySelector('.inc_product_desc_add_title_text_block') != null) {
                                this.parentNode.querySelector('.inc_product_desc_add_title_text_block').innerText = "Please select your size";
                            }
                        }
                    }
                }
            }

        }
    })

    elselectoptaddbtn.addEventListener('click', function() {
        //debugger
        if (document.querySelector('.inc_product_desc_att_block.inc_active') != null) {
            document.querySelector('.inc_product_desc_att_block.inc_active').classList.remove('inc_active')
        }
        if (document.querySelector('.inc_pdp_block') != null) {
            var doc = document.querySelector('.inc_pdp_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        } else if (document.querySelector('.inc_af_block') != null) {
            var doc = document.querySelector('.inc_af_block');
            inc_scroll_height = (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
        }
        if (this.querySelector('.inc_product_variant_simple_text.simple') != null) {
            this.parentNode.parentNode.parentNode.querySelector('.inc_product_desc_add_block').click()
        } else {
            if (window.innerWidth < 768 && INC.config.pageType != "cartPage") {
                document.querySelector('html').classList.add('inc_overlay')
                document.querySelector('body').style.overflow = "hidden"
                productBlock.classList.add('show_overlay')
                this.parentNode.querySelector('.inc_product_desc_att_block.attributes_avail').classList.add('inc_active')
                // document.querySelector('html').classList.add('inc_overlay');
                // this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_product_modal_block').classList.add('inc_active')
                // if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block') != null) {
                //     document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.add('overflow_visible')
                //     document.querySelector('body').classList.add('inc_popup_open');
                // }
            } else {
                document.querySelector('html').classList.add('inc_overlay');
                this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('.inc_product_modal_block').classList.add('inc_active')
                if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block') != null) {
                    document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.add('overflow_visible')
                    document.querySelector('body').classList.add('inc_popup_open');
                }
            }

            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_af_product-list_block')) {
                document.querySelector('html').classList.add('inc_overlay');
            }
            productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_info_main_block').classList.add('inc_active');
            productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_description_main_block').classList.remove('inc_active');
        }
    })
    switch (blockType) {
    case "pdp":
        elAddText.textContent = "Add";
        break;
    case "sidebar":
        elAddText.textContent = INC.config.add_text;
        break;
    case "am":
        elAddText.textContent = INC.config.add_text;
        break;
    }
    elAddBlock.addEventListener("click", function() {
        var productModuleBlock = productBlock.parentNode.parentNode;
        if (INC.config.pageType == "cartPage") {
            if(productModuleBlock.querySelector('.inc_product_block.inc_checked') != null){
                productModuleBlock.querySelector('.inc_product_block.inc_checked').classList.remove('inc_checked')
                productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = 'Selecteaza produsul';
                productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = 'Selecteaza produsul';
            }else{
                productModuleBlock.querySelector('.inc_product_block').classList.add('inc_checked')
                productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = INC.config.added_text;
                productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = INC.config.added_text;
            }
            setTimeout(function(){
                updateplpactivemodalprc()
            },100)
        }else{
            var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
            var flag_check = INC.methods.checkVariantSelection(productModuleBlock)
            var sku = productBlock.getAttribute('data-sku');
            var mainId = productBlock.getAttribute('data-main_id');
            var main_id = productBlock.getAttribute('data-main_id');
            var bundle_id = productBlock.getAttribute('data-bundle_id');
            var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
            var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');
            var qty = parseInt(elQtyInput.value);
            if (qty < 1)
                qty = 1
            var prod_card = elAddText.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
            if (flag_check == 1) {
                elAddText.textContent = INC.config.adding_text + "...";
                elAddText.parentNode.parentNode.setAttribute("style", "pointer-events: none;opacity: 0.5;");
            } else {
                if (document.querySelector('.inc_product_modal_block.inc_active') == null) {
                    productModuleBlock.querySelector('.inc_product_details_prod_block').click()
                }
            }
        }
    });
    return productBlock;
}

INC.methods.createProductModalBlock = function(pdpProductId, blockType, bundleProductListCheck, parentblock, elmodalblock) {
    var productBlock = elmodalblock.querySelector('.inc_product_block')
    var findObj = new INC.classes.FindObj({
        id: pdpProductId
    });
    var productObj = INC.dataStore.methods().getProductById(findObj);

    productBlock.setAttribute('data-id', productObj.id);
    productBlock.setAttribute('data-sku', productObj.sku);
    productBlock.setAttribute('data-main_id', productObj.mainId);
    productBlock.setAttribute('data-bundle_id', productObj.bundleId);
    productBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
    productBlock.classList.add(productObj.ProductType)

    var main_prod_id = productObj.mainId

    var elHeaderInfoBlck = productBlock.querySelector('.inc_product_info_main_block');
    var elHeader = productBlock.querySelector('.inc_product_header_main_block');
    var elImgBlock = productBlock.querySelector('.inc_product_img_block');
    var elImgGalleryListBlock = productBlock.querySelector('.inc_product_img_gallery_list_block');
    var elTitleBlock = productBlock.querySelector('.inc_product_desc_title_block');
    var elTitleTextBlock = productBlock.querySelector('.inc_product_desc_title_text_block');
    var elTitleText = productBlock.querySelector('.inc_product_desc_title_text');
    var elproductPriceBlock = productBlock.querySelector('.inc_product_desc_ecirp_block');
    var elproductPriceLabel = productBlock.querySelector('.inc_product_ecirp_label_block');
    var elPriceActiveText = productBlock.querySelector('.inc_product_desc_ecirp_active_text');
    ;var elPriceActiveMsg = productBlock.querySelector('.inc_product_desc_ecirp_active_text_msg');
    var elPriceRegularText = productBlock.querySelector('.inc_product_desc_ecirp_regular_text');
    var eleditblock = productBlock.querySelector('.inc_product_desc_att_edit_block');
    var elAttBlock = productBlock.querySelector('.inc_product_desc_att_block');
    var elAttColorBlock = productBlock.querySelector('.inc_product_desc_att_color_block');
    var elAttColorTitleText = productBlock.querySelector('.inc_product_desc_att_color_title_text');
    var elAttColorTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_color_title_text_selected');
    var elAttColorListBlock = productBlock.querySelector('.inc_product_desc_att_color_list_block');
    var elAttSizeBlock = productBlock.querySelector('.inc_product_desc_att_size_block');
    var elAttSizeTitleBlock = productBlock.querySelector('.inc_product_desc_att_size_title_block');
    var elAttSizeTitleText = productBlock.querySelector('.inc_product_desc_att_size_title_text');
    var elAttSizeTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_size_title_text_selected');
    var elAttSizeListBlock = productBlock.querySelector('.inc_product_desc_att_size_list_block');
    var elAtt0ListBlock = productBlock.querySelector('.inc_product_desc_att_zero_list_block');
    var elAtt3ListBlock = productBlock.querySelector('.inc_product_desc_att_third_list_block');
    var elAtt4ListBlock = productBlock.querySelector('.inc_product_desc_att_fourth_list_block');

    var elAtt0Block = productBlock.querySelector('.inc_product_desc_att_zero_block');
    var elAtt3Block = productBlock.querySelector('.inc_product_desc_att_third_block');
    var elAtt4Block = productBlock.querySelector('.inc_product_desc_att_fourth_block');
    var elAtt0TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_zero_title_text_selected');
    var elAtt0TitleText = productBlock.querySelector('.inc_product_desc_att_zero_title_text');
    var elAtt3TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_third_title_text_selected');
    var elAtt3TitleText = productBlock.querySelector('.inc_product_desc_att_third_title_text');
    var elAtt4TitleTextSelected = productBlock.querySelector('.inc_product_desc_att_fourth_title_text_selected');
    var elAtt4TitleText = productBlock.querySelector('.inc_product_desc_att_fourth_title_text');
    var elQtyBlock = productBlock.querySelector('.inc_product_qty_block');
    var elQtyInputText = productBlock.querySelector('.inc_product_desc_qty_input_text');
    var elQtyDownBlock = productBlock.querySelector('.inc_product_qty_down_block');
    var elQtyUpBlock = productBlock.querySelector('.inc_product_qty_up_block');
    var elAddBlock = productBlock.querySelector('.inc_product_desc_add_block');
    var elAddText = productBlock.querySelector('.inc_product_desc_add_text');
    var elAddImg = productBlock.querySelector('.inc_product_desc_add_img');
    var elratingsBlock = productBlock.querySelector('.inc_product_desc_ratings_block');
    var elworthPrice = productBlock.querySelector('.inc_product_desc_ecirp_worth_text');
    var eldetailsprodblock = productBlock.querySelector('.inc_product_desc_att_details_block');
    var eladdvarianttext = productBlock.querySelector('.inc_product_variant_simple_text');
    var elconfigtitle = productBlock.querySelector('.inc_product_desc_add_title_text_block');
    var elvariantaddbtn = productBlock.querySelector('.inc_product_desc_att_variant_add_block');
    var elvariantaddbtntext = productBlock.querySelector('.inc_product_desc_att_variant_text');
    var elvariantviewdetails = productBlock.querySelector('.inc_product_desc_att_variant_view_details_block');
    var elvariantviewdetailstext = productBlock.querySelector('.inc_product_desc_att_variant_view_details_text');
    var eldescblock = productBlock.querySelector('.inc_product_desc_block');
    var elbstxtblock = productBlock.querySelector('.inc_product_bstxt_block');
    var elvariantpopupclose = productBlock.querySelector('.inc_product_desc_variant_popup_close_block');
    var elselectoptaddbtn = productBlock.querySelector('.inc_product_variant_simple_block');
    var elsizetitleblock = productBlock.querySelector('.inc_product_desc_att_zero_title_block');
    var eldescrpionblock = productBlock.querySelector('.inc_product_desc_block');

    var productDescQtyInputText = productBlock.querySelector('.inc_product_qty_input_text');
    var productDescQtyBlock = productBlock.querySelector('.inc_product_qty_block');
    var productDescAddText = productBlock.querySelector('.inc_product_add_text');
    var elQtyAddBtnBlock = productBlock.querySelector('.inc_product_desc_qty_add_btn_block');
    var elGalleryRightArrow = productBlock.querySelector('.inc_product_img_gallery_right_block');
    var elGallerylefttArrow = productBlock.querySelector('.inc_product_img_gallery_left_block');
    var productDescriptionMainBlock = productBlock.querySelector('.inc_product_description_main_block');
    var productHeaderMainBlockTitle = productBlock.querySelector('.inc_product_header_main_title_block')
    var productHeaderMainBlockRating = productBlock.querySelector('.inc_product_header_main_rating_block')
    var elproductPriceLabel = productBlock.querySelector('.inc_product_ecirp_label_block')
    var elcolortitleblock = productBlock.querySelector('.inc_product_desc_att_color_title_block')

    var elcosprodsku = productBlock.querySelector('.cosproductsku')
    elcosprodsku.innerHTML = "Cod Produs" + "<span>"+productObj.id+"</span>"
    elproductPriceLabel.innerHTML = "SALE"

    elHeader.querySelector('.inc_product_header_img_block').addEventListener("click", function() {
        if (document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
            document.querySelector('html').classList.remove('inc_overlay');
            document.querySelector('body').classList.remove('inc_popup_open');
        }
        if (document.querySelector('.inc_sidebar_modal_block.inc_active') != null) {
            document.querySelector('.inc_sidebar_modal_block.inc_active').classList.remove('overflow_visible')
        }
        if (productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_qty_input_text input') != null && productBlock.parentNode.parentNode.querySelector('.inc_product_showcase_block .inc_product_desc_qty_input_text input') != null) {
            if (productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_qty_input_text input').value != productBlock.parentNode.parentNode.querySelector('.inc_product_showcase_block .inc_product_desc_qty_input_text input').value) {
                productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_qty_input_text input').value = productBlock.parentNode.parentNode.querySelector('.inc_product_showcase_block .inc_product_desc_qty_input_text input').value
            }
        }
        if (inc_scroll_height > 100) {
            window.scrollTo(0, inc_scroll_height);
        }
        productBlock.parentNode.classList.remove("inc_active");
        productBlock.parentNode.querySelector('.inc_product_header_title_block').classList.add('inc_active');
        //productBlock.parentNode.querySelector('.inc_product_header_title_block_1').classList.remove('inc_active');
        if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('body.active-gnav, body.product-shades-sidebar-active') == null) {
            document.querySelector('body').setAttribute('style', 'overflow:auto')
        }
    });

    var elImgMainImg = elImgBlock.querySelector('.inc_product_img_main_img');
    var elImgTag1 = generate_html_tag('img');
    elImgTag1.src = productObj.imageURLMain
    if (elImgTag1 == true) {
        elImgTag1.src = productObj.imageURLMain
    }
    elImgTag1.setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
    elImgTag1.setAttribute('role', 'img')
    elImgTag1.setAttribute('aria-label', 'Image')
    elImgTag1.setAttribute('alt', productObj.nameMain.toLocaleLowerCase())
    if (window.innerWidth < 821) {
        if (productObj.otherImageList != null && productObj.otherImageList.length < 2) {
            elGalleryRightArrow.style.display = 'none';
            elGallerylefttArrow.style.display = 'none';
        }
    } else {
        if (productObj.otherImageList != null && productObj.otherImageList.length < 6) {
            elGalleryRightArrow.style.display = 'none';
            elGallerylefttArrow.style.display = 'none';
        }
    }
    var productLink = document.createElement('a');
    if(window.innerWidth > 768){
        productLink.target = "_blank";
    }
    productLink.setAttribute('rel', 'noopener noreferrer')
    productLink.href = productObj.url;
    productLink.appendChild(elImgTag1);
    productLink.style.cursor = 'pointer';
    productLink.setAttribute('otherImageList', productObj["otherImageList"])
    productLink.setAttribute('imageURL', productObj["imageURLMain"])
    add_swipe(productLink)
    elImgMainImg.appendChild(productLink);
    elImgMainImg.addEventListener("click", function() {
        INC.methods.sendBundleClickTracking(productBlock.getAttribute('data-main_id'));
        getTrackingPixel();
    });
    elImgGalleryListBlock.innerHTML = "";
    if ((productObj.otherImageList != null) && productObj.otherImageList.length > 1) {
        var otimg = 0
        productObj.otherImageList.forEach(function(otherImgURL) {
            otherImgURL = otherImgURL;
            var elImgGalleryListItemBlock = generate_html_tag('div', 'inc_product_img_gallery_list_item_block')
            var imglist = '<div class="inc_product_img_gallery_list_item_img_block"><div class="inc_product_img_gallery_list_item_img"><img class="inc_lazy" data-src="' + otherImgURL + '" src="' + otherImgURL + '" role="img" aria-label="Image" alt="' + productObj.name + '"></div></div><div class="inc_product_img_gallery_list_item_text_block"><div class="inc_product_img_gallery_list_item_text"></div></div>'
            elImgGalleryListItemBlock.innerHTML = imglist

            var elImgGalleryListItemImg = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img');

            var elOtherImgTag = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img img')
            elOtherImgTag.src = otherImgURL
            elOtherImgTag.setAttribute('alt', productObj.name)
            elOtherImgTag.setAttribute('role', 'img')
            elOtherImgTag.setAttribute('aria-label', 'Image')
            elOtherImgTag.setAttribute('onerror', "this.src='" + INC.config.noimage + "'");

            if (productObj.otherImageList.length > 4) {
                elImgGalleryListItemImg.classList.add('OthImg4');
            }

            elImgGalleryListItemBlock.setAttribute('index', otimg)
            elImgGalleryListItemBlock.addEventListener("click", function() {
                Array.prototype.forEach.call(productBlock.querySelectorAll('.inc_product_img_gallery_list_item_block'), function(galleryListItemBlock) {
                    galleryListItemBlock.classList.remove("inc_active");
                });

                elImgGalleryListItemBlock.classList.add("inc_active");

                elImgMainImg.querySelector('img').src = otherImgURL;
                elImgMainImg.querySelector('img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
            })

            elImgGalleryListBlock.appendChild(elImgGalleryListItemBlock);
            if (otimg == 0) {
                elImgGalleryListItemBlock.classList.add('inc_active')
            }
            otimg++;
            if (productObj.otherImageList.length > 5) {
                elImgGalleryListItemBlock.parentNode.classList.add("flex-start")
            }
        });
    } else {
        productBlock.classList.add('inc_other_noimage')
    }
    elTitleBlock.addEventListener("click", function() {
        INC.methods.sendBundleClickTracking(productBlock.getAttribute('data-main_id'));
        getTrackingPixel();
    });
    var pTitleDiv = document.createElement('div');
    pTitleDiv.innerText = productObj.nameMain;
    var pLinkModal = document.createElement('a');
    pLinkModal.setAttribute("title", productObj.nameMain);
    pLinkModal.setAttribute("href", productObj.url);
    if(window.innerWidth > 768){
        pLinkModal.setAttribute("target", "_blank");
    }
    pLinkModal.setAttribute('rel', 'noopener noreferrer')
    pLinkModal.innerText = productObj.nameMain;
    productHeaderMainBlockTitle.appendChild(pLinkModal)
    pLinkModal.addEventListener("click", function() {
        INC.methods.sendBundleClickTracking(productObj.mainId);
        getTrackingPixel()
    });

    var field1 = productObj.ratingsCount
    var field2 = productObj.reviewsCount
    INC.methods.get_product_ratings(field1, field2, elratingsBlock);
    var pLinkModalSKU = document.createElement('span');
    pLinkModalSKU.classList.add("product_modal_sku");
    pLinkModalSKU.innerText = "#" + productObj.sku
    productHeaderMainBlockRating.appendChild(pLinkModalSKU)

    var pLink = document.createElement('a');
    pLink.href = productObj.url;
    if(window.innerWidth > 768){
        pLink.setAttribute("target", "_blank");
    }
    pLink.setAttribute('style', 'text-transform: unset;')
    pLink.setAttribute('title', productObj.nameMain)
    pLink.appendChild(pTitleDiv);
    elTitleText.appendChild(pLink);
    var totalsaveprc = get_discount_price(productObj.regularPriceMain, productObj.activePriceMain)
    var activePrice = parseFloat(productObj.activePriceMain).toFixed(2).toString();
    var regularPrice = parseFloat(productObj.regularPriceMain).toFixed(2).toString();
    // var worthPrice = parseFloat(productObj.worthPrice).toFixed(2).toString();

    elPriceRegularText.innerText = "";
    if (activePrice != regularPrice && regularPrice != "" && regularPrice != null && regularPrice != 0) {
        elPriceActiveText.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
        if (productObj.pricingCount != "") {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        } else {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        }
        // elworthPrice.innerHTML = "Save " + formatter.format(totalsaveprc);
    } else {
        if (productObj.pricingCount != "") {
            elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        } else {
            elPriceActiveText.innerText = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        }
        // elworthPrice.innerHTML = "";
    }
    var elQtyInput = generate_html_tag('input');
    elQtyInput.setAttribute('type', "number");
    elQtyInput.setAttribute('aria-label', "quantity");
    elQtyInput.setAttribute('min', 1);
    elQtyInput.setAttribute('max', 999);
    elQtyInput.setAttribute('maxlength', 3);
    elQtyInput.value = 1;
    elQtyInput.setAttribute('old_qty', '1');
    // elQtyInput.setAttribute('readOnly', '');
    elQtyInput.setAttribute('pattern', '/^-?\d+\.?\d*$/');
    elQtyInput.setAttribute("onkeydown", "if(event.key==='.'){event.preventDefault();}");
    elQtyInput.setAttribute('onKeyPress', 'if(this.value.length==3) return false;');
    elQtyInput.setAttribute('oninput', "validity.valid||(value='1')");
    productDescQtyBlock.classList.add('singleqty')

    elQtyInput.addEventListener("keydown", function(event) {
        var old_qty = this.value
        var keyCode = event.which || event.keyCode;
        if (keyCode === 13) {
            event.preventDefault();
        } else if (($.inArray(event.keyCode, incallowedKeys) !== -1) || (keyCode === 65 && (event.ctrlKey || event.metaKey)) || (keyCode >= 35 && keyCode <= 40)) {
            return;
        }
        var charValue = String.fromCharCode(keyCode)
          , valid = /^[0-9]+$/.test(charValue);
        if (!valid) {
            event.preventDefault();
        } else {
            setTimeout(function() {
                if (elQtyInput.value.length == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value > 99)
                    elQtyInput.value = 99;

                var productModuleBlock = productBlock.parentNode.parentNode;
                var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
                var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
                showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
                showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
                modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
                var id = productBlock.getAttribute('data-id');
                var qty = parseInt(elQtyInput.value);
                var main_id = productBlock.getAttribute('data-main_id');
                var bundle_id = productBlock.getAttribute('data-bundle_id');
                var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
                var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');
                if (elAddText.textContent == 'Added' || elAddText.textContent == "Update") {
                    INC.methods.updateBundleCart({
                        sku: id,
                        qty: qty
                    }, "add", main_id, bundle_id, pname, pprice);
                }
                if (elQtyInput.value == 1) {
                    elQtyBlock.classList.add('singleqty')
                }
                if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                }
            }, 50);
        }
    });
    elQtyInput.addEventListener('focusout', function(ev) {
        var old_qty = this.value
        var elm = ev.currentTarget
        if (elm.tagName != "INPUT") {
            elm = elm.querySelector('input')
        }
        var prod_card = elm.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        if (prod_card.classList.contains('inc_product_showcase_block') == true) {
            prod_card = elm.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        }
        if (elm.value.length == 0) {
            setTimeout(function() {
                if (elQtyInput.value.length == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value == 0)
                    elQtyInput.value = 1;
                if (elQtyInput.value > 99)
                    elQtyInput.value = 99;

                var productModuleBlock = productBlock.parentNode.parentNode;
                var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
                var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
                showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
                showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
                modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
                var id = productBlock.getAttribute('data-id');
                var qty = parseInt(elQtyInput.value);
                var main_id = productBlock.getAttribute('data-main_id');
                var bundle_id = productBlock.getAttribute('data-bundle_id');
                var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
                var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');
                if (elAddText.textContent == 'Added' || elAddText.textContent == "Update") {
                    INC.methods.updateBundleCart({
                        sku: id,
                        qty: qty
                    }, "add", main_id, bundle_id, pname, pprice);
                }
                if (elQtyInput.value == 1) {
                    elQtyBlock.classList.add('singleqty')
                }
                if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                    var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                    if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                        INC.methods.updateallbasketprice(bundleblock)
                    }
                }
            }, 50);
        }
    });

    productDescQtyInputText.appendChild(elQtyInput);
    elQtyDownBlock.addEventListener('click', function() {
        var prod_card = elQtyInput.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        elQtyInput.value = (elQtyInput.value - 1 < 1) ? 1 : elQtyInput.value - 1;

        if (elQtyInput.value == 1) {
            productDescQtyBlock.classList.add('singleqty')
        }
        var productModuleBlock = productBlock.parentNode.parentNode;
        var productModuleBlock = productBlock.parentNode.parentNode;
        var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
        var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')

        showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
        modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
        showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
        modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
        var id = productBlock.getAttribute('data-id');
        var sku = productBlock.getAttribute('data-sku');
        var qty = parseInt(elQtyInput.value);
        var bundle_id = productBlock.getAttribute('data-bundle_id');
        var main_id = productBlock.getAttribute('data-main_id');
        var pname = productBlock.querySelector('.inc_product_desc_title_text').innerText;
        var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').innerText.replace('$', '');
        if (parseInt(elQtyInput.value) == 1 && productDescQtyBlock.classList.contains('singleqty') == true) {
            if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {
                var modal_blck = productModuleBlock.querySelector('.inc_product_modal_block')
                var showcase_blck = productModuleBlock.querySelector('.inc_product_showcase_block')
                var elAddTextshowcase = showcase_blck.querySelector('.inc_product_desc_add_text')
                var elAddTextmodal = modal_blck.querySelector('.inc_product_desc_add_text')
                if (INC.config.pageType == "pdp" && blockType == "pdp")
                    INC.methods.updateBundleCart({
                        sku: id,
                        qty: qty
                    }, "add", main_id, bundle_id, pname, pprice);
            }
        } else {
            if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {
                INC.methods.updateBundleCart({
                    sku: id,
                    qty: qty
                }, "add", main_id, bundle_id, pname, pprice);
            }
        }
        if (elQtyInput.value == 1) {
            elQtyBlock.classList.add('singleqty')
            productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.add('singleqty')
            productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.add('singleqty')
        }
        setTimeout(function() {
            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            }
        }, 200)
    });

    elQtyUpBlock.addEventListener('click', function() {
        var prod_card = elQtyInput.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
        elQtyInput.value = (parseInt(elQtyInput.value) + 1 > 99) ? 99 : parseInt(elQtyInput.value) + 1;

        var productModuleBlock = productBlock.parentNode.parentNode;

        var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
        var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')

        showcaseProductBlock.querySelector('.inc_product_qty_block').querySelector('input').value = parseInt(elQtyInput.value);
        modalProductBlock.querySelector('.inc_product_qty_input_text input').value = parseInt(elQtyInput.value);
        showcaseProductBlock.querySelector('.inc_product_add_text_block').classList.remove('disable_btn')
        modalProductBlock.querySelector('.inc_product_desc_add_text_block').classList.remove('disable_btn')
        productDescQtyBlock.classList.remove('singleqty')
        productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_qty_block').classList.remove('singleqty')
        var id = productBlock.getAttribute('data-id');
        var qty = parseInt(elQtyInput.value);
        var bundle_id = productBlock.getAttribute('data-bundle_id');
        var main_id = productBlock.getAttribute('data-main_id');
        var pname = productBlock.querySelector('.inc_product_desc_title_text').innerText;
        var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').innerText.replace('$', '');
        if (elAddText.textContent == "Added" || elAddText.textContent == "Update" || elAddText.textContent == INC.config.AddedText || elAddText.textContent == INC.config.UpdateText) {
            INC.methods.updateBundleCart({
                sku: id,
                qty: qty
            }, "add", main_id, bundle_id, pname, pprice);
        }
        setTimeout(function() {
            if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == true) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            } else if (productBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_product-main_block') == false) {
                var bundleblock = productBlock.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode
                if (bundleblock.classList.contains('inc_pdp_bundle_block') == true) {
                    INC.methods.updateallbasketprice(bundleblock)
                }
            }
        }, 200)
    });

    findObj = new INC.classes.FindObj({
        mainId: productObj.mainId
    });
    if (INC.dataStore.methods().getProductColorsObj(findObj).colorArray.length == 0 && INC.dataStore.methods().getProductopt0Obj(findObj).att0Array.length == 0) {
        elHeader.querySelector('.inc_product_header_title_text').innerText = "Overview";
    } else {
        if (INC.dataStore.methods().getProductopt0Obj(findObj).att0Array.length > 0) {
            if (INC.dataStore.methods().getProductopt0Obj(findObj).att0Array[0] != undefined) {
                elHeader.querySelector('.inc_product_header_title_text').innerText = "Overview";
            } else {
                elHeader.querySelector('.inc_product_header_title_text').innerText = "Overview";
            }
        } else if (INC.dataStore.methods().getProductColorsObj(findObj).colorArray.length > 0) {
            elHeader.querySelector('.inc_product_header_title_text').innerText = "Overview";
        }
    }
    var inc_product_header_title_block_1 = productBlock.querySelector('.inc_product_header_title_block')
    var inc_product_header_title_text_block_1 = productBlock.querySelector('.inc_product_header_title_text_block_1')
    //var inc_product_header_title_text_1 = productBlock.querySelector('.inc_product_header_title_text_1')
   // inc_product_header_title_text_1.innerText = "Product Details";
    if (window.innerWidth < 821) {
        productDescriptionMainBlock.innerHTML = "<span>Description</span>" + productObj.description;
    } else {
        productDescriptionMainBlock.innerHTML = productObj.description;
    }

    var inc_product_header_title_block = inc_product_header_title_block_1.parentNode.querySelector('.inc_product_header_title_block');

    var inc_product_header_new_page = productBlock.querySelector('.inc_product_header_new_page')
    var inc_product_header_new_page_text = productBlock.querySelector('.inc_product_header_new_page .inc_product_header_new_page_text')
    inc_product_header_new_page_text.innerText = "Open In A New Tab"
    inc_product_header_new_page_text.setAttribute("href", productObj.url)
    inc_product_header_new_page_text.setAttribute("target", "_blank")
    inc_product_header_new_page_text.setAttribute('rel', 'noopener noreferrer')
    inc_product_header_new_page.addEventListener("click", function() {
        INC.methods.sendBundleClickTracking(productObj.mainId);
        getTrackingPixel()
    });

    // inc_product_header_title_block_1.addEventListener('click', function() {
    //     this.parentNode.parentNode.parentNode.querySelector(".inc_product_description_main_block").classList.add("inc_active")
    //     this.parentNode.parentNode.parentNode.querySelector(".inc_product_info_main_block").classList.remove("inc_active")
    //     this.parentNode.querySelector('.inc_product_header_title_block').classList.remove("inc_active");
    //     this.classList.add("inc_active");
    //     var prod_desc_block = inc_product_header_title_block_1.parentNode.parentNode.parentNode;

    // });

    inc_product_header_title_block.classList.add('inc_active');

    inc_product_header_title_block.addEventListener('click', function() {
        this.parentNode.parentNode.parentNode.querySelector(".inc_product_description_main_block").classList.remove("inc_active")
        this.parentNode.parentNode.parentNode.querySelector(".inc_product_info_main_block").classList.add("inc_active")
        var prod_desc_block = inc_product_header_title_block_1.parentNode.parentNode.parentNode;
        inc_product_header_title_block.classList.add('inc_active');
        //inc_product_header_title_block_1.classList.remove('inc_active');
    });

    var product0Obj = INC.dataStore.methods().getProductopt0Obj(findObj);

    var productSizesObj = INC.dataStore.methods().getProductSizesObj(findObj);

    var productColorsObj = INC.dataStore.methods().getProductColorsObj(findObj);

    var product3Obj = INC.dataStore.methods().getProductopt3Obj(findObj);

    elAtt0ListBlock.innerHTML = "";
    elAttSizeListBlock.innerHTML = "";
    elAttColorListBlock.innerHTML = "";
    elAtt3ListBlock.innerHTML = "";

    if (product0Obj.att0Array.length > 0) {
        if (product0Obj["att0Array"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });
            elAtt0ListBlock.innerHTML = "";
            var product0Obj = product0Obj;
            var productSizeText = "";
            if (product0Obj["att0Array"].length > 0) {
                elAtt0TitleText.innerText = 'Selectati optiunile';
                elAtt0Block.classList.add("inc_active");
                elAtt0Block.classList.add("inc_total_" + product0Obj["att0Array"].length)
                product0Obj["att0Array"].forEach(function(sizeObj) {
                    var attSizeBlock0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_block');
                    var attSizeImgBlock0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img_block');
                    var attSizeImg0 = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img');

                    attSizeImgBlock0.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"zero")')
                    if (true) {
                        elAtt0TitleTextSelected.innerText = "Please select the " + product0Obj["att0Array"][0].code;
                        if (elAtt0TitleTextSelected.innerText == "Please select your Size") {// elAtt0TitleTextSelected.setAttribute('style', 'color:#FF0000')
                        }

                    }
                    attSizeImgBlock0.classList.add('avail')
                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];

                    reg.test(chckType);
                    if (sizeObj["imgSrc"].length > 0) {
                        if (sizeObj["colorCode"] == "" || sizeObj["colorCode"] == undefined) {
                            var sizeimg = generate_html_tag('img');
                            sizeimg.setAttribute('alt', sizeObj["text"])
                            sizeimg.src = sizeObj["imgSrc"]
                            attSizeImgBlock0.setAttribute('data-optionimge', sizeObj["imgSrc"])
                            attSizeImgBlock0.appendChild(sizeimg);
                            elAtt0TitleText.classList.add('img_tag_avail')
                            elAtt0TitleText.style.display = "flex"
                            attSizeImgBlock0.classList.add('img_avail')
                        }
                    }
                    attSizeImg0.textContent = sizeObj["text"];
                    attSizeImgBlock0.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock0.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock0.setAttribute('data-option', "1");
                    attSizeImgBlock0.setAttribute('data-cpid', sizeObj["cpid"])
                    if (product0Obj["att0Array"][0].code == "size") {
                        attSizeImgBlock0.setAttribute('title', sizeObj["text"].toUpperCase());
                    } else if (product0Obj["att0Array"][0].code == "letter") {
                        attSizeImgBlock0.setAttribute('title', "Letter" + " " + sizeObj["text"].toUpperCase());
                    } else if (product0Obj["att0Array"][0].code == "choose") {
                        attSizeImgBlock0.setAttribute('title', "Number " + sizeObj["text"].toUpperCase());
                    } else {
                        attSizeImgBlock0.setAttribute('title', sizeObj["text"].toUpperCase());
                    }

                    attSizeImgBlock0.appendChild(attSizeImg0);
                    elAtt0ListBlock.appendChild(attSizeImgBlock0);

                });

            }
        }
    }

    if (productSizesObj.sizeArray.length > 0) {
        if (productSizesObj["sizeArray"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });

            elAttSizeListBlock.innerHTML = "";
            var productSizeText = "";

            if (productSizesObj["sizeArray"].length > 0) {
                elAttSizeTitleText.innerText = productSizesObj["sizeArray"][0].code;
                elAttSizeBlock.classList.add("inc_active");
                productSizesObj["sizeArray"].forEach(function(sizeObj) {
                    var attSizeBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_block');
                    var attSizeImgBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img_block');
                    var attSizeImg = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img');
                    elAttSizeTitleTextSelected.innerText = "Please select option"
                    if (elAttSizeTitleTextSelected.innerText == "Please select option") {// elAttSizeTitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                    attSizeImgBlock.classList.add('avail')
                    attSizeImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"size")')
                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];

                    reg.test(chckType);

                    attSizeImg.innerText = sizeObj["text"];
                    attSizeImgBlock.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock.setAttribute('data-option', "2");
                    if (productSizesObj["sizeArray"][0].code == "size") {
                        attSizeImgBlock.setAttribute('title', sizeObj["text"].toUpperCase());
                    } else if (productSizesObj["sizeArray"][0].code == "letter") {
                        attSizeImgBlock.setAttribute('title', "Letter" + " " + sizeObj["text"].toUpperCase());
                    } else if (productSizesObj["sizeArray"][0].code == "choose") {
                        attSizeImgBlock.setAttribute('title', "Number " + sizeObj["text"].toUpperCase());
                    } else {
                        attSizeImgBlock.setAttribute('title', sizeObj["text"].toUpperCase());
                    }

                    attSizeImgBlock.appendChild(attSizeImg);
                    elAttSizeListBlock.appendChild(attSizeImgBlock);

                });

            }
        }
    }

    if (productColorsObj.colorArray.length > 0) {
        elAttColorListBlock.innerHTML = "";
        var one_attr_flag = false
        if (productColorsObj["colorArray"].length == 1) {
            one_attr_flag = true
        }
        if (productColorsObj["colorArray"].length > 0) {
            productColorsObj["colorArray"].forEach(function(colorObj) {
                elAttColorBlock.classList.add("inc_active");
                elAttColorTitleText.innerText = "Selectati optiunile ";
                var attColorBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_block')
                var attColorImgBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img_block');
                var attColorImg = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img');
                var attColorTextBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text_block');
                var attColorText = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text');

                // attColorImg.style.backgroundColor = colorObj["colorCode"];
                attColorImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"color")')
                if (true) {
                    elAttColorTitleTextSelected.innerText = "Please select a Color"
                    if (elAttColorTitleTextSelected.innerText == "Please select a Color") {// elAttColorTitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                }
                if (colorObj["colorCode"] != "" && colorObj["colorCode"] != undefined) {
                    var spancolorcode = generate_html_tag('span');
                    spancolorcode.setAttribute('alt', colorObj["text"])
                    spancolorcode.style.backgroundColor = colorObj["colorCode"];
                    attColorImg.appendChild(spancolorcode);
                } else if (colorObj["imgSrc"].length > 0) {
                    if (colorObj["colorCode"] == "") {
                        var colorImg = generate_html_tag('img');
                        colorImg.setAttribute('alt', colorObj["text"])
                        colorImg.src = colorObj["imgSrc"]
                        // if (productObj.categoryName != "") {
                        //     colorImg.classList.add(productObj.categoryName.replace(/\s/g, ''))
                        // }
                        attColorImg.appendChild(colorImg);
                    }
                }

                var colorTitle = generate_html_tag('a');
                colorTitle.innerText = colorObj["text"]
                colorTitle.title = colorObj["text"].toUpperCase();
                colorTitle.addEventListener('click', function(e) {
                    e.preventDefault();
                })

                attColorImg.appendChild(colorTitle);
                attColorImgBlock.setAttribute('data-color', colorObj["text"]);
                attColorImgBlock.setAttribute("datacolor", colorObj["text"].toLocaleLowerCase());
                attColorImgBlock.setAttribute('data-option', "0");
                attColorImgBlock.setAttribute('data-cpid', colorObj["cpid"])
                attColorImgBlock.setAttribute('data-colorcode', colorObj["colorCode"])
                attColorImgBlock.setAttribute('data-optionimge', colorObj["imgSrc"])
                attColorImgBlock.appendChild(attColorImg);
                attColorBlock.appendChild(attColorImgBlock);
                elAttColorListBlock.appendChild(attColorBlock);
                var prod_id = productBlock.getAttribute('data-main_id');
                if (one_attr_flag == true) {
                    setTimeout(function() {
                        if (INC.methods.getProductIdFromWebPage() == prod_id) {// attColorImgBlock.click()
                        }
                    }, 0)
                }
            });

        }
    }
    if (product3Obj.att3Array.length > 0) {
        if (product3Obj["att3Array"][0].code != "Color") {
            findObj = new INC.classes.FindObj({
                mainId: productObj.mainId
            });

            elAtt3ListBlock.innerHTML = "";
            var productSizeText = "";
            if (product3Obj["att3Array"].length > 0) {
                product3Obj["att3Array"].forEach(function(sizeObj) {
                    elAtt3TitleTextSelected.innerText = "Please select option"
                    if (elAtt3TitleTextSelected.innerText == "Please select option") {// elAtt3TitleTextSelected.setAttribute('style', 'color:#FF0000')
                    }
                    elAtt3TitleText.innerText = product3Obj["att3Array"][0].code + " " + ":";
                    elAtt3Block.classList.add("inc_active");
                    var attSizeBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_block');
                    var attSizeImgBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img_block');
                    var attSizeImg3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img');

                    attSizeImgBlock3.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blockType + '\',"third")')
                    attSizeImgBlock3.classList.add('avail')

                    if (productSizeText.length == 0) {
                        productSizeText = sizeObj["text"];
                    }
                    var reg = new RegExp('^[A-Z]|XS|S|M|L|XL|XXL|XXXL|XX|XXXXL|2XL|3XL|4XL$');
                    var chckType = sizeObj["text"];

                    reg.test(chckType);

                    attSizeImg3.innerText = sizeObj["text"];
                    attSizeImgBlock3.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock3.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock3.setAttribute('data-option', "3");

                    attSizeImgBlock3.appendChild(attSizeImg3);
                    elAtt3ListBlock.appendChild(attSizeImgBlock3);

                });
            }
        }
    }
    if (product0Obj["att0Array"].length > 0) {
        productBlock.querySelector('.inc_product_desc_att_zero_title_block').addEventListener('click', function() {
            if (document.querySelector('.inc_product_desc_att_color_block.show_dropdown') != null) {
                document.querySelector('.inc_product_desc_att_color_block.show_dropdown').classList.remove('show_dropdown')
            }
            this.parentNode.classList.toggle('show_dropdown')
        })
    }
    if (productColorsObj["colorArray"].length > 0) {
        productBlock.querySelector('.inc_product_desc_att_color_title_block').addEventListener('click', function() {
            if (document.querySelector('.inc_product_desc_att_zero_block.show_dropdown') != null) {
                document.querySelector('.inc_product_desc_att_zero_block.show_dropdown').classList.remove('show_dropdown')
            }
            this.parentNode.classList.toggle('show_dropdown')
        })
    }
    if (product0Obj.att0Array.length > 0 && productColorsObj.colorArray.length > 0) {
        elAttBlock.classList.add('clr_size_avl')
    }
    elGallerylefttArrow.setAttribute('title', 'Scroll left')
    elGalleryRightArrow.setAttribute('title', 'Scroll right')

    elGalleryRightArrow.addEventListener("click", function(e) {
        var prod_card = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
        var pr_id = prod_card.getAttribute('data-main_id')
        slideTo(pr_id, 0, prod_card, "right", "arrow")
    });
    elGallerylefttArrow.addEventListener("click", function(e) {
        var prod_card = this.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
        var pr_id = prod_card.getAttribute('data-main_id')
        slideTo(pr_id, 0, prod_card, "left", "arrow")
    });
    if ((productObj.otherImageList == null) || productObj.otherImageList.length < 2) {
        elGalleryRightArrow.style.display = "none"
        elGallerylefttArrow.style.display = "none"
    }
    switch (blockType) {
    case "pdp":
        elAddText.innerText = "Add to bundle";
        break;
    case "sidebar":
        elAddText.innerText = INC.config.add_text;
        break;
    case "am":
        elAddText.innerText = INC.config.add_text;
        break;
    }
    elAddBlock.addEventListener("click", function() {
        var productModuleBlock = productBlock.parentNode.parentNode;
        if (INC.config.pageType == "cartPage") {
            if(productModuleBlock.querySelector('.inc_product_block.inc_checked') != null){
                productModuleBlock.querySelector('.inc_product_block.inc_checked').classList.remove('inc_checked')
                productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = 'Selecteaza produsul';
                productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = 'Selecteaza produsul';
            }else{
                productModuleBlock.querySelector('.inc_product_block').classList.add('inc_checked')
                productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_add_text').innerText = INC.config.added_text;
                productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_add_text').innerText = INC.config.added_text;
            }
            if (document.querySelector('.inc_product_modal_block.inc_active') != null) {
                document.querySelector('.inc_product_modal_block.inc_active').classList.remove('inc_active')
                document.querySelector('body').classList.remove('inc_popup_open')
                if (inc_scroll_height > 100) {
                    window.scrollTo(0, inc_scroll_height);
                }
            }
            setTimeout(function(){
                updateplpactivemodalprc()
            },100)
        }else{
            productBlock.parentNode.querySelector('.inc_product_header_title_block').classList.add('inc_active');
            
            var flag_check = INC.methods.checkVariantSelection(productModuleBlock)
            if (document.querySelector('.sidebar_outer.sidebar_outer_active') == null) {
                document.querySelector('body').classList.remove('inc_popup_open')
                if(document.querySelector('.inc_product_modal_block.inc_active') == null){
                    document.querySelector('html').classList.remove('inc_overlay')
                }
            }
            var showcaseProductBlock = productModuleBlock.querySelector('.inc_product_showcase_block').querySelector('.inc_product_block');
            var modalProductBlock = productModuleBlock.querySelector('.inc_product_modal_block').querySelector('.inc_product_block')
            if (INC.config.pageType != "cartPage" && !INC.config.recommendation && INC.config.pageType != "ticket" && productModuleBlock.parentNode.className.indexOf('inc_af_product-list_block') == -1) {
                showcaseProductBlock.querySelector('.inc_product_desc_add_block').click();
            }

            if (productModuleBlock.classList.contains('configurable') == true) {
                if (flag_check == 1) {
                    setTimeout(function() {
                        if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_product_modal_block.inc_active') != null) {
                            document.querySelector('.sidebar_outer.sidebar_outer_active .inc_product_modal_block.inc_active').classList.remove('inc_active')
                            document.querySelector('body').classList.remove('inc_popup_open');
                            if (inc_scroll_height > 100) {
                                window.scrollTo(0, inc_scroll_height);
                            }
                            document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.remove('overflow_visible')
                        }
                    }, 200)
                } else {
                    if (productModuleBlock.querySelector('.inc_product_desc_att_block').getAttribute('data-zero') == null && productModuleBlock.querySelector('.inc_product_desc_att_block').getAttribute('data-color') == null) {} else if (productModuleBlock.querySelector('.inc_product_desc_att_block').getAttribute('data-zero') != null || productModuleBlock.querySelector('.inc_product_desc_att_block').getAttribute('data-size') != null) {}
                    productModuleBlock.querySelector('.inc_product_desc_add_title_text_block').setAttribute('style', 'color:#E52B45')
                    var element = document.querySelector('.inc_product_modal_block.inc_active .inc_product_block .inc_product_desc_att_color_block')
                    if (element != null) {
                        document.querySelector('html').classList.add('inc_popup_open')
                        document.querySelector('html').classList.add('inc_overlay')
                    }
                }
            } else {
                setTimeout(function() {
                    if (document.querySelector('.inc_sidebar_modal_block.inc_active .inc_product_modal_block.inc_active') != null) {
                        document.querySelector('.inc_sidebar_modal_block.inc_active .inc_product_modal_block.inc_active').classList.remove('inc_active')
                        document.querySelector('body').classList.remove('inc_popup_open')
                        if (inc_scroll_height > 100) {
                            window.scrollTo(0, inc_scroll_height);
                        }
                    }
                    if (document.querySelector('.inc_sidebar_modal_block.inc_active .inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block') != null) {
                        document.querySelector('.inc_sidebar_modal_block').classList.remove('overflow_visible')
                    }
                }, 100)
            }
            setTimeout(function() {
                if (document.querySelector('.sidebar_outer.sidebar_outer_active') != null && document.querySelector('.inc_product_modal_block.inc_active') == null) {
                    document.querySelector('.inc_sidebar_modal_block.inc_active').classList.remove('overflow_visible')
                }
            }, 200)
        }
    });
    return productBlock;
}
INC.methods.mappvariants = function(obj, blocktype, type_of_variant) {
    var size_flag = false;
    var colorflag = false;
    var thirdflag = false;
    if (type_of_variant == "zero") {
        size_flag = true;
        colorflag = true;
        thirdflag = true;
    } else if (type_of_variant == "color") {
        size_flag = true;
        thirdflag = true;
    } else if (type_of_variant == "size") {
        colorflag = true;
        thirdflag = true;
    } else if (type_of_variant == "third") {
        colorflag = true;
        size_flag = true;
    }
    if (obj.parentNode != undefined) {
        var productModuleBlck = obj.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
        if (productModuleBlck.classList.contains('inc_product_showcase_block') == true || productModuleBlck.classList.contains('inc_product_modal_block') == true) {
            productModuleBlck = productModuleBlck.parentNode
        }

        var productblockshow = productModuleBlck.querySelector('.inc_product_showcase_block .inc_product_block')
        var productblockmod = productModuleBlck.querySelector('.inc_product_modal_block .inc_product_block')

        var mainprdid = productblockshow.getAttribute('data-main_id')

        if (type_of_variant == "zero") {
            var sel_variant = obj.getAttribute('data-size')
            productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-zero', sel_variant)
            productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-zero', sel_variant)
        } else if (type_of_variant == "color") {
            var sel_variant = obj.getAttribute('data-color')
            productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-color', sel_variant)
            productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-color', sel_variant)
        } else if (type_of_variant == "size") {
            var sel_variant = obj.getAttribute('data-size')
            productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-size', sel_variant)
            productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-size', sel_variant)
        } else if (type_of_variant == "third") {
            var sel_variant = obj.getAttribute('data-size')
            productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-third', sel_variant)
            productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-third', sel_variant)
        }

        var main_p_id = INC.dataStore.methods().getFirstProductObjByMainId({
            mainId: mainprdid
        }).id;
        var findobj = new INC.classes.FindObj({
            id: main_p_id
        });
        var productObjs = INC.dataStore.methods().getProductById(findobj);
        var zero_text = productblockmod.querySelector('.inc_product_desc_att_block').getAttribute('data-zero');
        var size_text = productblockmod.querySelector('.inc_product_desc_att_block').getAttribute('data-size');
        var color_text = productblockmod.querySelector('.inc_product_desc_att_block').getAttribute('data-color');
        var third_text = productblockmod.querySelector('.inc_product_desc_att_block').getAttribute('data-third');

        findobj.mainId = mainprdid
        findobj.colorText = ""
        var sel_attr_text = ""
        if (color_text != undefined) {
            findobj.colorText = color_text
            productblockmod.querySelector('.inc_product_desc_att_color_title_text_selected').setAttribute('style', 'color:"#4D4D4F";')
            productblockmod.querySelector('.inc_product_desc_att_color_title_text_selected').innerText = color_text
            productblockshow.querySelector('.inc_product_desc_att_color_title_text_selected').setAttribute('style', 'color:"#4D4D4F";')
            productblockshow.querySelector('.inc_product_desc_att_color_title_text_selected').innerText = color_text
        }
        if (zero_text != undefined) {
            findobj.zeroText = zero_text
            productblockshow.querySelector('.inc_product_desc_att_zero_title_text_selected').innerText = zero_text
            productblockshow.querySelector('.inc_product_desc_att_zero_title_text_selected').setAttribute('style', 'color:"#4D4D4F";')
            productblockmod.querySelector('.inc_product_desc_att_zero_title_text_selected').classList.add('inc_change_color');
            productblockmod.querySelector('.inc_product_desc_att_zero_title_text_selected').innerText = zero_text
        }
        if (size_text != undefined) {
            findobj.sizeText = size_text
            productblockshow.querySelector('.inc_product_desc_att_size_title_text_selected').innerText = size_text
            productblockmod.querySelector('.inc_product_desc_att_size_title_text_selected').innerText = size_text
            productblockshow.querySelector('.inc_product_desc_att_size_title_text_selected').setAttribute('style', 'color:"#4D4D4F";')
            productblockmod.querySelector('.inc_product_desc_att_size_title_text_selected').setAttribute('style', 'color:"#4D4D4F";')
        }

        if (third_text != undefined) {
            findobj.thirdText = third_text
            productblockmod.querySelector('.inc_product_desc_att_third_title_text_selected').innerText = third_text
            productblockshow.querySelector('.inc_product_desc_att_third_title_text_selected').innerText = third_text
        }
        productblockmod.querySelector('.inc_product_desc_add_err_text_block').innerHTML = ""
        productblockshow.querySelector('.inc_variant_error_text').innerHTML = ""
        productblockshow.querySelector('.inc_product_variant_simple_text').setAttribute('style', '')
        productblockshow.querySelector('.inc_product_desc_add_title_text_block').setAttribute('style', '')

        var productSizesObj = INC.dataStore.methods().getProductSizesObj(findobj, obj);
        var productColorsObj = INC.dataStore.methods().getProductColorsObj(findobj, obj);
        var product3rdObj = INC.dataStore.methods().getProductopt3Obj(findobj, obj);

        var elAttSizeBlock = productblockmod.querySelector('.inc_product_desc_att_size_block')
        var elAttColorBlock = productblockmod.querySelector('.inc_product_desc_att_color_block')
        var elAtt3rdBlock = productblockmod.querySelector('.inc_product_desc_att_third_block')
        var elAttSizeListBlock = productblockmod.querySelector('.inc_product_desc_att_size_list_block')
        var elAttColorListBlock = productblockmod.querySelector('.inc_product_desc_att_color_list_block')
        var elAtt3ListBlock = productblockmod.querySelector('.inc_product_desc_att_third_list_block')
        var elselcolortextmodal = productblockmod.querySelector('.inc_product_desc_att_color_title_text_selected')
        var elcolortextmodal = productblockmod.querySelector('.inc_product_desc_att_color_title_text')
        var elAttSizeBlockshow = productblockshow.querySelector('.inc_product_desc_att_size_block')
        var elAttColorBlockshow = productblockshow.querySelector('.inc_product_desc_att_color_block')
        var elAtt3rdBlockshow = productblockshow.querySelector('.inc_product_desc_att_third_block')
        var elAttSizeListBlockshow = productblockshow.querySelector('.inc_product_desc_att_size_list_block')
        var elAttColorListBlockshow = productblockshow.querySelector('.inc_product_desc_att_color_list_block')
        var elAtt3ListBlockshow = productblockshow.querySelector('.inc_product_desc_att_third_list_block')
        var elselcolortextshow = productblockshow.querySelector('.inc_product_desc_att_color_title_text_selected')
        var elcolortextshow = productblockmod.querySelector('.inc_product_desc_att_color_title_text')

        if (type_of_variant == "zero" || type_of_variant == "third" || type_of_variant == "color") {
            elAttSizeListBlock.innerHTML = "";
            elAttSizeListBlockshow.innerHTML = "";
            if (productSizesObj["sizeArray"].length > 0) {
                elAttSizeBlock.classList.add("inc_active");
                productSizesObj["sizeArray"].forEach(function(sizeObj) {
                    var attSizeBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_block');
                    var attSizeImgBlock = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img_block');
                    var attSizeImg = generate_html_tag('div', 'inc_product_desc_att_size_list_item_img');
                    attSizeImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blocktype + '\',"size")')

                    attSizeImgBlock.classList.add('avail')
                    attSizeImg.innerText = sizeObj["text"];
                    attSizeImgBlock.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock.setAttribute('data-option', "2");
                    attSizeImgBlock.appendChild(attSizeImg);
                    var attSizeImgBlockclone = attSizeImgBlock.cloneNode(attSizeImgBlock);
                    elAttSizeListBlock.appendChild(attSizeImgBlock);
                    elAttSizeListBlockshow.appendChild(attSizeImgBlockclone);
                    if (size_text != undefined) {
                        if (size_text.toLocaleLowerCase() == sizeObj["text"].toLocaleLowerCase()) {
                            attSizeImgBlock.classList.add('inc_active')
                            attSizeImgBlockclone.classList.add('inc_active')
                        }
                    }
                });
            }
        } else {
            var sizelowertext = size_text.toLocaleLowerCase()
            if (productblockmod.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockmod.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            if (productblockshow.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockshow.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            productblockmod.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block[datacolor="' + sizelowertext + '"]').classList.add('inc_active')
            productblockshow.querySelector('.inc_product_desc_att_size_list_block .inc_product_desc_att_size_list_item_img_block[datacolor="' + sizelowertext + '"]').classList.add('inc_active')
        }
        //color block
        if (type_of_variant == "zero" || type_of_variant == "size" || type_of_variant == "third") {
            elAttColorListBlock.innerHTML = "";
            elAttColorListBlockshow.innerHTML = "";
            var productColorText = "";
            if (productModuleBlck.querySelector('.inc_product_modal_block .inc_product_desc_att_color_title_text_selected').innerText == "" && productModuleBlck.querySelector('.inc_product_desc_att_color_title_text_selected').innerText == "") {
                productModuleBlck.querySelector('.inc_product_modal_block .inc_product_desc_att_color_title_text_selected').innerText = ""
                productModuleBlck.querySelector('.inc_product_desc_att_color_title_text_selected').innerText = ""
            }
            var selcol = findobj.colorText
            if (productColorsObj["colorArray"].length > 0) {
                elAttColorBlock.classList.add("inc_active");
                var clrselflag = false;
                productColorsObj["colorArray"].forEach(function(colorObj) {
                    if (selcol == colorObj["text"]) {
                        findobj.colorText = colorObj["text"]
                        findobj.color_text = colorObj["text"]
                    } else {
                        findobj.colorText = ""
                        findobj.color_text = ""
                    }
                    var attColorBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_block')
                    var attColorImgBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img_block');
                    var attColorImg = generate_html_tag('div', 'inc_product_desc_att_color_list_item_img');
                    var attColorTextBlock = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text_block');
                    var attColorText = generate_html_tag('div', 'inc_product_desc_att_color_list_item_text');

                    attColorImgBlock.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blocktype + '\',"color")')
                    if (colorObj["colorCode"] != "" && colorObj["colorCode"] != undefined) {
                        var spancolorcode = generate_html_tag('span');
                        spancolorcode.setAttribute('alt', colorObj["text"])
                        spancolorcode.style.backgroundColor = colorObj["colorCode"];
                        attColorImg.appendChild(spancolorcode);
                    } else if (colorObj["imgSrc"].length > 0) {
                        if (colorObj["colorCode"] == "") {
                            var colorImg = generate_html_tag('img');
                            colorImg.setAttribute('alt', colorObj["text"])
                            colorImg.src = colorObj["imgSrc"]
                            // if (productObj.categoryName != "") {
                            //     colorImg.classList.add(productObj.categoryName.replace(/\s/g, ''))
                            // }
                            attColorImg.appendChild(colorImg);
                        }
                    }

                    var colorTitle = generate_html_tag('a');
                    colorTitle.innerText = colorObj["text"]
                    colorTitle.title = colorObj["text"];
                    colorTitle.addEventListener('click', function(e) {
                        e.preventDefault();
                    })
                    attColorImg.appendChild(colorTitle);

                    attColorImgBlock.setAttribute('data-color', colorObj["text"]);
                    attColorImgBlock.setAttribute("datacolor", colorObj["text"].toLocaleLowerCase());
                    attColorImgBlock.setAttribute('data-option', "0");
                    attColorImgBlock.setAttribute('data-cpid', colorObj["cpid"])
                    attColorImgBlock.setAttribute('data-colorcode', colorObj["colorCode"])
                    attColorImgBlock.setAttribute('data-optionimge', colorObj["imgSrc"])
                    attColorImgBlock.appendChild(attColorImg);
                    attColorBlock.appendChild(attColorImgBlock);
                    var attColorBlockclone = attColorBlock.cloneNode(attColorBlock);
                    elAttColorListBlock.appendChild(attColorBlock);
                    elAttColorListBlockshow.appendChild(attColorBlockclone);

                    if (color_text != null) {
                        if (color_text.toLocaleLowerCase() == colorObj.text.toLocaleLowerCase()) {
                            clrselflag = true
                            attColorBlock.classList.add('inc_active');
                            attColorBlockclone.classList.add('inc_active');
                            color_text_edt = colorObj.text
                            elselcolortextshow.innerText = colorObj.text
                            elselcolortextmodal.innerText = colorObj.text
                            elcolortextmodal.style.backgroundColor = colorObj["colorCode"];
                            elcolortextshow.style.backgroundColor = colorObj["colorCode"];
                        } else if (productColorsObj["colorArray"].length == 1) {
                            clrselflag = true
                            attColorBlock.classList.add('inc_active');
                            attColorBlockclone.classList.add('inc_active');
                            color_text_edt = colorObj.text
                            productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-color', colorObj.text)
                            productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-color', colorObj.text)
                            elselcolortextshow.innerText = colorObj.text
                            elselcolortextmodal.innerText = colorObj.text
                            elcolortextmodal.style.backgroundColor = colorObj["colorCode"];
                            elcolortextshow.style.backgroundColor = colorObj["colorCode"];
                        }
                    }
                });
                if (clrselflag == false) {
                    var ctext = productblockmod.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block').getAttribute('data-color')
                    var color_colorcodesel = productblockmod.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block').getAttribute('data-colorcode');
                    productblockmod.querySelector('.inc_product_desc_att_block').setAttribute('data-color', ctext)
                    productblockshow.querySelector('.inc_product_desc_att_block').setAttribute('data-color', ctext)
                    elAttColorListBlock.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block').parentNode.classList.add('inc_active')
                    elAttColorListBlockshow.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block').parentNode.classList.add('inc_active')
                    elselcolortextshow.innerText = ctext
                    elselcolortextmodal.innerText = ctext
                    elcolortextmodal.style.backgroundColor = color_colorcodesel;
                    elcolortextshow.style.backgroundColor = color_colorcodesel;
                }
            }
        } else {
            var colorlowertext = color_text.toLocaleLowerCase()
            if (productblockmod.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null) {
                productblockmod.querySelector('.inc_product_desc_att_color_list_item_block.inc_active').classList.remove('inc_active')
            }
            if (productblockshow.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null) {
                productblockshow.querySelector('.inc_product_desc_att_color_list_item_block.inc_active').classList.remove('inc_active')
            }
            productblockmod.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block[datacolor="' + colorlowertext + '"]').parentNode.classList.add('inc_active')
            productblockshow.querySelector('.inc_product_desc_att_color_list_item_block .inc_product_desc_att_color_list_item_img_block[datacolor="' + colorlowertext + '"]').parentNode.classList.add('inc_active')
            elselcolortextshow.innerText = colorlowertext
            elselcolortextmodal.innerText = colorlowertext
            if (productblockmod.querySelector('.inc_product_desc_att_color_list_item_block.inc_active div') != null) {
                var color_optimg = productblockmod.querySelector('.inc_product_desc_att_color_list_item_block.inc_active div').getAttribute('data-optionimge');
                var color_colorcode = productblockmod.querySelector('.inc_product_desc_att_color_list_item_block.inc_active div').getAttribute('data-colorcode');
                elcolortextmodal.style.backgroundColor = color_colorcode;
                elcolortextshow.style.backgroundColor = color_colorcode;
            }
        }
        if (type_of_variant == "zero" || type_of_variant == "size" || type_of_variant == "color") {
            elAtt3ListBlock.innerHTML = "";
            elAtt3ListBlockshow.innerHTML = "";
            if (product3rdObj["att3Array"].length > 0) {
                elAtt3rdBlock.classList.add("inc_active");

                product3rdObj["att3Array"].forEach(function(sizeObj) {
                    var attSizeBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_block');
                    var attSizeImgBlock3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img_block');
                    var attSizeImg3 = generate_html_tag('div', 'inc_product_desc_att_third_list_item_img');
                    attSizeImgBlock3.setAttribute('onClick', 'INC.methods.mappvariants(this,\'' + blocktype + '\',"third")')
                    attSizeImg3.innerText = sizeObj["text"];
                    attSizeImgBlock3.setAttribute('data-size', sizeObj["text"]);
                    attSizeImgBlock3.setAttribute("datasize", sizeObj["text"].toLocaleLowerCase());
                    attSizeImgBlock3.setAttribute('data-option', "3");
                    attSizeImgBlock3.appendChild(attSizeImg3);
                    var attSizeImgBlock3clone = attSizeImgBlock3.cloneNode(attSizeImgBlock3);
                    elAtt3ListBlock.appendChild(attSizeImgBlock3);
                    elAtt3ListBlockshow.appendChild(attSizeImgBlock3clone);
                    if (third_text != undefined) {
                        if (third_text.toLocaleLowerCase() == sizeObj["text"].toLocaleLowerCase()) {
                            attSizeImgBlock3.classList.add('inc_active')
                            attSizeImgBlock3clone.classList.add('inc_active')
                        }
                    }
                });
            }
        } else {
            var thirdlowertext = third_text.toLocaleLowerCase()
            if (productblockmod.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockmod.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            if (productblockshow.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockshow.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            productblockmod.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block[datacolor="' + thirdlowertext + '"]').classList.add('inc_active')
            productblockshow.querySelector('.inc_product_desc_att_third_list_block .inc_product_desc_att_size_list_item_img_block[datacolor="' + thirdlowertext + '"]').classList.add('inc_active')
        }
        var checkzeroselflag = false
        if (productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') == null) {
            checkzeroselflag = true
        }
        if (type_of_variant == "zero" || checkzeroselflag == true && type_of_variant != "color") {
            if (checkzeroselflag == true) {
                if (obj != null) {
                    var zero_text = obj.getAttribute('data-size')
                    var zerolowertext = zero_text.toLocaleLowerCase()
                } else {
                    if (productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block') != null) {
                        var zero_text = productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block').getAttribute('data-size')
                        var zerolowertext = zero_text.toLocaleLowerCase()
                    }
                }
            } else {
                var zerolowertext = zero_text.toLocaleLowerCase()
            }
            if (productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            if (productblockshow.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                productblockshow.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block.inc_active').classList.remove('inc_active')
            }
            productblockmod.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block[datasize="' + zerolowertext + '"]').classList.add('inc_active')
            productblockshow.querySelector('.inc_product_desc_att_zero_list_block .inc_product_desc_att_size_list_item_img_block[datasize="' + zerolowertext + '"]').classList.add('inc_active')
            if (productblockmod.querySelector('.inc_product_desc_att_zero_title_text_selected') != null) {
                productblockmod.querySelector('.inc_product_desc_att_zero_title_text_selected').innerText = zero_text
            }
            if (productblockshow.querySelector('.inc_product_desc_att_zero_title_text_selected') != null) {
                productblockshow.querySelector('.inc_product_desc_att_zero_title_text_selected').innerText = zero_text
            }
        }

        INC.methods.updateProductBlock(productblockshow, findobj, blocktype);
        INC.methods.updateProductBlock(productblockmod, findobj, blocktype);
    }
}
INC.methods.checkVariantSelection = function(prod_module_block) {
    var attr_flag_color = false;
    var attr_flag_size = false;
    var attr__flag_zero = false;
    var attr__flag_third = false;

    var elSize = prod_module_block.querySelector('.inc_product_desc_att_size_block.inc_active')
    var elColor = prod_module_block.querySelector('.inc_product_desc_att_color_block.inc_active')
    var elattr0 = prod_module_block.querySelector('.inc_product_desc_att_zero_block.inc_active')
    var elthird3 = prod_module_block.querySelector('.inc_product_desc_att_third_block.inc_active')

    if (elColor != null && elattr0 != null && elthird3 != null && elSize != null) {
        if (elColor.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null && elattr0.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null && elthird3.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null && elSize.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
            attr_flag_color = true
            attr__flag_zero = true
            attr__flag_third = true;
            attr_flag_size = true
        } else {
            attr_flag_color = false
            attr__flag_zero = false
            attr__flag_third = false;
            attr_flag_size = false
        }
    } else if (elColor != null && elattr0 != null && elSize != null) {
        if (elColor.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null && elattr0.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null && elSize.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
            attr_flag_color = true
            attr__flag_zero = true
            attr__flag_third = true;
            attr_flag_size = true
        } else {
            attr_flag_color = false
            attr__flag_zero = false
            attr__flag_third = false;
            attr_flag_size = false
        }
    } else if (elColor != null && elattr0 != null) {
        if (elColor.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null && elattr0.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
            attr_flag_color = true
            attr__flag_zero = true
            attr_flag_size = true;
            attr__flag_third = true;
        } else {
            attr_flag_color = false
            attr__flag_zero = false
            attr__flag_third = false;
            attr_flag_size = false;
        }
    } else {
        if (elColor != null) {
            if (elColor.querySelector('.inc_product_desc_att_color_list_item_block.inc_active') != null) {
                attr_flag_color = true
            }
        } else {
            attr_flag_color = true
        }
        if (elattr0 != null) {
            if (elattr0.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                attr__flag_zero = true
            }
        } else {
            attr__flag_zero = true
        }
        if (elSize != null) {
            if (elSize.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                attr_flag_size = true
            }
        } else {
            attr_flag_size = true
        }
        if (elthird3 != null) {
            if (elthird3.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active') != null) {
                attr__flag_third = true
            }
        } else {
            attr__flag_third = true
        }
    }

    // if(attr_flag_color == true && attr__flag_zero == true){
    //     return 1
    // }else{
    //     return 0
    // }
    if (attr_flag_color == true && attr__flag_zero == true && attr__flag_third == true) {
        return 1
    } else {
        if (attr_flag_size == false) {
            return 2
        } else if (attr__flag_third == false) {
            return 3
        } else if (attr_flag_color == false) {
            return 0
        } else {
            return 0
        }
    }
}
INC.methods.updateProductBlock = function(productBlock, findObj, blockType, bundleProductListCheck) {
    var dataStore = INC.dataStore;
    var productBlock = productBlock;
    var productModuleBlock = productBlock.parentNode.parentNode;
    var modal_attr_block = productModuleBlock.querySelector('.inc_product_modal_block')
    var zero_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-zero');
    var size_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-size');
    var color_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-color');
    var third_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-third');

    var sel_attr_text = ""
    if (zero_text != undefined) {
        findObj.zero_text = zero_text
        sel_attr_text = zero_text
    } else {
        findObj.zeroText = ""
        findObj.zero_text = ""
    }
    if (color_text != undefined) {
        findObj.color_text = color_text
        if (sel_attr_text == "") {
            sel_attr_text = color_text
        } else {
            sel_attr_text = sel_attr_text + " / " + color_text
        }
    } else {
        findObj.color_text = ""
    }
    if (size_text != undefined) {
        findObj.sizeText = size_text
        sel_attr_text = sel_attr_text + " / " + size_text
    } else {
        findObj.sizeText = ""
    }

    if (third_text != undefined) {
        findObj.thirdText = third_text
        sel_attr_text = sel_attr_text + " / " + third_text
    } else {
        findObj.thirdText = ""
    }
    if (productBlock.querySelector('.inc_product_variant_simple_text') != null) {
        if (blockType == "sidebar" || blockType == "am") {
            productBlock.querySelector('.inc_product_variant_simple_text').innerText = "Selectati optiunile"
        } else {
            productBlock.querySelector('.inc_product_variant_simple_text').setAttribute('title', sel_attr_text)
            if (productModuleBlock.querySelector('.inc_product_block .inc_product_add_block.added_inc') != null) {
                productBlock.querySelector('.inc_product_variant_simple_text').innerText = sel_attr_text
            }
        }
        if (color_text != null) {
            var PrdVarSimTxt = productBlock.querySelector('.inc_product_variant_simple_text')
            var colorTitle = generate_html_tag('div');

            colorTitle.addEventListener('click', function(e) {
                e.preventDefault();
            })
            PrdVarSimTxt.appendChild(colorTitle);
            colorTitle.classList.add("colorCircle")
            if (blockType == "pdp") {// PrdVarSimTxt.parentNode.classList.add('added_inc');
            }
        }
    }
    var productObj = INC.dataStore.methods().getProductByAtt(findObj);
    if (Object.keys(productObj).length != 0) {
        var previousSKU = "";
        previousSKU = productBlock.getAttribute('data-sku');
        productBlock.setAttribute('data-id', productObj.id);
        productBlock.setAttribute('data-sku', productObj.sku);
        productBlock.setAttribute('data-main_id', productObj.mainId);
        productBlock.setAttribute('data-bundle_id', productObj.bundleId);
        productModuleBlock.setAttribute('data-id', productObj.id);
        productModuleBlock.setAttribute('data-sku', productObj.sku);
        productModuleBlock.setAttribute('data-main_id', productObj.mainId);
        productModuleBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
        productModuleBlock.setAttribute('data-bundle_id', productObj.bundleId);

        if (document.querySelector('.inc_pdp_bundle_cart_added_product_block[data-main_id="' + productObj.mainId + '"]') != null && sel_attr_text != "") {
            var added_sum_prod = document.querySelector('.inc_pdp_bundle_cart_added_product_block[data-main_id="' + productObj.mainId + '"]')
            added_sum_prod.querySelector('.inc_pdp_bundle_cart_added_product_att_color_text_block').textContent = sel_attr_text
            added_sum_prod.querySelector('.inc_pdp_bundle_cart_added_product_att_color_text_block').setAttribute('style', '')
            added_sum_prod.querySelector('.inc_pdp_bundle_cart_added_product_att_block').setAttribute('title', sel_attr_text)
        }
        if (productModuleBlock.querySelector('.inc_product_desc_att_size_title_text') != null && sel_attr_text != "") {
            productModuleBlock.querySelector('.inc_product_desc_att_size_title_text').textContent = sel_attr_text
            productModuleBlock.querySelector('.inc_product_desc_att_size_title_text').setAttribute('title', sel_attr_text)
            var optionimage = modal_attr_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active').getAttribute('data-optionimge');
            if (optionimage != undefined && optionimage != "") {
                // productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_desc_att_zero_title_text').innerHTML = ""
                // productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_att_zero_title_text').innerHTML = ""
                // var optimg = generate_html_tag('img')
                // optimg.src = optionimage
                // productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_desc_att_zero_title_text').appendChild(optimg)
                // productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_att_zero_title_text').appendChild(optimg)
            }
        }
        if (color_text != undefined) {
            var ccode = modal_attr_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active div').getAttribute('data-colorcode');
            productModuleBlock.querySelector('.inc_product_showcase_block .inc_product_desc_att_color_title_text').style.backgroundColor = ccode
            productModuleBlock.querySelector('.inc_product_modal_block .inc_product_desc_att_color_title_text').style.backgroundColor = ccode
        }

        var elImgBlock = productBlock.querySelector('.inc_product_img_block');
        var elImgGalleryListBlock = productBlock.querySelector('.inc_product_img_gallery_list_block');
        var elTitleBlock = productBlock.querySelector('.inc_product_desc_title_block');
        var elTitleText = productBlock.querySelector('.inc_product_desc_title_text');
        var elPriceActiveText = productBlock.querySelector('.inc_product_desc_ecirp_active_text');
        var elPriceActiveMsg = productBlock.querySelector('.inc_product_desc_ecirp_active_text_msg');
        var elPriceRegularText = productBlock.querySelector('.inc_product_desc_ecirp_regular_text');
        var elAttBlock = productBlock.querySelector('.inc_product_desc_att_block');
        var elAttColorTitleText = productBlock.querySelector('.inc_product_desc_att_color_title_text');
        var elAttColorTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_color_title_text_selected');
        var elAttColorListBlock = productBlock.querySelector('.inc_product_desc_att_color_list_block');
        var elAttSizeTitleText = productBlock.querySelector('.inc_product_desc_att_size_title_text');
        var elAttSizeTitleTextSelected = productBlock.querySelector('.inc_product_desc_att_size_title_text_selected');
        var elQtyInputText = productBlock.querySelector('.inc_product_desc_qty_input_text');
        var elQtyDownBlock = productBlock.querySelector('.inc_product_qty_down_block');
        var elQtyUpBlock = productBlock.querySelector('.inc_product_qty_up_block');
        var elAddBlock = productBlock.querySelector('.inc_product_desc_add_block');
        var elAddText = productBlock.querySelector('.inc_product_desc_add_text');
        var elAddImg = productBlock.querySelector('.inc_product_desc_add_img');
        var elworthPrice = productBlock.querySelector('.inc_product_desc_ecirp_worth_text');
        var elGalleryRightArrow = productBlock.querySelector('.inc_product_img_gallery_right_block');
        var elGallerylefttArrow = productBlock.querySelector('.inc_product_img_gallery_left_block');
        var eladdbtnqtyblock = productBlock.querySelector('.inc_product_desc_qty_add_btn_block');
        if (productBlock.parentNode.className.indexOf('inc_product_showcase_block') >= 0) {
            if (blockType != "pdp") {
                eladdbtnqtyblock.classList.add('inc_active')
            }
        }

        productModuleBlock.querySelector('.inc_product_showcase_block .cosproductsku span').innerHTML = productObj.id
        productModuleBlock.querySelector('.inc_product_modal_block .cosproductsku span').innerHTML = productObj.id

        var prod_modal = productModuleBlock.querySelector('.inc_product_modal_block')
        var elImgMainImg = elImgBlock.querySelector('.inc_product_img_main_img');

        elImgMainImg.querySelectorAll('img')[0].setAttribute('src', productObj["imageURL"]);
        if (productBlock.parentNode.className.indexOf('inc_product_showcase_block') == -1) {
            elImgMainImg.querySelector('a').setAttribute('href', productObj["url"]);
        }
        elImgMainImg.querySelector('a').setAttribute('otherImageList', productObj["otherImageList"])
        elImgMainImg.querySelector('a').setAttribute('imageURL', productObj["imageURL"])
        elImgMainImg.querySelectorAll('img')[0].setAttribute('data-mouseover', productObj["otherImageList"])
        elImgMainImg.querySelectorAll('img')[0].setAttribute('data-imageURL', productObj["imageURL"])

        elImgMainImg.querySelector('a').setAttribute('otherImageList', productObj["otherImageList"])
        elImgMainImg.querySelector('a').setAttribute('imageURL', productObj["imageURL"])

        elImgMainImg.querySelectorAll('img')[0].setAttribute('data-mouseover', productObj["otherImageList"])
        elImgMainImg.querySelectorAll('img')[0].setAttribute('data-imageURL', productObj["imageURL"])

        var prod_ids = productModuleBlock.getAttribute('data-main_id')
        if (document.querySelector('.inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block[data-main_id="' + prod_ids + '"]') != null) {
            var tab_img = document.querySelector('.inc_pdp_bundle_product_list_items_block .inc_pdp_bundle_product_list_item_block[data-main_id="' + prod_ids + '"]');
            if (tab_img.querySelector('img') != null) {
                tab_img.querySelector('img').src = productObj["imageURL"]
            }
        }
        elImgGalleryListBlock.innerHTML = "";
        if ((productObj.otherImageList != null) && productObj.otherImageList.length > 1) {
            // productBlock.classList.add('inc_other_'+productObj.otherImageList.length)
            var otimg = 0
            productObj.otherImageList.forEach(function(otherImgURL) {
                otherImgURL = otherImgURL;
                var elImgGalleryListItemBlock = generate_html_tag('div', 'inc_product_img_gallery_list_item_block')
                var imglist = '<div class="inc_product_img_gallery_list_item_img_block"><div class="inc_product_img_gallery_list_item_img"><img class="inc_lazy" data-src="' + otherImgURL + '" src="' + otherImgURL + '" role="img" aria-label="Image" alt="' + productObj.name + '"></div></div><div class="inc_product_img_gallery_list_item_text_block"><div class="inc_product_img_gallery_list_item_text"></div></div>'
                elImgGalleryListItemBlock.innerHTML = imglist

                var elImgGalleryListItemImg = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img');

                var elOtherImgTag = elImgGalleryListItemBlock.querySelector('.inc_product_img_gallery_list_item_img img')
                elOtherImgTag.src = otherImgURL
                elOtherImgTag.setAttribute('alt', productObj.name)
                elOtherImgTag.setAttribute('role', 'img')
                elOtherImgTag.setAttribute('aria-label', 'Image')
                elOtherImgTag.setAttribute('onerror', "this.src='" + INC.config.noimage + "'");

                if (productObj.otherImageList.length > 4) {
                    elImgGalleryListItemImg.classList.add('OthImg4');
                }

                elImgGalleryListItemBlock.setAttribute('index', otimg)
                elImgGalleryListItemBlock.addEventListener("click", function() {
                    Array.prototype.forEach.call(productBlock.querySelectorAll('.inc_product_img_gallery_list_item_block'), function(galleryListItemBlock) {
                        galleryListItemBlock.classList.remove("inc_active");
                    });

                    elImgGalleryListItemBlock.classList.add("inc_active");

                    elImgMainImg.querySelector('img').src = otherImgURL;
                    elImgMainImg.querySelector('img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
                })

                elImgGalleryListBlock.appendChild(elImgGalleryListItemBlock);
                if (otimg == 0) {
                    elImgGalleryListItemBlock.classList.add('inc_active')
                }
                otimg++;
                if (productObj.otherImageList.length > 5) {
                    elImgGalleryListItemBlock.parentNode.classList.add("flex-start")
                }
            });
        } else {
            productBlock.classList.add('inc_other_noimage')
        }
        if (window.innerWidth > 820) {
            if ((productObj.otherImageList == null) || productObj.otherImageList.length < 2 || productObj.otherImageList.length == 1 || productObj.otherImageList == "") {
                elGalleryRightArrow.style.display = "none"
                elGallerylefttArrow.style.display = "none"
            }
        } else {
            if (productObj.otherImageList == null || productObj.otherImageList.length < 1 || productObj.otherImageList.length == 1 || productObj.otherImageList == "") {
                elGalleryRightArrow.style.display = "none"
                elGallerylefttArrow.style.display = "none"
            }
        }
        if (elTitleText.querySelector('strong') != null && window.innerWidth < 821 && INC.config.pageType == "pdp") {
            elTitleText.querySelector('div').innerHTML = "<strong>This item </strong>" + productObj.name
        } else {
            elTitleText.querySelector('div').textContent = productObj.name
        }
        elTitleText.querySelector('a').setAttribute('title', productObj.name)

        var activePrice = parseFloat(productObj.activePrice).toFixed(2).toString();
        var regularPrice = parseFloat(productObj.regularPrice).toFixed(2).toString();
        // var worthPrice = parseFloat(productObj.worthPrice).toFixed(2).toString();

        var totalsaveprc = get_discount_price(productObj.regularPrice, productObj.activePrice)
        var totalsaveper = get_discount_price_percentage(productObj.regularPrice, productObj.activePrice)

        elPriceActiveText.parentNode.parentNode.parentNode.classList.remove('is_special_ecirp')
        // elPriceActiveMsg.textContent = " + VAT"
        elPriceRegularText.textContent = "";
        if (activePrice != regularPrice && regularPrice != "" && regularPrice != null && regularPrice != 0) {
            elPriceActiveText.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
            if (productObj.pricingCount != "") {
                elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
                elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            } else {
                elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
                elPriceRegularText.innerHTML =  formatter.format(regularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            }
            elworthPrice.innerHTML = INC.config.you_saveText + totalsaveper + "%";
        } else {
            elworthPrice.innerHTML = "";
            if (productObj.pricingCount != "") {
                elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            } else {
                elPriceActiveText.innerHTML = formatter.format(activePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            }
        }
        if (productBlock.querySelector('.inc_product_desc_add_text').textContent == "Added" || productBlock.querySelector('.inc_product_desc_add_text').textContent == INC.config.AddedText || productBlock.parentNode.parentNode.querySelector('.inc_product_desc_add_text').textContent == INC.config.AddedText) {
            if (!dataStore.hasOwnProperty('bundleCartProducts')) {
                dataStore['bundleCartProducts'] = {};
                INC.config.pdpaddedProductList = []
                INC.config.bundle_tracking = []
                INC.config.bundle_skuPushed = []
                INC.config.dupBasket = []
            }
            dataStore["bundleCartProducts"][productObj["sku"]] = dataStore["bundleCartProducts"][previousSKU];
            if (productObj["sku"] != previousSKU) {
                delete dataStore["bundleCartProducts"][previousSKU];
            }
        }
        var elQtyInput = productBlock.parentNode.parentNode.querySelector('.inc_product_modal_block .inc_product_desc_qty_add_btn_block .inc_product_qty_block input');
        var sku = productBlock.getAttribute('data-sku');
        var bundle_id = productBlock.getAttribute('data-bundle_id');
        var main_id = productBlock.getAttribute('data-main_id');
        var qty = parseInt(elQtyInput.value);
        var pname = productBlock.querySelector('.inc_product_desc_title_text').textContent;
        var pprice = productBlock.querySelector('.inc_product_desc_ecirp_active_text').textContent.replace('$', '');

        if (elAddText.parentNode.parentNode.querySelector('.inc_product_desc_add_img.checked') != null) {
            INC.methods.updateBundleCart({
                sku: sku,
                qty: qty
            }, "add", main_id, bundle_id, pname, pprice);
        }
        if (window.innerWidth < 821) {
            if (productModuleBlock.parentNode != null) {
                if (productModuleBlock.parentNode.parentNode.parentNode.classList.contains('inc_pdp_bundle_block') == true) {
                    var pdpbundleblock = productModuleBlock.parentNode.parentNode.parentNode
                } else {
                    var pdpbundleblock = productModuleBlock.parentNode.parentNode.parentNode.parentNode.parentNode
                }
                INC.methods.updateallbasketprice(pdpbundleblock)
            }
        }
        setTimeout(function() {
            if (elImgMainImg.querySelectorAll('img')[0].naturalWidth == 360) {
                elImgMainImg.querySelectorAll('img')[0].setAttribute('src', productObj["imageURLMain"]);
            }
        }, 200);
    }
    if (blockType == "pdp" && productModuleBlock.querySelector('.inc_product_add_block.added_inc') != null) {
        productModuleBlock.querySelector('.inc_product_variant_simple_block').classList.add('added_inc')
    }
}

INC.methods.createProductListItemBlock = function(productObj, blockType) {
    //debugger
    var productListItemBlock = generate_html_tag('div', 'inc_pdp_bundle_product_list_item_block');
    var findObj = new INC.classes.FindObj({
        id: productObj.id,
        mainId: productObj.mainId
    });
    var productObj = INC.dataStore.methods().getProductById(findObj);
    productListItemBlock.style.userSelect = "none";
    productListItemBlock.setAttribute('data-id', productObj.id);
    productListItemBlock.setAttribute('data-sku', productObj.sku);
    productListItemBlock.setAttribute('data-main_id', productObj.mainId);
    productListItemBlock.setAttribute('bundledprod_id', productObj.bundledProductId);
    productListItemBlock.setAttribute('data-bundle_id', productObj.bundleId);

    var seemoreprodhtml = '<div class="inc_pdp_bundle_product_list_item_added_block"><div class="inc_pdp_bundle_product_list_item_added_btn_block"><div class="inc_pdp_bundle_product_list_item_added_btn_img_block"><div class="inc_pdp_bundle_product_list_item_added_btn_img"></div></div><div class="inc_pdp_bundle_product_list_item_added_btn_text_block"><div class="inc_pdp_bundle_product_list_item_added_btn_text"></div></div></div></div><div class="inc_pdp_bundle_product_list_item_img_block"><div class="inc_pdp_bundle_product_list_item_img"><img class="inc_lazy" data-src="' + productObj.imageURL + '" src="' + productObj.imageURL + '"></div></div><div class="inc_pdp_bundle_product_list_item_title_block"><div class="inc_pdp_bundle_product_list_item_title_text_block"><div class="inc_pdp_bundle_product_list_item_title_text"></div></div></div><div class="inc_pdp_bundle_product_list_item_ecirp_block"><div class="inc_pdp_bundle_product_list_item_ecirp_active_block"><div class="inc_pdp_bundle_product_list_item_ecirp_active_text_block"><div class="inc_pdp_bundle_product_list_item_ecirp_active_text"></div></div></div></div>'

    productListItemBlock.innerHTML = seemoreprodhtml
    productListItemBlock.querySelector('.inc_pdp_bundle_product_list_item_img img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'");
    productListItemBlock.addEventListener("click", function() {
        //debugger
        Array.prototype.forEach.call(document.querySelectorAll('.inc_product_desc_att_size_list_block'), function(attSizeListBlock) {
            attSizeListBlock.classList.remove("inc_active");
        });

        var elListMainBlock = document.querySelector('.inc_pdp_bundle_product_list_main_block');
        Array.prototype.forEach.call(elListMainBlock.querySelectorAll('.inc_product_module_block'), function(productBlock) {
            productBlock.setAttribute('style', 'display: none!important');
        });
        elListMainBlock.querySelector('.inc_product_module_block' + "[data-main_id=\"" + productObj.mainId + "\"]").style.display = "block";

        Array.prototype.forEach.call(productListItemBlock.parentNode.querySelectorAll('.inc_pdp_bundle_product_list_item_block'), function(pListItemBlock) {
            pListItemBlock.classList.remove("inc_active");
        });

        productListItemBlock.classList.add("inc_active");
    });

    return productListItemBlock;
}


INC.methods.updateBundleCart = function(bundleCartObj, type, main_id, bundle_id, pname, pprice) {
    var dataStore = INC.dataStore;
    var listToDelete = []
    if (!dataStore.hasOwnProperty('bundleCartProducts')) {
        dataStore['bundleCartProducts'] = {};
        INC.config.pdpaddedProductList = []
        INC.config.bundle_tracking = []
        INC.config.bundle_skuPushed = []
        INC.config.dupBasket = []
    }

    switch (type) {
    case "add":
        dataStore["bundleCartProducts"][bundleCartObj["sku"]] = bundleCartObj["qty"];
        if (INC.config.bundle_skuPushed.indexOf(bundleCartObj["sku"]) == -1) {
            INC.config.bundle_skuPushed.push(bundleCartObj["sku"])
        }
        if (INC.config.pdpaddedProductList.indexOf(main_id) == -1) {
            INC.config.pdpaddedProductList.push(main_id)
            INC.config.bundle_tracking.push({
                id: main_id,
                bid: bundle_id,
                pname: pname,
                prc: pprice,
                qty: bundleCartObj["qty"]

            });
        }
        break;
    case "sub":
        delete dataStore["bundleCartProducts"][bundleCartObj["sku"]];
        INC.config.pdpaddedProductList.remove_prod_list = function() {
            var what, a = arguments, L = a.length, ax;
            while (L && this.length) {
                what = a[--L];
                while ((ax = this.indexOf(what)) !== -1) {
                    this.splice(ax, 1);
                }
            }
            return this;
        }
        ;
        listToDelete[0] = main_id
        for (var i = 0; i < INC.config.bundle_tracking.length; i++) {
            var obj = INC.config.bundle_tracking[i];
            if (obj != undefined) {
                if (listToDelete.indexOf(obj.id) !== -1) {
                    INC.config.bundle_tracking.splice(i, 1);
                }
            }
        }
        INC.config.bundle_skuPushed.remove_prod_list = function() {
            var what, a = arguments, L = a.length, ax;
            while (L && this.length) {
                what = a[--L];
                while ((ax = this.indexOf(what)) !== -1) {
                    this.splice(ax, 1);
                }
            }
            return this;
        }
        ;

        INC.config.bundle_tracking = INC.config.bundle_tracking
        INC.config.pdpaddedProductList.remove_prod_list(main_id);
        INC.config.bundle_skuPushed.remove_prod_list(bundleCartObj["sku"]);
        break;
    }

    if (INC.config.pageType == "pdp")
        this.calculateBundleTotal();
}

INC.methods.calculateBundleTotal = function() {
    var dataStore = INC.dataStore;
    var bundleCartProducts = dataStore["bundleCartProducts"];
    var productListObj = dataStore.dataStoreObj;
    var duplicate_check_produ = []
    var totalRegularPrice = 0;
    var totalActivePrice = 0;
    var totalMainProduct = 0;
    var totalAddonProducts = 0;
    var totalAddonProductsCount = 0;
    var totalProductCount = 0;
    var total_qty = 0
    var total_collect_point = 0
    var mainId = INC.methods.getProductIdFromWebPage();
    if (bundleCartProducts != null && bundleCartProducts != undefined) {
        Object.keys(bundleCartProducts).forEach(function(sku) {
            for (mainProductId in productListObj) {
                for (childProductId in productListObj[mainProductId]) {
                    if (sku == productListObj[mainProductId][childProductId]["sku"]) {
                        if (duplicate_check_produ.indexOf(productListObj[mainProductId][childProductId]["sku"]) == -1) {
                            duplicate_check_produ.push(productListObj[mainProductId][childProductId]["sku"])
                            var regularPrice = productListObj[mainProductId][childProductId]["regularPrice"];
                            var activePrice = productListObj[mainProductId][childProductId]["activePrice"];
                            totalRegularPrice = totalRegularPrice + (parseFloat(bundleCartProducts[sku]) * regularPrice);
                            totalActivePrice = totalActivePrice + (parseFloat(bundleCartProducts[sku])) * activePrice;

                            total_qty = total_qty + parseInt(bundleCartProducts[sku])

                            if (productListObj[mainProductId][childProductId]["worthPrice"] != "" && productListObj[mainProductId][childProductId]["worthPrice"] != null) {
                                total_collect_point = total_collect_point + +(productListObj[mainProductId][childProductId]["worthPrice"] * parseInt(bundleCartProducts[sku]))
                            }
                            if (productListObj[mainProductId][childProductId].mainId == mainId) {
                                totalProductCount++;
                                totalMainProduct = totalMainProduct + (parseInt(bundleCartProducts[sku]) * activePrice);
                            }

                            // if (getProductBySKU(findObj).mainId != mainId) {
                            if (productListObj[mainProductId][childProductId].mainId != mainId) {
                                totalProductCount++;
                                totalAddonProductsCount++;
                                totalAddonProducts = totalAddonProducts + (parseInt(bundleCartProducts[sku]) * activePrice);
                            }
                        }
                    }
                }
            }
        });
    }
    var priceObj = {
        totalActivePrice: parseFloat(totalActivePrice).toFixed(2),
        totalRegularPrice: parseFloat(totalRegularPrice).toFixed(2),
        totalMainProduct: totalMainProduct,
        totalAddonProducts: totalAddonProducts,
        totalAddonProductsCount: totalAddonProductsCount,
        totalProductCount: totalProductCount,
        total_qty: total_qty,
        total_collect_point: total_collect_point
    }
    //if (window.innerWidth > 820) {
        this.updateBundleCartBlock(priceObj);
    //}
}

INC.methods.updateBundleCartBlock = function(priceObj) {
    //debugger
    var dataStore = INC.dataStore;
    var bundleCartProducts = dataStore["bundleCartProducts"];
    var totalRegularPrice = priceObj.totalRegularPrice;
    var totalActivePrice = priceObj.totalActivePrice;
    var totalMainProduct = priceObj.totalMainProduct;
    var totalAddonProducts = priceObj.totalAddonProducts;
    var totalAddonProductsCount = priceObj.totalAddonProductsCount;
    var totalProductCount = priceObj.totalProductCount;
    var total_qty_item = priceObj.total_qty
    var total_col_point = priceObj.total_collect_point
    var elPdpBundleCartBlock = document.querySelector('.inc_pdp_bundle_cart_block');
    if (elPdpBundleCartBlock != null) {
        var elBundleCartAddedBlock = document.querySelector('.inc_pdp_bundle_cart_added_block')
        var elBundleCartSummaryViewBtnCount = document.querySelector('.inc_pdp_bundle_cart_summary_view_btn_count')
        var elBundleCartPriceRegularText = document.querySelector('.inc_pdp_bundle_cart_summary_ecirp_regular_text')
        var elBundleCartPriceActiveText = document.querySelector('.inc_pdp_bundle_cart_summary_ecirp_active_text')
        var elBundleCartTitleTextcount = document.querySelector('.inc_pdp_bundle_cart_title_text')
        var elBundleCartTitleTextblock = document.querySelector('.inc_pdp_bundle_cart_title_text_block')
        var elbundlesavetext = document.querySelector('.inc_pdp_bundle_cart_summary_ecirp_save_text')
        var elCartsummaryMainPrdtxtBlock = document.querySelector('.inc_pdp_bundle_cart_summary_main_prd_txt')
        var elCartsummaryMainPrdPrcBlock = document.querySelector('.inc_pdp_bundle_cart_summary_main_prd_prc')
        var elCartsummaryAddonPrdtxtBlock = document.querySelector('.inc_pdp_bundle_cart_summary_addon_prd_txt')
        var elCartsummaryAddonPrdPrcBlock = document.querySelector('.inc_pdp_bundle_cart_summary_addon_prd_prc')

        elBundleCartAddedBlock.innerHTML = "";
        var countcollect = 0;
        var totol_qty_item = 0;
        var bundleCartProductsArray = Object.keys(bundleCartProducts);
        elBundleCartSummaryViewBtnCount.textContent = bundleCartProductsArray.length;
        if (window.innerWidth < 821) {
            elBundleCartTitleTextcount.textContent = "Items you've added"
            //total_qty_item + 
        }
        var onloadprod = []
        if (document.querySelector('.inc_pdp_product-main_block .inc_product_module_block') != null) {
            var idmain = document.querySelector('.inc_pdp_product-main_block .inc_product_module_block').getAttribute('data-id')
            if (document.querySelector('.inc_pdp_bundle_product_list_main_block .inc_product_module_block') != null) {
                var bprod = document.querySelector('.inc_pdp_bundle_product_list_main_block .inc_product_module_block').getAttribute('data-id')
                onloadprod.push(idmain)
                onloadprod.push(bprod)
            }
        }
        for (var m = 0; m < INC.config.bundle_skuPushed.length; m++) {
            var elcont = INC.config.bundle_skuPushed[m]
            for (var i = 0; i < bundleCartProductsArray.length; i++) {
                var findObj = new INC.classes.FindObj({
                    sku: bundleCartProductsArray[i]
                });
                var productObj = INC.dataStore.methods().getProductBySKU(findObj);
                if (elcont == productObj.id) {
                    var productId = productObj.id;
                    var prepen_elm = this.createBundleCartAddedProductBlock(productId, bundleCartProducts[bundleCartProductsArray[i]], "pdp")
                    if (elBundleCartAddedBlock != null || elBundleCartAddedBlock != undefined) {
                        elBundleCartAddedBlock.insertBefore(prepen_elm, elBundleCartAddedBlock.childNodes[0]);
                    }
                }
                if (i == 0) {
                    var mainPrdPrc = productObj.regularPrice;
                }
            }
        }
        elBundleCartPriceRegularText.style.display = "none";
        if (totalActivePrice != totalRegularPrice) {
            elBundleCartPriceRegularText.style.display = "flex";
        }

        if (bundleCartProductsArray.length == 0) {
            setTimeout(function() {
                onloadpdp_delete = false;
                document.querySelectorAll('.inc_pdp_block .inc_product_desc_add_block')[1].click();
                onloadpdp_delete = true;
            }, 5);
        }
        //debugger
        elBundleCartPriceActiveText.innerHTML = formatter.format(totalActivePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.remove('simple_ecirp')
        elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.remove('is_special_ecirp')
        elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.remove('simple_ecirp')
        elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.remove('is_special_ecirp')
        var totalsaveprcs = get_discount_price(totalRegularPrice, totalActivePrice)
        var totalsavepers = get_discount_price_percentage(totalRegularPrice, totalActivePrice)
        if (totalRegularPrice != "0.00" && totalRegularPrice != totalActivePrice && totalRegularPrice != null && totalRegularPrice != "") {
            elBundleCartPriceRegularText.innerHTML = "<span>" + "Was" + "</span>" + formatter.format(totalRegularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
            elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
            elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
            elbundlesavetext.innerHTML = INC.config.you_saveText + totalsavepers + "%";
        } else {
            elbundlesavetext.innerHTML = ""
            elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.add('simple_ecirp')
        }
        // if (window.innerWidth < 821) {
        //     elCartsummaryMainPrdtxtBlock.innerHTML = "Main product ";
        //     elCartsummaryMainPrdPrcBlock.innerText = ""
        //     if (totalMainProduct != undefined) {
        //         elCartsummaryMainPrdPrcBlock.innerText = formatter.format(totalMainProduct)
        //     }
        //     if (bundleCartProductsArray.length == 1) {

        //         if (totalAddonProducts == 0 || totalAddonProducts == 0.00) {
        //             elCartsummaryAddonPrdtxtBlock.innerText = "No addon product selected ";
        //             elCartsummaryAddonPrdPrcBlock.innerHTML = ""
        //         } else {
        //             elCartsummaryAddonPrdtxtBlock.innerText = "1 addon product selected ";
        //             elCartsummaryAddonPrdPrcBlock.innerHTML = elCartsummaryAddonPrdPrcBlock.innerText = "+ " + formatter.format(totalAddonProducts)
        //         }
        //     } else if (bundleCartProductsArray.length > 1) {
        //         if (totalMainProduct == 0 || totalMainProduct == 0.00) {
        //             elCartsummaryAddonPrdtxtBlock.innerText = bundleCartProductsArray.length + " " + "addon products selected ";
        //         } else {
        //             if (bundleCartProductsArray.length == 2) {
        //                 elCartsummaryAddonPrdtxtBlock.innerText = bundleCartProductsArray.length - 1 + " " + "addon product selected ";
        //             } else {
        //                 elCartsummaryAddonPrdtxtBlock.innerText = bundleCartProductsArray.length - 1 + " " + "addon products selected ";
        //             }

        //         }

        //         elCartsummaryAddonPrdPrcBlock.innerText = "+ " + formatter.format(totalAddonProducts)
        //     } else {
        //         elCartsummaryAddonPrdtxtBlock.innerText = "No addon product selected ";
        //         elCartsummaryAddonPrdPrcBlock.innerHTML = "$0.00"
        //     }
        // }

        if (elPdpBundleCartBlock != null && elPdpBundleCartBlock != undefined) {
            var bundleCartProductsLength = Object.keys(bundleCartProducts).length;
            var elBundleCartTitleText = document.querySelector('.inc_pdp_bundle_cart_title_text')
            var elBundleCartAddBtnText = document.querySelector('.inc_pdp_bundle_cart_summary_add_btn_text')
            elBundleCartAddBtnText.style.textTransform = "none"
            elBundleCartTitleText.textContent = bundleCartProductsLength + " item in bundle";

            elBundleCartAddBtnText.textContent = "Add bundle to cart";

            if (!(totalProductCount > 1)) {
                elBundleCartAddBtnText.textContent = "Add bundle to cart";
            }
        }

        var elPriceMainTitleText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle-cart_ecirp_main_title_text');
        var elPriceMainFigureText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle-cart_ecirp_main_figure_text');
        var elPriceAddonTitleText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle-cart_ecirp_addon_title_text');
        var elPriceAddonFigureText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle-cart_ecirp_addon_figure_text');
        var elPriceRegularText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle_cart_summary_ecirp_regular_text');
        var elPriceActiveText = elPdpBundleCartBlock.querySelector('.inc_pdp_bundle_cart_summary_ecirp_active_text');

        elPriceMainTitleText.textContent = "Main Product Price ";
        elPriceAddonTitleText.textContent = "Add-on(s) Selected  " + ((totalAddonProductsCount > 0) ? totalAddonProductsCount : "");

        elPriceMainFigureText.innerHTML = formatter.format(totalMainProduct).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        elPriceAddonFigureText.innerHTML = formatter.format(totalAddonProducts).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
        elPriceActiveText.innerHTML = formatter.format(totalActivePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');

        setTimeout(function() {
            if (INC.dataStore.bundleCartProducts != null) {
                if (Object.keys(INC.dataStore.bundleCartProducts).length == 0) {
                    elBundleCartAddBtnText.textContent = "ADD BUNDLE TO BASKET";
                    elBundleCartAddBtnText.parentNode.parentNode.setAttribute('style', 'pointer-events: none;opacity: 0.5;')
                } else {
                    elBundleCartAddBtnText.parentNode.parentNode.setAttribute('style', 'pointer-events: auto;opacity: 1;')
                }
            }
        }, 100);
    }

}

INC.methods.createBundleCartAddedProductBlock = function(productId, qty, blockType) {
    var addedProductBlock = generate_html_tag('div', 'inc_pdp_bundle_cart_added_product_block')
    var findObj = new INC.classes.FindObj({
        id: productId
    });
    var productObj = INC.dataStore.methods().getProductById(findObj);
    addedProductBlock.setAttribute('data-id', productObj.id);
    addedProductBlock.setAttribute('data-sku', productObj.sku);
    addedProductBlock.setAttribute('data-main_id', productObj.mainId);
    addedProductBlock.setAttribute('data-bundle_id', productObj.bundleId);
    addedProductBlock.setAttribute('bundledprod_id', productObj.bundledProductId);

    var color = "";
    var size = "";
    var just_check_prod_block = document.querySelector('.inc_product_module_block[data-main_id="' + productObj.mainId + '"]')
    if (just_check_prod_block != null) {
        if (just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div') != null) {
            size = just_check_prod_block.querySelector('.inc_product_desc_att_size_list_item_img_block.inc_active div').innerText
        }
        if (just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block') != null) {
            color = just_check_prod_block.querySelector('.inc_product_desc_att_color_list_item_block.inc_active .inc_product_desc_att_color_list_item_img_block').getAttribute('data-color')
        }
    }
    var prod_module_elm = document.querySelector('.inc_pdp_block .inc_product_module_block[data-main_id="' + productObj.mainId + '"]')
    var modal_attr_block = prod_module_elm.querySelector('.inc_product_modal_block')
    var zero_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-zero');
    var size_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-size');
    var color_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-color');
    var third_text = modal_attr_block.querySelector('.inc_product_desc_att_block').getAttribute('data-third');

    var sel_attr_text = ""
    if (color_text != undefined) {
        sel_attr_text = color_text
    }
    if (zero_text != undefined) {
        if (sel_attr_text == "") {
            sel_attr_text = zero_text
        } else {
            sel_attr_text = sel_attr_text + " / " + zero_text
        }
    }
    if (size_text != undefined) {
        sel_attr_text = sel_attr_text + " / " + size_text
    }
    if (third_text != undefined) {
        sel_attr_text = sel_attr_text + " / " + third_text
    }
    //var addedsumprodhtml = '<div class="inc_pdp_bundle_cart_added_product_img_block"><div class="inc_pdp_bundle_cart_added_product_img"><img src="' + productObj.imageURL + '" data-src="' + productObj.imageURL + '"></div></div><div class="inc_pdp_bundle_cart_added_product_title_block"><div class="inc_pdp_bundle_cart_added_product_title_text_block"><div class="inc_pdp_bundle_cart_added_product_title_text"><a title="' + productObj.name + '"><div style="text-transform: unset;"><span>' + qty + ' <small>x</small> </span>' + productObj.name + '</div></a></div></div></div><div class="inc_pdp_bundle_cart_added_product_qty_block"><div class="inc_pdp_bundle_cart_added_product_qty_text_block"><div class="inc_pdp_bundle_cart_addeed_product_qty_text">' + qty + '</div></div></div><div class="inc_pdp_bundle_cart_added_product_ecirp_block"><div class="inc_pdp_bundle_cart_added_product_ecirp_text_block"><div class="inc_pdp_bundle_cart_added_product_ecirp_text">' + formatter.format(productObj.activePrice * qty) + '</div></div></div><div class="inc_pdp_bundle_cart_added_product_att_block" title="' + sel_attr_text + '"><div class="inc_pdp_bundle_cart_added_product_att_color_block"><div class="inc_pdp_bundle_cart_added_product_att_color_text_block" style="text-transform: none;">' + sel_attr_text + '</div></div><div class="inc_pdp_bundle_cart_added_product_att_size_block"><div class="inc_pdp_bundle_cart_added_product_att_size_text_block"><div class="inc_pdp_bundle_cart_added_product_att_size_text"></div></div></div></div><div class="inc_pdp_bundle_cart_added_product_edit_block"><div class="inc_pdp_bundle_cart_added_product_edit_text_block"><div class="inc_pdp_bundle_cart_added_product_edit_text"></div></div><div class="inc_pdp_bundle_cart_added_product_edit_img_block"><div class="inc_pdp_bundle_cart_added_product_edit_img"></div></div></div>'
    var addedsumprodhtml = '<div class="inc_pdp_bundle_cart_added_product_img_block"><div class="inc_pdp_bundle_cart_added_product_img"><img src="' + productObj.imageURL + '" data-src="' + productObj.imageURL + '"></div></div><div class="inc_pdp_bundle_cart_added_product_title_block"><div class="inc_pdp_bundle_cart_added_product_title_text_block"><div class="inc_pdp_bundle_cart_added_product_title_text"><a title="' + productObj.name + '"><div style="text-transform: unset;">' + productObj.name + '</div></a></div></div></div><div class="inc_pdp_bundle_cart_added_product_qty_block"><div class="inc_pdp_bundle_cart_added_product_qty_text_block"><div class="inc_pdp_bundle_cart_addeed_product_qty_text">' + qty + '</div></div></div><div class="inc_pdp_bundle_cart_added_product_ecirp_block"><div class="inc_pdp_bundle_cart_added_product_ecirp_text_block"><div class="inc_pdp_bundle_cart_added_product_ecirp_text">' + formatter.format(productObj.activePrice * qty).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de',''); + '</div></div></div><div class="inc_pdp_bundle_cart_added_product_att_block" title="' + sel_attr_text + '"><div class="inc_pdp_bundle_cart_added_product_att_color_block"><div class="inc_pdp_bundle_cart_added_product_att_color_text_block" style="text-transform: none;">' + sel_attr_text + '</div></div><div class="inc_pdp_bundle_cart_added_product_att_size_block"><div class="inc_pdp_bundle_cart_added_product_att_size_text_block"><div class="inc_pdp_bundle_cart_added_product_att_size_text"></div></div></div></div><div class="inc_pdp_bundle_cart_added_product_edit_block"><div class="inc_pdp_bundle_cart_added_product_edit_text_block"><div class="inc_pdp_bundle_cart_added_product_edit_text"></div></div><div class="inc_pdp_bundle_cart_added_product_edit_img_block"><div class="inc_pdp_bundle_cart_added_product_edit_img"></div></div></div>'

    addedProductBlock.innerHTML = addedsumprodhtml

    addedProductBlock.querySelector('.inc_pdp_bundle_cart_added_product_img img').setAttribute('onerror', "this.src='" + INC.config.noimage + "'")

    var elEditTextBlock = addedProductBlock.querySelector(".inc_pdp_bundle_cart_added_product_edit_text_block")
    var elEditImgBlock = addedProductBlock.querySelector(".inc_pdp_bundle_cart_added_product_edit_img_block");

    elEditTextBlock.addEventListener("click", function() {
        if (INC.config.deviceType == "mobile") {
            if (document.querySelector('.inc_pdp_bundle_product_list_item_block' + '[data-main_id="' + productObj.mainId + '"]') != null)
                document.querySelector('.inc_pdp_bundle_product_list_item_block' + '[data-main_id="' + productObj.mainId + '"]').click();
        }
        setTimeout(function() {
            document.querySelector('.inc_product_block' + '[data-id="' + productObj.id + '"]').parentNode.parentNode.querySelector('.inc_product_modal_block').classList.add('inc_active');
            document.querySelector('html').classList.add('inc_overlay');
        }, 50);
    });
    elEditImgBlock.addEventListener("click", function() {
        document.querySelector('.inc_product_block' + '[data-id="' + productObj.id + '"]').querySelector('.inc_product_desc_add_block').click();
    });
    return addedProductBlock;
}

INC.methods.clear = function() {
    if (document.querySelector('.sidebar_outer') != null) {
        Array.prototype.forEach.call(document.querySelectorAll('.sidebar_outer'), function(el) {
            el.parentNode.removeChild(el);
        });

        Array.prototype.forEach.call(document.querySelectorAll(".sidebar_outer"), function(el) {
            el.parentNode.removeChild(el);
        });
    }
    if (document.querySelector('.inc_sidebar_modal_block') != null) {
        Array.prototype.forEach.call(document.querySelectorAll('.inc_sidebar_modal_block'), function(el) {
            el.parentNode.removeChild(el);
        });

        Array.prototype.forEach.call(document.querySelectorAll(".inc_sidebar_overlay_block"), function(el) {
            el.parentNode.removeChild(el);
        });
    }

    if (document.querySelector('.inc_af_block') != null) {
        Array.prototype.forEach.call(document.querySelectorAll('.inc_af_block'), function(el) {
            el.parentNode.removeChild(el);
        });
    }

    if (document.querySelector('.inc_pdp_block') != null) {
        Array.prototype.forEach.call(document.querySelectorAll('.inc_pdp_block'), function(el) {
            el.parentNode.removeChild(el);
        });
    }
}

INC.methods.addProductToCart = function(findObj, qty, pageType, productBlock, add_btn_click, add_prod_im, btn_addtocart, newbtntext) {
    var formData = [];
    var addProductURL = INC.config.addToBasketURL;
    var findObj = new INC.classes.FindObj(findObj);
    var productObj = INC.dataStore.methods().getProductById(findObj);

    var cust_data_online = JSON.parse(sessionStorage.getItem("custData"))
    var inc_cmpgnId = campNr
    var inc_acctNr = sessionStorage.getItem("acctNr")
    var inc_profile = JSON.parse(sessionStorage.getItem("profileRes"))
    var conf_pr_array = []
    var data_param = {}
    var inc_cust_name = ""
    var cust_id = ""
    var active_customer = ""
    var item_added_list = []
    item_added_list.push(productObj.id)
    item_added_list.push(productObj.sku)
    var current_act = ""
    if (document.querySelector('.yrOrders-C.active .name') != null) {
        var current_act = document.querySelector('.yrOrders-C.active .name').innerText.trim();
    }

    for (var ca = 0; ca < cust_data_online.dataList.length; ca++) {
        if (current_act != "") {
            if (cust_data_online.dataList[ca].custName == current_act) {
                active_customer = cust_data_online.dataList[ca];
                break;
            }
        } else {
            if (cust_data_online.dataList[ca].active == true) {
                active_customer = cust_data_online.dataList[ca];
                break;
            }
        }
    }
    if (active_customer != "") {
        cust_id = active_customer.custId
        inc_cust_name = active_customer.custName
    } else {
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            cust_id = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim();
        }
        if (document.querySelector('#co-mobMenu .name') != null) {
            var inc_cust_name = document.querySelector('#co-mobMenu .name').innerText
        }
    }
    var placeordrtype = "PROMOTION"
    if (INC.config.pageType == "cartPage") {
        placeordrtype = "REGULAR"
    }
    //REGULAR
    if (cust_data_online != undefined) {
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            var inc_param = {
                cmpgnId: campNr,
                lineNr: productObj.id.toString(),
                qty: qty,
                custId: cust_id,
                placOrdSctnCd: placeordrtype
            }
            formData.push(inc_param)
        } else {
            var inc_param = [{
                custId: cust_id,
                lineNr: productObj.id.toString(),
                placOrdSctnCd: placeordrtype,
                qty: qty,
                cmpgnId: campNr
            }]
            data_param["items"] = inc_param;
            data_param["cmpgnId"] = campNr;
            data_param["ordNm"] = inc_cust_name;
            data_param["ordType"] = "REG";
            data_param["items"] = inc_param;
            // formData.push(data_param)
        }
    }
    INC.config.cartAdeedprod.push(productObj.id.toString())
    if(INC.config.cartAdeedprod.indexOf(productObj.mainId.toString()) == -1){
    	INC.config.cartAdeedprod.push(productObj.mainId.toString())
    }
    if (document.querySelector('#co-mobMenu .ordr-date') != null) {
        var inc_login_user_id = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim()
    }
    if (document.querySelector('#co-mobMenu .ordr-date') != null) {
        var url1 = '//apim-eu.api-prod.aws.avon.com/v1/RO/RO/rep/' + inc_acctNr + '/order/' + inc_login_user_id + '/cust/' + cust_id + '?groups=custords'
    } else {
        var url1 = '//apim-eu.api-prod.aws.avon.com/v1/RO/RO/rep/' + inc_acctNr + '/order?groups=custords';
    }
    if(document.querySelector('#co-mobMenu .ordr-date') == null) {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url1, false);
        xhr.onload = function() {}
        xhr.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');
        xhr.setRequestHeader('x-sec-token', readCookie('avn_tkn'));
        xhr.setRequestHeader('content-type', 'application/json');
        xhr.onerror = function(errorMessage) {
            location.reload()
        }
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                if (document.querySelector('#cartbag span') == null) {
                    var r = JSON.parse(this.responseText)
                    // fnsForAddPdtToCart.setOrdrNrToCookie(r.ordNr, inc_cust_name)
                    var cookieorderinfo = JSON.parse(decodeURIComponent(decodeURIComponent(readCookie('orderInfo'))))
                    setObject_m("orderInfo", {
                        ordrNr: r.ordNr,
                        ordrNm: inc_cust_name,
                        isRepOrdr : cookieorderinfo.isRepOrdr,
                        ordrngNavObj : cookieorderinfo.ordrngNavObj,
                        custId:cust_ids,
                        totCustCnt:cookieorderinfo.totCustCnt
                    })
                    document.querySelector('.mcrt-btn-c .mcrt-btn.avn-prim-btn').click()
                    // location.reload()
                }
                
                var result = result = JSON.parse(xhr.response)
                setTimeout(function() {
                    if (document.querySelector('.inc_add_to_basket_btn.loading') != null) {
                        document.querySelector('.inc_add_to_basket_btn.loading').classList.remove('loading');
                    }
                }, 1000)
                
            }
        }
        xhr.send(JSON.stringify(data_param));
    } else {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url1, true);
        xhr.onload = function() {}
        xhr.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');
        xhr.setRequestHeader('x-sec-token', readCookie('avn_tkn'));
        xhr.setRequestHeader('content-type', 'application/json');
        xhr.onerror = function(errorMessage) {
            if(document.querySelector('.fullscreen-spinner') != null){
                document.querySelector('.fullscreen-spinner').style.display = "none"
            }
            add_btn_click.innerText= INC.config.notadded_text
            newbtntext.innerText= INC.config.notadded_text
            console.log("network error")
            setTimeout(function() {
                if (document.querySelector('.inc_add_to_basket_btn.loading') != null) {
                    document.querySelector('.inc_add_to_basket_btn.loading').classList.remove('loading');
                }
            }, 800)
            var checkout_wrapper = add_btn_click
            setTimeout(function() {
                if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul nu a fost adăugat în coș"
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:red;font-size:16px;font-weight:bold;')
                }
            }, 1500);
            if (document.querySelector('.inc_popup.active') != null && elm != null) {
                var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                inc_not_found_error.innerHTML = "Produsul nu a fost adăugat în coș"
                inc_not_found_error.setAttribute('style', 'color:red;font-size:11px;')
                elm.parentNode.appendChild(inc_not_found_error);
                elm.innerText = "Adaugă în coș";
                setTimeout(function() {
                    if (inc_not_found_error != null) {
                        inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                    }
                }, 4000)
            }
            setTimeout(function() {
                if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                }
                if(document.querySelector('.ic_quick_view_popup.active .inc_icon_close') != null){
                    document.querySelector('.ic_quick_view_popup.active .inc_icon_close').click()
                }
            }, 5000)
            
            if (errorMessage == "Unauthorized") {
                refresh_token()
            }
        }
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                add_btn_click.innerText= INC.config.added_text
                newbtntext.innerText= INC.config.added_text
                add_btn_click.parentNode.classList.add('tick_added')
                newbtntext.parentNode.classList.add('tick_added')
                if(document.querySelector('.fullscreen-spinner') != null){
                    document.querySelector('.fullscreen-spinner').style.display = "none"
                }
                if (document.querySelector('#cartbag span') == null) {
                    window.location.reload()
                }
                var result = result = JSON.parse(xhr.response)
                setTimeout(function() {
                    if (document.querySelector('.inc_add_to_basket_btn.loading') != null) {
                        document.querySelector('.inc_add_to_basket_btn.loading').classList.remove('loading');
                    }
                    add_btn_click.parentNode.classList.remove('tick_added')
                    add_btn_click.parentNode.classList.add('disable_btn')
                    newbtntext.parentNode.classList.remove('tick_added')
                    newbtntext.parentNode.classList.add('disable_btn')
                    add_btn_click.innerText= INC.config.add_text
                    newbtntext.innerText= INC.config.add_text
                }, 1000)
                
                if (result.custOrds[0] != undefined) {
                    if (document.querySelector('.inc_popup.active') != null) {
                        document.querySelector('.nav_wrap_price_wrapper').style.display = "none"
                        document.querySelector('.inc_popup .loader_wait_span').style.display = "flex"
                    }
                    var cust_data_online_s = JSON.parse(sessionStorage.getItem("custData"))

                    

                    var checkout_wrapper = add_btn_click;
                    var prev_qt = 0
                    if (document.querySelector('#cartbag span') != null) {
                        prev_qt = document.querySelector('#cartbag span').innerHTML
                    }

                    var checkadded = result.custOrds[0].items;
                    setTimeout(function() {
                        // edit_btn_show_on_add()
                        var error_val_msg = ""
                        for (er = 0; er < checkadded.length; er++) {
                            if (checkadded[er].lineNr == productObj.id) {
                                if (checkadded[er].valid == undefined) {
                                    if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul a fost adăugat în coș";
                                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:#59c3b2;font-size:16px;font-weight:bold;')
                                    }
                                    if (document.querySelector('.inc_popup.active') != null && elm != null) {
                                        var rem_e = document.querySelector('.inc_popup.active .inc_not_found_error');
                                        if (inc_not_found_error != null) {
                                            // rem_e.parentNode.removeChild(rem_e);
                                            inc_not_found_error.innerHTML = "Produsul a fost adăugat în coș";
                                            inc_not_found_error.setAttribute('style', 'color:#59c3b2;font-size:11px;')
                                        } else {
                                            var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                                            inc_not_found_error.innerHTML = "Produsul a fost adăugat în coș";
                                            inc_not_found_error.setAttribute('style', 'color:#59c3b2;font-size:11px;')
                                            if(elm.parentNode.querySelector('.inc_not_found_error') != null){
                                                var remerrelm=elm.parentNode.querySelector('.inc_not_found_error')
                                                remerrelm.parentNode.removeChild(remerrelm)
                                            }
                                            elm.parentNode.appendChild(inc_not_found_error);
                                            elm.innerText = "Adaugă în coș";
                                        }

                                        setTimeout(function() {
                                            if (inc_not_found_error != null) {
                                                if (inc_not_found_error.parentNode != null) {
                                                    inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                                                }
                                            }
                                        }, 4000)
                                    }
                                    setTimeout(function() {
                                        if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                            checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                                        }
                                    }, 5000)
                                } else {
                                    if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                        if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                            if (checkadded[er].valid == "CUST_ORD_NOT_ALLOWED") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Nu poti comanda produsul cu acest cod.";
                                                error_val_msg = "Nu poti comanda produsul cu acest cod."
                                            } else if (checkadded[er].valid == "EXCEEDED_LIMIT") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Ai depasit limita permisa";
                                                error_val_msg = "Ai depasit limita permisa";
                                            } else if (checkadded[er].valid == "MAX_QUANTITY") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Nu puteti adauga mai mult de 1 produs.";
                                                error_val_msg = "Nu puteti adauga mai mult de 1 produs.";
                                            } else if (checkadded[er].valid == "NOT_AVAILABLE") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul cu acest cod nu este disponibil.";
                                                error_val_msg = "Produsul cu acest cod nu este disponibil.";
                                            } else if (checkadded[er].valid == "NOT_AVAILABLE_CAMPAIGN") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Aceasta campanie nu este disponibila.";
                                                error_val_msg = "Aceasta campanie nu este disponibila.";
                                            } else if (checkadded[er].valid == "NOT_ELIGIBLE_ACCT_TYPE") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Acest tip de cont nu este eligibil";
                                                error_val_msg = "Acest tip de cont nu este eligibil";
                                            } else if (checkadded[er].valid == "NOT_ELIGIBLE_USER") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Acest tip de utilizator nu este eligibil.";
                                                error_val_msg = "Acest tip de utilizator nu este eligibil.";
                                            } else if (checkadded[er].valid == "NOT_ELIGIBLE_USER_ITEM") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Acest produs nu este disponibil pentru segmentul din care faceti parte.";
                                                error_val_msg = "Acest produs nu este disponibil pentru segmentul din care faceti parte.";
                                            } else if (checkadded[er].valid == "NOT_FOUND") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Acest produs nu a fost gasit in campania curenta.";
                                                error_val_msg = "Acest produs nu a fost gasit in campania curenta.";
                                            } else if (checkadded[er].valid == "NOT_ORDERABLE") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul cu acest cod nu poate fi comandat.";
                                                error_val_msg = "Produsul cu acest cod nu poate fi comandat.";
                                            } else if (checkadded[er].valid == "NO_VALID_ITEM_FOUND") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul nu este valid.";
                                                error_val_msg = "Produsul nu este valid.";
                                            } else if (checkadded[er].valid == "SHORT_ITEM") {
                                                checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul nu este in stoc si nu poate fi comandat.";
                                                error_val_msg = "Produsul nu este in stoc si nu poate fi comandat.";
                                            }
                                        }

                                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:red;font-size:16px;font-weight:bold;')
                                        if (document.querySelector('.inc_popup.active') != null && elm != null) {
                                            var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                                            inc_not_found_error.innerHTML = error_val_msg;
                                            inc_not_found_error.setAttribute('style', 'color:red;font-size:11px;')
                                            if(elm.parentNode.querySelector('.inc_not_found_error') != null){
                                                var remerrelm=elm.parentNode.querySelector('.inc_not_found_error')
                                                remerrelm.parentNode.removeChild(remerrelm)
                                            }
                                            elm.parentNode.appendChild(inc_not_found_error);
                                            elm.innerText = "Adaugă în coș";
                                            setTimeout(function() {
                                                if (inc_not_found_error != null) {
                                                    if (inc_not_found_error.parentNode != null) {
                                                        inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                                                    }
                                                }
                                            }, 4000)
                                        }
                                    }

                                    // edit_btn_show_on_add()
                                    setTimeout(function() {
                                        if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                            checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                                        }
                                        var prev_act_cust_name = ""
                                        if (document.querySelector('.yrOrders-C.active .name') != null) {
                                            prev_act_cust_name = document.querySelector('.yrOrders-C.active .name').innerText.trim();
                                        }
                                        if(document.querySelector('.yrOrders-C.active .name') != null){
                                            var got_active_cust = null;
                                            var total_cust_ac = document.querySelectorAll('.yrOrders-C')
                                            var current_act = document.querySelector('.yrOrders-C.active .name').innerText.trim();
                                            if (current_act != prev_act_cust_name) {
                                                setTimeout(function() {
                                                    for (cc = 0; cc < total_cust_ac.length; cc++) {
                                                        var just_ch_act = total_cust_ac[cc].querySelector('.name').innerText.trim();
                                                        if (just_ch_act == prev_act_cust_name) {
                                                            total_cust_ac[cc].querySelector('.ordfor').click()
                                                            break;
                                                        }
                                                    }
                                                }, 100)
                                            }
                                        }
                                    }, 5000)
                                }

                            } else if (checkadded.length == er + 1) {
                                // console.log("check all l")
                                if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul a fost adăugat în coș";
                                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:#59c3b2;font-size:16px;font-weight:bold;')
                                }
                                if (document.querySelector('.inc_popup.active') != null && elm != null) {
                                    var rem_e = document.querySelector('.inc_popup.active .inc_not_found_error');
                                    if (inc_not_found_error != null) {
                                        rem_e.parentNode.removeChild(rem_e);
                                    }
                                    var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                                    inc_not_found_error.innerHTML = "Produsul a fost adăugat în coș";
                                    inc_not_found_error.setAttribute('style', 'color:#59c3b2;font-size:11px;')
                                    if(elm.parentNode.querySelector('.inc_not_found_error') != null){
                                        var remerrelm=elm.parentNode.querySelector('.inc_not_found_error')
                                        remerrelm.parentNode.removeChild(remerrelm)
                                    }
                                    elm.parentNode.appendChild(inc_not_found_error);
                                    elm.innerText = "Adaugă în coș";
                                    setTimeout(function() {
                                        if (inc_not_found_error != null) {
                                            if (inc_not_found_error.parentNode != null) {
                                                inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                                            }
                                        }
                                    }, 4000)
                                }

                                setTimeout(function() {
                                    if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                                    }
                                }, 5000)
                            }
                        }
                    }, 1500);

                    // sessionStorage.setItem("custData",JSON.stringify(update_sesion_cart_data))
                    if (document.querySelector('#cartbag span') != null) {
                        document.querySelector('#cartbag span').innerHTML = update_mini_basket_qty();
                    }

                    if (document.querySelectorAll('.sub_total_Price')[0] != undefined) {
                        document.querySelectorAll('.sub_total_Price')[0].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    if (document.querySelector('#cartbag span') != null) {
                        var totl_qty = update_mini_basket_qty();
                        if (document.querySelector('.sub_total_text') != null) {
                            document.querySelector('.sub_total_text').innerHTML = "Subtotal comanda  (" + totl_qty + "  produse)";
                        }
                    }
                    if (document.querySelectorAll('.ic_bundle_price_span')[0] != undefined) {
                        document.querySelectorAll('.ic_bundle_price_span')[0].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    if (document.querySelector('.crt-amt') != null) {
                        var cart_amnt = update_mini_basket_price_to_our_bundle()
                        // update_progress_bar_on_load()
                    }
                    if (document.querySelectorAll('.ic_bundle_price_span')[1] != undefined) {
                        document.querySelectorAll('.ic_bundle_price_span')[1].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    var dataList_inc = [];
                    var update_sesion_cart_data = {}
                    var is_flag = false;
                    if (cust_data_online_s.dataList.length > 1) {
                        var all_cust_online = cust_data_online_s.dataList
                        for (ic_o = 0; ic_o < all_cust_online.length; ic_o++) {
                            if (all_cust_online[ic_o].custId == cust_ids) {
                                var curent_data = all_cust_online[ic_o]
                                curent_data.custName = cust_data_online_s.dataList[ic_o].custName
                                curent_data.gendrCd = cust_data_online_s.dataList[ic_o].gendrCd
                                curent_data.custId = cust_data_online_s.dataList[ic_o].custId
                                curent_data.active = cust_data_online_s.dataList[ic_o].active
                                curent_data.amt = result.custOrds[0].totPrc
                                curent_data.nrItems = result.custOrds[0].noOfItems
                                var qtyitem=result.custOrds[0].items.length;
                                var qty_item = 0
                                for(w=0;w<result.custOrds[0].items.length;w++){
                                    qty_item = qty_item + result.custOrds[0].items[w].qty
                                }
                                // curent_data.nrItems = qty_item
                                dataList_inc.push(all_cust_online[ic_o])
                                active_customer_for_added_prod = cust_data_online_s.dataList[ic_o].custName
                                var all_cust_elm = document.querySelectorAll('.yrOrders-C .name');
                                var all_cust_elm_orders = document.querySelectorAll('.yrOrders-C');
                                for (cp = 0; cp < all_cust_elm_orders.length; cp++) {
                                    if (all_cust_elm_orders[cp] != undefined) {
                                        var cust_nm = all_cust_elm_orders[cp].querySelector('.yrOrders-C .name').innerText.trim();
                                        if (cust_nm == inc_cust_name) {
                                            if (all_cust_elm_orders[cp].querySelector('.r-secAmnt .amount') != null) {
                                                all_cust_elm_orders[cp].querySelector('.r-secAmnt .amount').innerHTML = check_currency_symb(parseFloat(result.custOrds[0].totPrc))
                                            }
                                            all_cust_elm_orders[cp].querySelector('.mab-prim-lnk.itcnt').disabled = false;
                                            if (all_cust_elm_orders[cp].querySelector('.edit-txt') == null) {
                                                // window.location.reload();
                                            }
                                            is_flag = true;
                                        }
                                    }
                                }
                            } else {
                                dataList_inc.push(all_cust_online[ic_o])
                            }
                            if (cust_data_online_s.dataList.length == ic_o + 1) {
                                update_sesion_cart_data = {
                                    "dataList": dataList_inc
                                }
                                sessionStorage.setItem("custData", JSON.stringify(update_sesion_cart_data))
                            }
                        }
                    } else {
                        var all_cust_online = cust_data_online_s.dataList
                        var curent_data = all_cust_online[0]
                        curent_data.custName = cust_data_online_s.dataList[0].custName
                        curent_data.gendrCd = cust_data_online_s.dataList[0].gendrCd
                        curent_data.custId = cust_data_online_s.dataList[0].custId
                        curent_data.active = cust_data_online_s.dataList[0].active
                        curent_data.amt = result.custOrds[0].totPrc
                        active_customer_for_added_prod = cust_data_online_s.dataList[0].custName
                        curent_data.nrItems = result.custOrds[0].noOfItems
                        var qty_item = 0
                        for(w=0;w<result.custOrds[0].items.length;w++){
                            qty_item = qty_item + result.custOrds[0].items[w].qty
                        }
                        // curent_data.nrItems = qty_item
                        dataList_inc.push(all_cust_online[0])
                        update_sesion_cart_data = {
                            "dataList": dataList_inc
                        }
                        sessionStorage.setItem("custData", JSON.stringify(update_sesion_cart_data))
                        if(document.querySelector('.r-secAmnt .amount') != null){
                            document.querySelector('.r-secAmnt .amount').innerHTML = check_currency_symb(parseFloat(result.custOrds[0].totPrc))
                            document.querySelector('.mab-prim-lnk.itcnt').disabled = false;
                        }
                        
                    }
                    get_customer_discount_message()
                    updateproducttobottom(result,item_added_list)
                    setTimeout(function(){
                        if(document.querySelector('#cartbag span') != null){
                            document.querySelector('mini-cart #cartbag').click()
                        }
                        var count_item=0;
                        var celcam_count=document.querySelectorAll('mini-cart .crt-cnt')
                        for(c=0;c<celcam_count.length;c++){
                            count_item = count_item + +celcam_count[c].innerText.replace('produse','').replace('PRODUSE','').trim()
                        }
                        if(document.querySelector('#cartbag > span') != null){
                            var prev_c=document.querySelector('#cartbag > span').innerText
                            document.querySelector('#cartbag > span').innerText = count_item
                            if(document.querySelector('.sub_total_text') != null){
                                document.querySelector('.sub_total_text').innerText = "Subtotal comanda  (" + count_item + "  produse)";
                            }
                        }
                        
                        // setTimeout(function(){
                        //     count_based_on_item()
                        // },2000)
                    },3000)
                }
                if(INC.config.pageType == 'cartPage'){
                    INC.clientConfig.offset = 0;
                    INC.clientConfig.slidevalue = 0;
                    INC.init();
                }
            } else if (this.readyState === XMLHttpRequest.DONE && (this.status === 400 || this.status === 401 || this.status === 405 || this.status === 403)) {
                if(document.querySelector('.fullscreen-spinner') != null){
                    document.querySelector('.fullscreen-spinner').style.display = "none"
                }
                add_btn_click.innerText= INC.config.notadded_text
                newbtntext.innerText= INC.config.notadded_text
                console.log("xhr.response " + xhr.response)
                setTimeout(function() {
                    if (document.querySelector('.inc_add_to_basket_btn.loading') != null) {
                        document.querySelector('.inc_add_to_basket_btn.loading').classList.remove('loading');
                    }
                }, 800)
                var checkout_wrapper = add_btn_click
                setTimeout(function() {
                    if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul nu a fost adăugat în coș"
                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:red !important;font-size:16px;font-weight:bold;')
                    }
                }, 1500);
                if (document.querySelector('.inc_popup.active') != null && elm != null) {
                    var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                    inc_not_found_error.innerHTML = "Produsul a fost adăugat în coș";
                    inc_not_found_error.setAttribute('style', 'color:red !important;font-size:11px;')
                    if(elm.parentNode.querySelector('.inc_not_found_error') != null){
                        var remerrelm=elm.parentNode.querySelector('.inc_not_found_error')
                        remerrelm.parentNode.removeChild(remerrelm)
                    }
                    elm.parentNode.appendChild(inc_not_found_error);
                    elm.innerText = "Adaugă în coș";
                    setTimeout(function() {
                        if (inc_not_found_error != null) {
                            inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                        }
                    }, 4000)
                }
                setTimeout(function() {
                    if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                        checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                    }

                }, 5000)

            }
            setTimeout(function(){
                if(document.querySelector('.ic_quick_view_popup.active .inc_icon_close') != null){
                    document.querySelector('.ic_quick_view_popup.active .inc_icon_close').click()
                }
            },4000)
        }
        try {
            xhr.send(JSON.stringify(formData));
        } catch (err) {
            if(document.querySelector('.fullscreen-spinner') != null){
                document.querySelector('.fullscreen-spinner').style.display = "none"
            }
            add_btn_click.innerText= INC.config.notadded_text
            newbtntext.innerText= IINC.config.notadded_text
            setTimeout(function() {
                if (document.querySelector('.inc_add_to_basket_btn.loading') != null) {
                    document.querySelector('.inc_add_to_basket_btn.loading').classList.remove('loading');
                }
            }, 800)
            var checkout_wrapper = add_btn_click
            setTimeout(function() {
                if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = "Produsul nu a fost adăugat în coș"
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').setAttribute('style', 'color:red !important;font-size:16px;font-weight:bold;')
                }
                if (document.querySelector('.inc_popup.active') != null && elm != null) {
                    var inc_not_found_error = generate_html_tag('div', 'inc_not_found_error');
                    inc_not_found_error.innerHTML = "Produsul nu a fost adăugat în coș"
                    inc_not_found_error.setAttribute('style', 'color:red !important;font-size:11px;')
                    if(elm.parentNode.querySelector('.inc_not_found_error') != null){
                        var remerrelm=elm.parentNode.querySelector('.inc_not_found_error')
                        remerrelm.parentNode.removeChild(remerrelm)
                    }
                    elm.parentNode.appendChild(inc_not_found_error);
                    elm.innerText = "Adaugă în coș";
                    setTimeout(function() {
                        if (inc_not_found_error != null) {
                            inc_not_found_error.parentNode.removeChild(inc_not_found_error);
                        }
                    }, 4000)
                }
                if (document.querySelector('.inc_popup.active') != null) {
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn span').innerHTML = "Produsul nu a fost adăugat în coș";
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn').setAttribute('style', 'background: #e893ac;pointer-events: none;');
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn span').setAttribute('style', 'font-size:10px;line-height: normal;');
                }
            }, 1500);
            setTimeout(function() {
                if(document.querySelector('.ic_quick_view_popup.active .inc_icon_close') != null){
                    document.querySelector('.ic_quick_view_popup.active .inc_icon_close').click()
                }
                if (checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error') != null) {
                    checkout_wrapper.querySelector('.ic_prod_add_error_wrap .ic_prod_add_error').innerHTML = ""
                }
                if (document.querySelector('.inc_popup.active') != null) {
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn span').innerHTML = "Adaugă în coș";
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn').setAttribute('style', 'background: #ff336d;pointer-events: auto;');
                    checkout_wrapper.querySelector('.inc_add_to_basket_btn span').setAttribute('style', 'font-size:14px;line-height: normal;');
                }
            }, 5000)
        }
    }
    var pageType = "";
    switch (INC.config.pageType) {
    case "pdp":
        pageType = "107";
        break;
    case "productList":
        pageType = "101";
        break;
    case "cartPage":
        pageType = "103";
        break;
    case "ticket":
        pageType = "103";
        break;
    case "other":
        pageType = "101";
        break;
    }
    var pname = productBlock.querySelector('.inc_product_desc_title_text').innerText;
    var eventDataObj = {};
    var bundleids = productObj.bundleId.toString()
    if(bundleids.indexOf('offer') >= 0){
        eventdata = {
            "core_product_id": productObj.bundledProductId.toString(),
            "product_id": productObj.mainId.toString(),
            "is_logged_in_user": "0"
        }
        data = {
            "eventData": btoa((JSON.stringify({
                "event_data": eventdata,
                "page_type": "modal_view_dod",
                "event_type": "product_deal_add_to_cart",
                "method": "track",
                "platform": "",
                "token": INC.config.clientToken
            }))),
            "vid": INC.config.ivid,
            "time": getCurrentFormattedTime(),
            "uri": document.location.href
        };
        makeTrackingApiCall(JSON.stringify(data));
    }else{
        if (INC.config.pageType == "cartPage") {
            eventDataObj["bundle_data"] = {
                "id": productObj.bundleId,
                "product_ids": [productObj.bundledProductId, productObj.mainId],
                "product_id": productObj.mainId
            }
        } else {
            eventDataObj["bundle_data"] = {
                "id": productObj.bundleId,
                "product_ids": [productObj.bundledProductId, productObj.mainId],
                "product_id": productObj.bundledProductId
            }
        }
        getTrackingPixel()
        INC.methods.trackingEvents("bundleAddToCart", eventDataObj, pageType);
    }

    
}
function count_based_on_item(){
    if(document.querySelectorAll('.yrOrders-C.active').length == 1){
        var ictotal_qty = 0;
        var in_session_cust_data = JSON.parse(sessionStorage.getItem("custData"))
        for (ic = 0; ic < in_session_cust_data.dataList.length; ic++) {
            ictotal_qty += in_session_cust_data.dataList[ic].nrItems
        }
        var total_c_item=0;
        var orderc = document.querySelectorAll('.ordItems')
        for(n=0;n<orderc.length;n++){
            var count_kc=0;
            // orderc[n].parentNode.parentNode.querySelector('.mab-prim-lnk.itcnt').click()
            var all_addeditem=orderc[n].querySelectorAll('.pr-items')
            for(m=0;m<all_addeditem.length;m++){
                if(all_addeditem[m].querySelector('.pr-price') != null){
                    if(all_addeditem[m].querySelector('.pr-price').innerText.replace('lei','').replace(',','') != 0){
                        var qtyc=all_addeditem[m].querySelector('.pr-qty').innerText.replace('Cant.','').replace('CANT.','').trim()
                        
                        total_c_item = total_c_item + +qtyc
                        count_kc = count_kc + +qtyc
                        console.log("total_c_item"+total_c_item)
                        if(all_addeditem.length == m+1){
                            var alltopsec=document.querySelectorAll('.usr-nme-mc')
                            for(x=0;x<alltopsec.length;x++){
                                
                                if(alltopsec[x].innerText.trim().toLowerCase() == orderc[n].parentNode.parentNode.querySelector('.name').innerText.trim().toLowerCase()){
                                    // document.querySelector('mini-cart #cartbag').click()
                                    // document.querySelectorAll('.crt-cnt')[x].innerHTML = count_kc + " produse"
                                }
                            }
                            // orderc[n].parentNode.parentNode.querySelector('.mab-prim-lnk.itcnt .lnk-txt').innerHTML = "Total " + count_kc + " produse";
                        }
                    }
                }
            }
        }
        setTimeout(function(){
            //total_c_item - for based on item 
            if(ictotal_qty != 0){
                if(document.querySelector('.yrOrders-C.active .mab-prim-lnk.itcnt .lnk-txt') != null){
                    document.querySelector('.yrOrders-C.active .mab-prim-lnk.itcnt .lnk-txt').innerHTML = "Total " + ictotal_qty + " produse";
                }
                if(document.querySelector('.crt-cnt') != null){
                    document.querySelector('.crt-cnt').innerHTML = ictotal_qty + " produse"
                }
                if(document.querySelector('#cartbag > span') != null){
                    var prev_c=document.querySelector('#cartbag > span').innerText
                    document.querySelector('#cartbag > span').innerText = ictotal_qty
                    if(document.querySelector('.sub_total_text') != null){
                        document.querySelector('.sub_total_text').innerText = "Subtotal comanda  (" + ictotal_qty + "  produse)";
                    }
                }
                if (document.querySelector('#cartbag span') != null) {
                    if (document.querySelector('.sub_total_text') != null) {
                        document.querySelector('.sub_total_text').innerHTML = "Subtotal comanda  (" + ictotal_qty + "  produse)";
                    }
                }
            }
        },200)
    }
}
function get_customer_discount_message() {
    var cust_data_online = JSON.parse(sessionStorage.getItem("custData"))
    if (cust_data_online != null) {
        for (var ca = 0; ca < cust_data_online.dataList.length; ca++) {
            if (cust_data_online.dataList[ca].active == true) {
                active_customer = cust_data_online.dataList[ca];
                break;
            }
        }
        if (active_customer != "") {
            cust_id = active_customer.custId
            inc_cust_name = active_customer.custName
        } else {
            if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                cust_id = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim();
            }
            if (document.querySelector('#co-mobMenu .name') != null) {
                var inc_cust_name = document.querySelector('#co-mobMenu .name').innerText
            }
        }
        var inc_acctNr = sessionStorage.getItem("acctNr")
        var order_n = ""
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            order_n = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim();
        }
        if(order_n != ""){
            url = '//apim-eu.api-prod.aws.avon.com/v1/RO/RO/rep/' + inc_acctNr + '/order/' + order_n + '/slsview?groups=header,discnt'
            $.ajax({
                type: "GET",
                url: url,
                processData: false,
                cacheable: false,
                dataType: "json",
                contentType: "application/json",
                beforeSend: function(xhr) {
                    xhr.setRequestHeader('x-sec-token', readCookie('avn_tkn'));
                    xhr.setRequestHeader('content-type', 'application/json');
                },
                success: function(result, xhr) {
                    if(document.querySelector('.disc-section .sal-amt') != null){
                        document.querySelector('.disc-section .sal-amt').innerHTML = check_currency_symb(parseFloat(result.discnt.ordSizeAmt));
                    }
                    //result.discnt.qualfDiscntPct
                    var progressel =document.querySelectorAll('.lnr-prgrs .tic-cir')
                    // tic-cir active lastActive
                    for(t=0;t<progressel.length;t++){
                        var valProg =progressel[t].querySelector('.valblw').innerText.replace('%','')
                        if(result.discnt.qualfDiscntPct == valProg){
                            if(document.querySelector('.tic-cir.active.lastActive') != null){
                                document.querySelector('.tic-cir.active.lastActive').classList.remove('lastActive')
                            }
                            progressel[t].classList.add('active')
                            progressel[t].classList.add('lastActive')
                        }
                    }
                },
                error: function(jqXHR, textStatus, errorMessage) {
                },
            });
        }
    }
    //tic-cir active lastActive
}
function update_mini_basket_price_to_our_bundle() {
    var total_prc = 0;
    var in_session_cust_data = JSON.parse(sessionStorage.getItem("custData"))
    for (ic = 0; ic < in_session_cust_data.dataList.length; ic++) {
        total_prc += in_session_cust_data.dataList[ic].amt
    }
    return total_prc;
}

function update_mini_basket_qty() {
    var total_qty = 0;
    var in_session_cust_data = JSON.parse(sessionStorage.getItem("custData"))
    for (ic = 0; ic < in_session_cust_data.dataList.length; ic++) {
        total_qty += in_session_cust_data.dataList[ic].nrItems
    }
    return total_qty;
}
INC.methods.addBundleToCart = function(btn_cart) {

}

function add_to_cart_tracking_multiple(mainProductId) {
    var event_type = "bundle_add_to_cart";
    var core_prod_id = "";
    var productIdsforTracking = []
    core_prod_id = mainProductId;
    
    pageType = "103";
    var all_data = [];
    for (var k = 0; k < INC.config.bundle_tracking.length; k++) {
        if(mainProductId == null || mainProductId == undefined){
            mainProductId = INC.config.bundle_tracking[k].b_id
            core_prod_id = mainProductId;
        }
        productIdsforTracking.push(INC.config.bundle_tracking[k].b_id)
        productIdsforTracking.push(INC.config.bundle_tracking[k].id)
        all_data.push({
            id: parseInt(INC.config.bundle_tracking[k].bid),
            product_ids: productIdsforTracking,
            product_id: INC.config.bundle_tracking[k].b_id
        })
        productIdsforTracking = []
        // if (INC.config.bundle_tracking.length == 1) {
        //     productIdsforTracking.push(INC.config.bundle_tracking[k].b_id)
        //     productIdsforTracking.push(INC.config.bundle_tracking[k].id)
        //     all_data.push({
        //         id: parseInt(INC.config.bundle_tracking[k].bid),
        //         product_ids: productIdsforTracking,
        //         product_id:INC.config.bundle_tracking[k].b_id
        //     })
        //     productIdsforTracking = []
        // } else {
        //     if (INC.config.bundle_tracking[k].b_id != INC.config.bundle_tracking[k].id) {
        //         productIdsforTracking.push(INC.config.bundle_tracking[k].b_id)
        //         productIdsforTracking.push(INC.config.bundle_tracking[k].id)
        //         all_data.push({
        //             id: parseInt(INC.config.bundle_tracking[k].bid),
        //             product_ids: productIdsforTracking,
        //             product_id: INC.config.bundle_tracking[k].b_id
        //         })
        //         productIdsforTracking = []
        //     }
        // }
    }
    data = {
        "eventData": btoa((JSON.stringify({
            "event_data": {
                "bundle_data": all_data
            },
            "page_type": pageType.toString(),
            "event_type": event_type,
            "method": "track",
            "platform": "",
            "token": INC.config.clientToken,
            "mb": "1"
        }))),
        "vid": INC.config.ivid,
        "time": getCurrentFormattedTime(),
        "uri": document.location.href
    };
    makeTrackingApiCall(JSON.stringify(data));

}
function makeTrackingApiCall(eventdata) {
    p_url = '//optimizedby.increasingly.co/ImportData';
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
            if (xhr.status == 200) {
                if (xhr.responseText != "" && xhr.responseText != null) {} else {}
            }
        }
    }
    ;
    xhr.open("POST", p_url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(eventdata);
}
function getCurrentFormattedTime() {
    var d = new Date();
    var currentTime = (d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate() + " " + d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds() + "." + d.getMilliseconds());
    return currentTime;
}
INC.methods.trackingEvents = function(eventType, eventDataObj, pageType) {
    var importEventDataObj = {};
    var importDataObj = {};

    importEventDataObj["event_data"] = eventDataObj;

    switch (eventType) {
    case "productPageVisit":
        importEventDataObj["event_type"] = "product_page_visit";
        importEventDataObj["method"] = "track";
        break;
    case "catalogProductView":
        importEventDataObj["event_type"] = "catalog_product_view";
        importEventDataObj["page_type"] = "catalog_product_view";
        importEventDataObj["method"] = "track";
        break;
    case "bundleProductClickTracking":
        importEventDataObj["event_type"] = "bundle_product_click_tracking";
        importEventDataObj["page_type"] = pageType;

        importEventDataObj["is_logged"] = "0";
        importEventDataObj["method"] = "track";
        break;
    case "bundleAddToCart":
        importEventDataObj["event_type"] = "bundle_add_to_cart";
        importEventDataObj["page_type"] = pageType;
        importEventDataObj["is_logged"] = (INC.clientConfig.statusLoggedIn == true) ? "1" : "0";
        importEventDataObj["method"] = "track";
        break;
    }

    importEventDataObj["platform"] = "";
    importEventDataObj["token"] = INC.config.clientToken;
    importDataObj["eventData"] = btoa(JSON.stringify(importEventDataObj));
    importDataObj["uri"] = window.location.href;
    importDataObj["vid"] = INC.config.ivid;
    INC.methods.sendTrackingEvents(importDataObj);
}
INC.methods.sendTrackingEvents = function(importDataObj) {
    var xhr = new XMLHttpRequest();
    var method = "POST";
    var url = INC.config.trackingURL;
    xhr.onreadystatechange = handleStateChange;

    xhr.open(method, url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    function handleStateChange() {
        if (xhr.readyState === 4 && xhr.status === 200) {// logger(xhr.responseText);
        }
    }

    xhr.send(JSON.stringify(importDataObj));
}
INC.methods.addVisitorID = function() {
    function generateUniqueINCVisitorId(len, bits) {
        var bits = bits || 36;
        var outStr = "";
        var newStr;
        while (outStr.length < len) {
            newStr = Math.random().toString(bits).slice(2);
            outStr += newStr.slice(0, Math.min(newStr.length, (len - outStr.length)));
        }
        return outStr;
    }
    var ivid = "";
    if (readCookie('ivid') != undefined) {
        ivid = readCookie('ivid')
    }
    if (ivid.length == 0) {
        ivid = generateUniqueINCVisitorId(42, 16);
        var d = new Date();
        var clientdomain = window.location.host.replace('www', '')
        d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toUTCString();
        document.cookie = 'ivid=' + ivid + '; expires=' + expires + '; domain=' + clientdomain + '; path=/' + '; secure;'
    } else {
        ivid = ivid;
        var clientdomain = window.location.host.replace('www', '')
        var d = new Date();
        d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toUTCString();
        document.cookie = 'ivid=' + ivid + '; expires=' + expires + '; domain=' + clientdomain + '; path=/' + '; secure;'
    }
    console.log("ivid: " + ivid);
    INC.config.ivid = ivid;
    return ivid;
}

document.onclick = clickListener;

function clickListener(e) {
    var clickedElement = e.target;
    if (clickedElement != null) {
        tags = document.getElementsByTagName(clickedElement.tagName);
        try {
            if (clickedElement.className == "inc_product_modal_block inc_active") {
                document.querySelector('body').classList.remove('inc_popup_open');
                if (document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
                    document.querySelector('html').classList.remove('inc_overlay');
                    document.querySelector('html').classList.remove('inc_popup_open');
                }
                if (inc_scroll_height > 100) {
                    window.scrollTo(0, inc_scroll_height);
                }
                clickedElement.querySelector('.inc_product_header_title_block').classList.add('inc_active');
                //clickedElement.querySelector('.inc_product_header_title_block_1').classList.remove('inc_active');
                clickedElement.classList.remove('inc_active')
            }
            if (clickedElement.className == "inc_empty_popup") {
                if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
                    document.querySelector('html').classList.remove('inc_overlay')
                    document.querySelector('html').classList.remove('inc_popup_open');
                    if (document.querySelector('body.active-gnav, body.product-shades-sidebar-active') == null) {
                        document.querySelector('body').setAttribute('style', 'overflow:auto')
                    }
                }
                if (clickedElement.parentNode.querySelector('.inc_product_desc_att_block').classList.contains('inc_active')) {
                    clickedElement.parentNode.querySelector('.inc_product_desc_att_block').classList.remove('inc_active')
                }
                productBlock.classList.remove('show_overlay')
            }
            if (clickedElement.classList.contains('sbmtBtn') == true) {
                setTimeout(function(){
                    if (document.querySelector('#cartbag span') != null) {
                        document.querySelector('#cartbag span').innerHTML = update_mini_basket_qty();
                    }
                },3500)
            }
            if (document.querySelector('.inc_product_modal_block.inc_active') != null) {
                if (clickedElement.parentNode.classList == "inc_product_desc_att_color_list_item_img" || clickedElement.classList == "inc_product_desc_att_color_list_item_img" || clickedElement.parentNode.classList == "inc_product_desc_att_zero_list_block" || clickedElement.classList == "inc_product_desc_att_zero_list_block") {
                    document.querySelector('.inc_product_desc_att_block .show_dropdown').classList.remove('show_dropdown')
                }
            }
            if (clickedElement != null) {
                if (clickedElement.classList == "inc_product_desc_add_img" && document.querySelector('.inc_product_modal_block .inc_product_desc_att_block .show_dropdown') != null) {
                    if (window.innerWidth > 1300) {
                        document.querySelector('.inc_product_modal_block .inc_product_desc_att_block .show_dropdown').classList.remove('show_dropdown');
                    }
                }
                if (clickedElement.className == "inc_product_header_img") {
                    document.querySelector('.inc_product_header_title_block').classList.add('inc_active');
                    //document.querySelector('.inc_product_header_title_block_1').classList.remove('inc_active');
                    document.querySelector('body').classList.remove('inc_popup_open');
                }
                if (clickedElement.className == "sidebar_outer sidebar_outer_active" || clickedElement.classList.contains('js-gnav-header-formatter__bg-full-width') == true || clickedElement.classList.contains('gnav-header-formatter__close-icon') == true || clickedElement.classList.contains('js-header-gnav-cart__close') == true) {
                    document.querySelector('.inc_header_continue_img').click()
                }
                if (clickedElement.className == "inc_pdp_bundle_cart_overlay_block active") {
                    document.querySelector('.inc_pdp_bundle_cart_title_img_block').click()
                }
                if (clickedElement.className == "inc_promo_popup inc_active") {
                    document.querySelector('html').classList.remove('inc_overlay_promo');
                    clickedElement.classList.remove('inc_active')
                    if (document.querySelector('.inc_sidebar_modal_block.inc_active') != null) {
                        document.querySelector('.inc_sidebar_modal_block.inc_active').classList.remove('overflow_visible')
                    }
                }
                if (clickedElement.parentNode != null) {
                    if (clickedElement.className != "inc_product_desc_att_color_title_text_block" && clickedElement.className != "inc_product_desc_att_color_title_text_selected" && clickedElement.parentNode.className != "inc_product_desc_att_color_title_text_block" && clickedElement.className != "inc_product_desc_att_zero_title_text" && clickedElement.className != "inc_product_desc_att_zero_title_text_block" && clickedElement.className != "inc_product_desc_add_block" && clickedElement.className != "inc_product_desc_add_text" && clickedElement.className != "img_color_swatch" && clickedElement.className != "inc_product_desc_att_zero_title_text_selected" && clickedElement.classList.contains('inc_product_desc_att_color_list_item_img') != true && clickedElement.classList.contains('inc_product_desc_att_zero_title_text_selected') != true) {
                        if (document.querySelector('.inc_product_desc_att_block .show_dropdown') != null) {
                            document.querySelector('.inc_product_desc_att_block .show_dropdown').classList.remove('show_dropdown')
                        }
                    }

                    if (clickedElement.className == "inc_product_desc_color_list_mobile_overlay_block" || clickedElement.className == "inc_product_desc_color_list_header_img" || clickedElement.className == "inc_product_desc_colour_list_add_btn" || clickedElement.className == "inc_product_desc_att_zero_list_mobile_overlay_block" || clickedElement.className == "inc_product_desc_att_zero_list_header_img" || clickedElement.className == "inc_product_desc_att_zero_list_add_btn") {
                        if (window.innerWidth < 821) {
                            document.querySelector('.inc_product_desc_att_block .show_dropdown').classList.remove('show_dropdown')
                            document.querySelector('html').classList.remove('inc_overlay');
                            document.querySelector('body').classList.remove('inc_popup_open');
                        }

                    }
                }
                if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_product_modal_block.inc_active') == null) {
                    if (document.querySelector('.inc_sidebar_modal_block.inc_active') != null) {
                        if (document.querySelector('.inc_cart_added_product_block.remove_product_conf_modal') == null) {
                            if (document.querySelector('.inc_promo_popup.inc_active') == null) {
                                document.querySelector('.inc_sidebar_modal_block.inc_active').classList.remove('overflow_visible')
                            }
                        }
                    }
                } else if (document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block .inc_product_modal_block.inc_active') != null) {
                    document.querySelector('.sidebar_outer.sidebar_outer_active .inc_sidebar_modal_block').classList.add('overflow_visible')
                    document.querySelector('body').classList.add('inc_popup_open');
                }
                if (clickedElement.className != "inc_product_details_prod_block" && clickedElement.className != "inc_product_variant_simple_block" && clickedElement.className != "inc_product_variant_simple_text config" && clickedElement.className != "inc_product_desc_variant_popup_close_block" && clickedElement.className != "inc_product_desc_add_title_text_block" && clickedElement.tagName != "SELECT" && clickedElement.className != "inc_product_header_block active" && clickedElement.className != "inc_product_desc_att_color_list_item_img_block active" && clickedElement.className != "inc_product_desc_att_block attributes_avail active" && clickedElement.className != "inc_product_qty_block active" && clickedElement.tagName != "LABEL" && clickedElement.tagName != "INPUT" && clickedElement.className != "inc_product_qty_block" && clickedElement.className != "inc_product_desc_att_color_list_item_img_block" && clickedElement.className != "inc_product_header_block" && clickedElement.className != "select_option_inc_title" && clickedElement.className != "inc_product_desc_att_color_list_item_img" && clickedElement.className != "inc_product_desc_att_color_title_text" && clickedElement.className != "inc_product_desc_att_color_list_block" && clickedElement.classList.contains('inc_product_desc_att_block') == false && clickedElement.className != "select_option_inc_block" && clickedElement.className != "inc_product_desc_att_color_title_text_block" && clickedElement.className != "inc_product_desc_att_variant_text" && clickedElement.className != "inc_product_desc_add_img" && clickedElement.className != "inc_product_qty_up_btn" && clickedElement.className != "inc_product_qty_down_btn") {
                    if (clickedElement.classList != undefined) {
                        if (clickedElement.classList.contains('variantoption') == false && clickedElement.classList.contains('inc_product_desc_att_size_list_item_img_block') == false && clickedElement.classList.contains('inc_product_desc_att_color_list_block') == false && clickedElement.className != "inc_product_desc_add_img checked" && clickedElement.classList.contains('inc_product_desc_add_block') == false && clickedElement.classList.contains('inc_pdp_bundle_cart_added_product_edit_img') == false && clickedElement.className != "inc_product_desc_att_color_title_block" && clickedElement.className != "inc_product_desc_qty_up_btn" && clickedElement.className != "inc_product_desc_qty_down_btn" && clickedElement.classList.contains('inc_product_desc_att_color_block') == false && clickedElement.classList.contains('inc_product_desc_att_color_list_item_block') == false && clickedElement.classList.contains('inc_product_desc_att_zero_title_text_selected') == false && clickedElement.classList.contains('inc_product_desc_att_zero_title_text') == false && clickedElement.classList.contains('inc_product_desc_att_size_list_item_img') == false && clickedElement.classList.contains('inc_product_desc_att_color_list_item_img') != true) {
                            var allact = document.querySelectorAll('.inc_product_desc_att_block.inc_active')

                            if (document.querySelector('.inc_product_modal_block.inc_active') == null && document.querySelector('.inc_sidebar_modal_block.inc_active') == null) {
                                document.querySelector('html').classList.remove('inc_overlay');
                                document.querySelector('body').classList.remove('inc_popup_open');
                            } else if (document.querySelector('.iinc_product_modal_block.inc_active') == null) {// document.querySelector('html').classList.add('inc_overlay');
                            }
                            for (q = 0; q < allact.length; q++) {
                                allact[q].classList.remove('inc_active')
                            }

                            if (document.querySelector('.inc_product_block.show_overlay') != null) {
                                document.querySelector('.inc_product_block.show_overlay').classList.remove('show_overlay')
                            }
                        }
                    }
                }
                if (clickedElement.classList.contains('remove_link') == true && INC.config.pageType == "cartPage") {
                    setTimeout(function() {
                        if (document.querySelector('.cart-item.product') != null) {
                            INC.clientConfig.offset = 0;
                            INC.clientConfig.slidevalue = 0;
                            INC.init();
                        }
                    }, 2000)
                }
            }
            if (clickedElement.classList.contains('ordrUpdt') == true) {
                setTimeout(function() {
                    var cc=update_mini_basket_qty()
                    var orderc = document.querySelectorAll('.ordItems')
                    if(orderc.length == 1){
                        document.querySelector('.mab-prim-lnk.itcnt .lnk-txt').innerHTML = "Total " + cc + " produse";
                        if(window.innerWidth < 767){
                            if (document.querySelector('#cartbag span') != null) {
                                document.querySelector('#cartbag span').innerHTML = update_mini_basket_qty();
                            }
                        }
                    }
                }, 5000)
            }
            if (clickedElement.classList != undefined && clickedElement.parentNode.parentNode != null) {
                if (clickedElement.parentNode.parentNode.classList != undefined) {
                    if (clickedElement.classList.contains('sbmtBtn') == true) {
                        setTimeout(function() {
                                var cust_data_online = JSON.parse(sessionStorage.getItem("custData"))
                                var active_customer = ""
                                if(document.querySelector('#cartbag span') != null){
                                    document.querySelector('mini-cart #cartbag').click()
                                }
                                if (document.querySelector('.crt-amt') != null) {
                                    var cart_amnt = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                                    if (document.querySelector('.sub_total_Price') != null) {
                                        document.querySelector('.sub_total_Price').innerHTML = cart_amnt;
                                    }
                                }
                                if (document.querySelector('#cartbag span') != null) {
                                    document.querySelector('#cartbag span').innerHTML = update_mini_basket_qty();
                                }
                        }, 4000)
                    }
                }
            }
            
            if(clickedElement.parentNode != null){
                if (clickedElement.classList != undefined && clickedElement.parentNode.parentNode != null) {
                    if (clickedElement.parentNode.parentNode.classList != undefined) {
                        if (clickedElement.classList.contains('sbmtBtn') == true || clickedElement.parentNode.classList.contains('sbmtBtn') == true || clickedElement.querySelector('.sbmtBtn') != null) {
                            var get_allinc_added_prod_el=document.querySelectorAll('.inc_add_item')
                            for(r=0;r<get_allinc_added_prod_el.length;r++){
                                var remel = get_allinc_added_prod_el[r]
                                if(remel != null && remel != undefined){
                                    remel.parentNode.removeChild(remel)
                                }
                            }
                        }
                    }
                }
            }
            setTimeout(function(){
                var productId = INC.methods.getProductIdFromWebPage();
                if (document.querySelector('#co-mobMenu .ordr-date') != null && document.querySelector('.inc_af_block') == null) {
                    INC.methods.irbReq(productId, 5, "catalog_product_view");
                }
            },1000)
        } catch (err) {
            var formData = new FormData();
            formData.append("EmailId", "shashi@increasingly.com");
            formData.append("Subject", 'JS Error on ');
            formData.append("Message", err + 'Error Stack' + err.stack);
            var xhr = new XMLHttpRequest();
            xhr.open("POST", '//api.increasingly.co/SendEmail', true);
            xhr.send(formData);
        }
    }
}


setTimeout(function() {
    if (window.innerWidth < 821) {
        window.addEventListener("orientationchange", function() {
            if (window.matchMedia("(orientation: portrait)").matches) {
                console.log("PORTRAIT")
                INC.config.deviceMode = "PORTRAIT"
                var inc_pdp_block_rem = document.querySelector(".inc_pdp_block");
                if (inc_pdp_block_rem != null) {
                    inc_pdp_block_rem.parentNode.removeChild(inc_pdp_block_rem);
                }
                var sidebar_rem = document.querySelector(".inc_sidebar_modal_block");
                if (sidebar_rem != null) {
                    sidebar_rem.parentNode.removeChild(sidebar_rem);
                }
                var over_rem = document.querySelector(".inc_sidebar_overlay_block");
                if (over_rem != null) {
                    over_rem.parentNode.removeChild(over_rem);
                }
                setTimeout(function() {
                    INC.init();
                }, 0)

            }
            if (window.matchMedia("(orientation: landscape)").matches) {
                console.log("LANSCAPE")
                INC.config.deviceMode = "LANSCAPE";
                var inc_pdp_block_rem = document.querySelector(".inc_pdp_block");
                if (inc_pdp_block_rem != null) {
                    inc_pdp_block_rem.parentNode.removeChild(inc_pdp_block_rem);
                }
                var sidebar_rem = document.querySelector(".inc_sidebar_modal_block");
                if (sidebar_rem != null) {
                    sidebar_rem.parentNode.removeChild(sidebar_rem);
                }
                var over_rem = document.querySelector(".inc_sidebar_overlay_block");
                if (over_rem != null) {
                    over_rem.parentNode.removeChild(over_rem);
                }
                setTimeout(function() {
                    INC.init();
                }, 0)
            }
        }, {
            passive: true
        });

        var scrollableElement = document.body;
        // scrollableElement.addEventListener('wheel', checkScrollDirection);
        document.addEventListener("touchmove", checkScrollDirection, false);
        function checkScrollDirection(event) {
            var inc_div = document.querySelector(".inc_pdp_block");
            if (inc_isOnScreen(jQuery('.inc_pdp_block'))) {
                if (document.querySelector('.inc_pdp_block') != null) {
                    if (document.querySelectorAll('.elc-sticky-container.js-sticky-container')[1] != null) {
                        document.querySelectorAll('.elc-sticky-container.js-sticky-container')[1].style.display = "none"
                    }
                }
            } else {
                if (document.querySelector('.inc_pdp_block') != null) {
                    if (document.querySelectorAll('.elc-sticky-container.js-sticky-container')[1] != null) {
                        document.querySelectorAll('.elc-sticky-container.js-sticky-container')[1].style.display = "block"
                    }
                }
            }
        }
    }

    window.addEventListener('resize', function(event) {
        if (document.querySelector('.inc_pdp_block .inc_pdp_bundle_product_list_main_block') != null) {
            document.querySelector('.inc_pdp_block .inc_pdp_bundle_product_list_main_block').setAttribute("style", "margin-left:0");
            if (window.innerWidth < 1185) {
                var prd_length = 2
            } else {
                var prd_length = 3
            }
            if (document.querySelectorAll('.inc_pdp_block .inc_product_module_block').length > prd_length && document.querySelector('.inc_pdp_block .inc_pdp_bundle_product_left-btn_block') != null) {
                document.querySelector('.inc_pdp_block .inc_pdp_bundle_product_left-btn_block').setAttribute("style", "pointer-events: none;opacity:0.5");
                document.querySelector('.inc_pdp_block .inc_pdp_bundle_product_right-btn_block').setAttribute("style", "pointer-events: auto;opacity:1");
                document.querySelector('.inc_pdp_bundle_product_left-btn_img').setAttribute('style', 'opacity:0.5')
                document.querySelector('.inc_pdp_bundle_product_right-btn_img').setAttribute('style', 'opacity:1')
            }
            INC.clientConfig.slidevalue = 0
            INC.clientConfig.offset = 0
            INC.clientConfig.slidevalue = 0
        }
    }, {
        passive: true
    })
}, 3000)
function inc_isOnScreen(elem) {
    if (elem.length == 0) {
        return;
    }
    var $window = jQuery(window)
    var viewport_top = $window.scrollTop()
    var viewport_height = $window.height()
    var viewport_bottom = viewport_top + viewport_height
    var $elem = jQuery(elem)
    var top = $elem.offset().top
    var height = $elem.height()
    var bottom = top + height
    return (top >= viewport_top && top < viewport_bottom) || (bottom > viewport_top && bottom <= viewport_bottom) || (height > viewport_height && top <= viewport_top && bottom >= viewport_bottom)
}
function slideTo(id, n, elm, type_of, arrow) {
    if (elm.className == "left_arrow" || elm.className == "left_arrow inc_active" || type_of == "left") {
        var nn = -1
        inc_showSlides(INC.config.inc_slideIndex += nn, nn, elm, type_of, arrow);
    } else {
        var nn = 1
        inc_showSlides(INC.config.inc_slideIndex += nn, nn, elm, type_of, arrow);
    }
}

function inc_showSlides(n, ind, elm, type_of, arrow) {
    var i;
    var showcase_other_img_list = elm.querySelector('.inc_product_showcase_block .inc_product_img_main_img a')
    var modal_other_img_list = elm.querySelector('.inc_product_modal_block .inc_product_img_main_img a')
    var showcase_dots = elm.querySelectorAll('.inc_product_showcase_block .inc_product_img_gallery_list_block .inc_product_img_gallery_list_item_block')
    var modal_dots = elm.querySelectorAll('.inc_product_modal_block .inc_product_img_gallery_list_block .inc_product_img_gallery_list_item_block')

    var showcase_other_img = elm.querySelector('.inc_product_showcase_block .inc_product_img_main_img a img')

    var modal_other_img = elm.querySelector('.inc_product_modal_block .inc_product_img_main_img a img')

    var otherImg_list = showcase_other_img_list.getAttribute('otherImageList');
    var additional_img = []
    var additional_img = otherImg_list.split(',');
    var get_org_img = showcase_other_img_list.getAttribute('imageURL')
    if (n > additional_img.length) {
        INC.config.inc_slideIndex = 1
    }
    if (n < 1) {
        INC.config.inc_slideIndex = additional_img.length
    }

    for (i = 0; i < showcase_dots.length; i++) {
        showcase_dots[i].classList.remove('inc_active')
        if (modal_dots[i] != undefined) {
            modal_dots[i].classList.remove('inc_active')
        }
    }
    var img_src = additional_img[INC.config.inc_slideIndex - 1].replace('160x90', '2000x1500');
    if (img_src != "null") {
        showcase_other_img.setAttribute('src', img_src);
        modal_other_img.setAttribute('src', img_src)
        showcase_other_img.setAttribute('onerror', "this.src='" + get_org_img + "'");
        modal_other_img.setAttribute('onerror', "this.src='" + get_org_img + "'");

        for (var r = 0; r < showcase_dots.length; r++) {
            showcase_dots[r].classList.remove('inc_active');
            modal_dots[r].classList.remove('inc_active');
        }
        if (showcase_dots[INC.config.inc_slideIndex - 1] != null) {
            showcase_dots[INC.config.inc_slideIndex - 1].classList.add('inc_active');
        }
        if (modal_dots[INC.config.inc_slideIndex - 1] != null) {
            modal_dots[INC.config.inc_slideIndex - 1].classList.add('inc_active');
        }
        if (arrow == "arrow") {
            if (modal_dots.length > 6) {
                var activedots = elm.querySelector('.inc_product_modal_block .inc_product_img_gallery_list_block .inc_product_img_gallery_list_item_block.inc_active')
                if (activedots != null) {
                    var actind = activedots.getAttribute('index')
                    if (actind == 5) {
                        if (modal_dots.length >= 6) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 6) {
                        if (modal_dots.length >= 7) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 7) {
                        if (modal_dots.length >= 8) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                            modal_dots[2].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 8) {
                        if (modal_dots.length >= 9) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                            modal_dots[2].setAttribute('style', 'display: none !important;')
                            modal_dots[3].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 9) {
                        if (modal_dots.length >= 10) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                            modal_dots[2].setAttribute('style', 'display: none !important;')
                            modal_dots[3].setAttribute('style', 'display: none !important;')
                            modal_dots[4].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 10) {
                        if (modal_dots.length >= 11) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                            modal_dots[2].setAttribute('style', 'display: none !important;')
                            modal_dots[3].setAttribute('style', 'display: none !important;')
                            modal_dots[4].setAttribute('style', 'display: none !important;')
                            modal_dots[5].setAttribute('style', 'display: none !important;')
                        }
                    } else if (actind == 11) {
                        if (modal_dots.length >= 12) {
                            modal_dots[0].setAttribute('style', 'display: none !important;')
                            modal_dots[1].setAttribute('style', 'display: none !important;')
                            modal_dots[2].setAttribute('style', 'display: none !important;')
                            modal_dots[3].setAttribute('style', 'display: none !important;')
                            modal_dots[4].setAttribute('style', 'display: none !important;')
                            modal_dots[5].setAttribute('style', 'display: none !important;')
                            modal_dots[6].setAttribute('style', 'display: none !important;')
                        }
                    } else {
                        modal_dots[0].style.display = "flex"
                        modal_dots[1].style.display = "flex"
                        modal_dots[2].style.display = "flex"
                        modal_dots[3].style.display = "flex"
                        if (modal_dots[4] != undefined) {
                            modal_dots[4].style.display = "flex"
                        }
                        if (modal_dots[5] != undefined) {
                            modal_dots[5].style.display = "flex"
                        }
                        if (modal_dots[6] != undefined) {
                            modal_dots[6].style.display = "flex"
                        }
                    }
                    // }
                }
            }
        }
    }
}
// SWIPE FEATURE
var xDown = null;
var yDown = null;

function add_swipe(element) {
    element.addEventListener('touchstart', handleTouchStart, {
        passive: true
    });
    element.addEventListener('touchmove', handleTouchMove, {
        passive: true
    });
}
function handleTouchStart(evt) {
    xDown = evt.touches[0].clientX;
    yDown = evt.touches[0].clientY;
}
;
function handleTouchMove(evt) {
    if (!xDown || !yDown) {
        return;
    }
    var xUp = evt.touches[0].clientX;
    var yUp = evt.touches[0].clientY;
    var xDiff = xDown - xUp;
    var yDiff = yDown - yUp;
    if (Math.abs(xDiff) + Math.abs(yDiff) > 150) {
        //to deal with to short swipes
        if (Math.abs(xDiff) > Math.abs(yDiff)) {
            /*most significant*/
            if (xDiff > 0) {
                var prod_card = evt.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                slideTo(null, 0, prod_card, "left")
            } else {
                /* right swipe */
                var prod_card = evt.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                slideTo(null, 0, prod_card, "right")
            }
        }
        /* reset values */
        xDown = null;
        yDown = null;
    }
    if (Math.abs(xDiff) + Math.abs(yDiff) < 150) {
        if (Math.abs(xDiff) > Math.abs(yDiff)) {
            /*most significant*/
            if (xDiff > 0) {
                /* left swipe */
                var prod_card = evt.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                slideTo(null, 0, prod_card, "left")
            } else {
                /* right swipe */
                var prod_card = evt.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
                slideTo(null, 0, prod_card, "right")
            }
        }
        /* reset values */
        xDown = null;
        yDown = null;
    }
}

function cb_tc(bundle_response) {
    var bundles_tc = bundle_response.Bundles;
    var bundleproductarrayTC = {}
    if (bundle_response.ProductsDetail != null) {
        for (var ibT = 0; ibT < bundle_response.ProductsDetail.length; ibT++) {
            bundleproductarrayTC[bundle_response.ProductsDetail[ibT].ProductId] = bundle_response.ProductsDetail[ibT]
        }
    } else if (bundle_response.ProductsDetail == null || bundle_response.ProductsDetail == "null") {
        for (var ibT = 0; ibT < bundle_response.CategoryRecommendations.length; ibT++) {
            bundleproductarrayTC[bundle_response.CategoryRecommendations[ibT].ProductId] = bundle_response.CategoryRecommendations[ibT]
        }
    }

    var bundle_count = bundles_tc.length
    for (var i = 0; i < bundle_count; i++) {
        if (INC.config.dupDataObjectProducts.indexOf(bundles_tc[i].BundleId) == -1) {
            INC.config.dupDataObjectProducts.push(bundles_tc[i].BundleId)
            var irbBundleObj = bundles_tc[i];
            var bundleObj = {};
            bundleObj.id = irbBundleObj["BundleId"];
            if (INC.config.recommendation == false) {
                bundleObj.totalRegularPrice = irbBundleObj["TotalPrice"];
                bundleObj.totalActivePrice = irbBundleObj["TotalSpecialPrice"];
                bundleObj.totalBundlePrice = irbBundleObj["TotalBundlePrice"];
                bundleObj.totalBundleDiscountPrice = irbBundleObj["DiscountPrice"];
                bundleObj.productCount = irbBundleObj["ProductCount"];
            }
            var irbProductsArray = irbBundleObj["ProductIds"]
            if (irbProductsArray.length) {
                if (INC.dataStore.bundleProductsArray != undefined) {
                    pdpProductId = irbProductsArray[0];
                    INC.dataStore.bundleProductsArray.push(irbProductsArray[1]);
                }
            }
            for (var j = 0; j < irbProductsArray.length; j++) {
                var product = bundleproductarrayTC[irbProductsArray[j]]
                var pAttributes = product["Attributes"] || "";
                if (pAttributes != "" && pAttributes != null) {
                    for (var h = 0; h < pAttributes.length; h++) {
                        if (pAttributes[h].frontEndLabel == "color") {
                            pAttributes[h].frontEndLabel = "Color"
                        }
                        if (pAttributes[h].frontEndLabel == "size") {
                            pAttributes[h].frontEndLabel = "Size"
                        }
                        if (pAttributes[h].frontEndLabel == "Shade") {
                            pAttributes[h].frontEndLabel = "Color"
                        }
                        if (pAttributes.length == 1) {
                            pAttributes[h].frontEndLabel = "Size"
                        }
                        pAttributes[h].attributeCode = pAttributes[h].frontEndLabel;
                    }
                    pAttributes = attribute_listing(pAttributes)
                }
                var pAttObj = {};
                for (t = 0; t < pAttributes.length; t++) {
                    if (pAttributes.length == 1) {
                        if (pAttributes[0].attributeCode == "Color" || pAttributes[0].attributeCode == "color") {
                            pAttributes[0].attributeId = 0;
                            var attr_values = pAttributes[t].attributeValues;
                            for (v = 0; v < attr_values.length; v++) {
                                attr_values[v].optionId = 0;
                            }
                        } else {
                            pAttributes[0].attributeId = 1;
                            var attr_values = pAttributes[t].attributeValues;
                            for (v = 0; v < attr_values.length; v++) {
                                attr_values[v].optionId = 1;
                            }
                        }
                    } else {
                        pAttributes[t].attributeId = t
                        var attr_values = pAttributes[t].attributeValues;
                        for (v = 0; v < attr_values.length; v++) {
                            attr_values[v].optionId = t;
                        }
                    }
                }

                if (pAttributes.length) {
                    for (var k = 0; k < pAttributes.length; k++) {
                        var pAttributesObj = pAttributes[k];
                        var pAttributesValues = pAttributesObj["attributeValues"];
                        for (var l = 0; l < pAttributesValues.length; l++) {
                            var childProduct = pAttributesValues[l];
                            if (childProduct["childProductId"] == null) {
                                childProduct["childProductId"] = product["ProductId"];
                                childProduct["childProductSku"] = product["ProductSku"];
                                childProduct["childProductName"] = product["ProductName"];
                                childProduct["childProductImageUrl"] = product["ImageURL"];
                                childProduct["childProductOtherImageUrl"] = product["OtherImageList"];
                                childProduct["childProductUrl"] = product["ProductUrl"];
                                childProduct["childProductPrice"] = product["Price"];
                                childProduct["childProductSpecialPrice"] = product["SpecialPrice"];
                                childProduct["childProductDescription"] = product["Description"];
                                childProduct["childInternalProductId"] = product["ProductId"]
                            }
                            childProduct["ProductType"] = product["ProductType"];
                            childProduct["mainSKU"] = product["ProductSku"];
                            childProduct["childProductIdmain"] = product["ProductId"];

                            childProduct["childProductImageUrlMain"] = product["ImageURL"];
                            childProduct["childProductPriceMain"] = product["Price"];
                            childProduct["childProductSpecialPriceMain"] = product["SpecialPrice"];
                            childProduct["childProductNameMain"] = product["ProductName"];
                            childProduct["childProductUrlMain"] = product["ProductUrl"];
                            childProduct["Field1"] = product["Field1"];

                            childProduct["childreviewsCount"] = product["RatingCount"];
                            childProduct["childRating"] = product["Rating"];
                            childProduct["childCategoryName"] = product["CategoryName"];
                            childProduct["childCategoryId"] = product["CategoryId"];
                            childProduct["childProductDescription"] = product["Description"];
                            var productObj = new INC.classes.ProductAttObj(childProduct);

                            productObj["bundledProductId"] = pdpProductId;
                            productObj.mainId = product["ProductId"];
                            productObj.bundleId = bundleObj.id;
                            productObj.sku = productObj.id;
                            productObj.option[pAttributesObj["attributeId"]].id = pAttributesObj["attributeId"];
                            productObj.option[pAttributesObj["attributeId"]].label = pAttributesObj["frontEndLabel"];
                            productObj.option[pAttributesObj["attributeId"]].code = pAttributesObj["attributeCode"];
                            productObj.Filed3 = product["Field3"] + " | " + product["Field4"];
                            if (!INC.dataStore.dataStoreObj.hasOwnProperty(product['ProductId'])) {
                                INC.dataStore.dataStoreObj[product['ProductId']] = {};
                            }
                            if (!INC.dataStore.dataStoreObj[product['ProductId']].hasOwnProperty(productObj['id'])) {
                                INC.dataStore.dataStoreObj[product['ProductId']][productObj['id']] = {}
                            }
                            pAttObj = INC.dataStore.dataStoreObj[product['ProductId']][productObj['id']];
                            for (pAtt in productObj) {
                                if (pAtt == "option") {
                                    if (!pAttObj.hasOwnProperty('option')) {
                                        pAttObj["option"] = {}
                                    }
                                    Object.keys(productObj[pAtt]).forEach(function(key) {
                                        pAttObj[pAtt][key] = productObj[pAtt][key];
                                    });
                                } else {
                                    pAttObj[pAtt] = productObj[pAtt];
                                }
                            }
                        }
                    }
                }

                if (pAttributes.length == 0) {
                    var productObj = new INC.classes.ProductObj(product);
                    productObj["bundleId"] = irbBundleObj["BundleId"];
                    productObj["bundledProductId"] = pdpProductId;
                    productObj.sku = productObj.id;
                    productObj.Filed3 = product["Field3"] + " | " + product["Field4"];
                    if ((INC.dataStore.dataStoreObj != undefined) && (!INC.dataStore.dataStoreObj.hasOwnProperty(productObj['mainId']))) {
                        INC.dataStore.dataStoreObj[productObj['mainId']] = {};
                    }
                    if (INC.dataStore.dataStoreObj != undefined) {
                        INC.dataStore.dataStoreObj[productObj['mainId']][productObj['id']] = {};
                        if (!!window.MSInputMethodContext && !!document.documentMode) {
                            INC.dataStore.dataStoreObj[productObj['mainId']][productObj['id']] = JSON.parse(JSON.stringify(productObj));
                        } else {
                            INC.dataStore.dataStoreObj[productObj['mainId']][productObj['id']] = Object.assign({}, productObj);
                        }
                    }
                }
            }
        }
    }
    setTimeout(function() {
        INC.methods.createPDPBlock("sidebar")
    }, 200)
}
function attribute_listing(valueArray) {
    sortingArr = ["Color", "Size", "Shade", "Weight", "Volume"];
    items = valueArray
    sorting = ["Color", "Size", "Shade", "Weight", "Volume"];
    result = []
    sorting.forEach(function(key) {
        var found = false;
        items = items.filter(function(item) {
            if (!found && item.attributeCode == key) {
                result.push(item);
                found = true;
                return false;
            } else
                return true;
        })
    })
    return result;
}

var Base64 = {
    _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
    encode: function(e) {
        var t = "";
        var n, r, i, s, o, u, a;
        var f = 0;
        e = Base64._utf8_encode(e);
        while (f < e.length) {
            n = e.charCodeAt(f++);
            r = e.charCodeAt(f++);
            i = e.charCodeAt(f++);
            s = n >> 2;
            o = (n & 3) << 4 | r >> 4;
            u = (r & 15) << 2 | i >> 6;
            a = i & 63;
            if (isNaN(r)) {
                u = a = 64
            } else if (isNaN(i)) {
                a = 64
            }
            t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a)
        }
        return t
    },
    decode: function(e) {
        var t = "";
        var n, r, i;
        var s, o, u, a;
        var f = 0;
        e = e.replace(/[^A-Za-z0-9+/=]/g, "");
        while (f < e.length) {
            s = this._keyStr.indexOf(e.charAt(f++));
            o = this._keyStr.indexOf(e.charAt(f++));
            u = this._keyStr.indexOf(e.charAt(f++));
            a = this._keyStr.indexOf(e.charAt(f++));
            n = s << 2 | o >> 4;
            r = (o & 15) << 4 | u >> 2;
            i = (u & 3) << 6 | a;
            t = t + String.fromCharCode(n);
            if (u != 64) {
                t = t + String.fromCharCode(r)
            }
            if (a != 64) {
                t = t + String.fromCharCode(i)
            }
        }
        t = Base64._utf8_decode(t);
        return t
    },
    _utf8_encode: function(e) {
        e = e.replace(/rn/g, "n");
        var t = "";
        for (var n = 0; n < e.length; n++) {
            var r = e.charCodeAt(n);
            if (r < 128) {
                t += String.fromCharCode(r)
            } else if (r > 127 && r < 2048) {
                t += String.fromCharCode(r >> 6 | 192);
                t += String.fromCharCode(r & 63 | 128)
            } else {
                t += String.fromCharCode(r >> 12 | 224);
                t += String.fromCharCode(r >> 6 & 63 | 128);
                t += String.fromCharCode(r & 63 | 128)
            }
        }
        return t
    },
    _utf8_decode: function(e) {
        var t = "";
        var n = 0;
        var r = c1 = c2 = 0;
        while (n < e.length) {
            r = e.charCodeAt(n);
            if (r < 128) {
                t += String.fromCharCode(r);
                n++
            } else if (r > 191 && r < 224) {
                c2 = e.charCodeAt(n + 1);
                t += String.fromCharCode((r & 31) << 6 | c2 & 63);
                n += 2
            } else {
                c2 = e.charCodeAt(n + 1);
                c3 = e.charCodeAt(n + 2);
                t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
                n += 3
            }
        }
        return t
    }
}
function getTrackingPixel() {// var url = 'https://www.awin1.com/cread.php?awinmid=6774&awinaffid=317439'
// /*-------------------Tracking with Image Pixel---------------------------*/
// var oImg = document.createElement("img");
// oImg.setAttribute('id', 'cstracking')
// oImg.setAttribute('src', url);
// oImg.setAttribute('height', '1px');
// oImg.setAttribute('width', '1px');
// oImg.setAttribute('style', 'display:none')
// document.body.appendChild(oImg);
/* -----------------------------------------------------------------------*/
}

function get_discount_price(p_original_price, p_sale_price) {
    return parseFloat(+p_original_price - +p_sale_price)
}
function get_discount_price_percentage(p_original_price, p_sale_price) {
    return Math.round(((p_original_price - p_sale_price) / p_original_price) * 100);
}

var _isVisible = {
    viewport: {},
    _index: 0,
    _imgs: null,
    _active: false,
    _init: function(data) {
        this.viewport.top = window.pageYOffset;
        this.viewport.bottom = this.viewport.top + window.innerHeight;
        this._imgs = document.querySelectorAll(data.classSelector);
        this._index = data.index;
        this._active = true;
        this.getImages();
    },
    checkVisibility: function(elm) {
        if (typeof (elm) == "undefined")
            return;
        var bounds = {};
        bounds.top = elm.getBoundingClientRect().top + window.pageYOffset;
        bounds.bottom = bounds.top + elm.clientHeight;
        return (bounds.bottom >= this.viewport.top && bounds.bottom <= this.viewport.bottom) || (bounds.top <= this.viewport.bottom && bounds.top >= this.viewport.top);
    },
    getImages: function() {
        (function(elm) {
            var imgLoader = window.setInterval(function() {
                if (elm.checkVisibility(elm._imgs[elm._index])) {
                    switch (elm._imgs[elm._index].tagName) {
                    case "IMG":
                        if (!(elm._imgs[elm._index].src.indexOf("img_placeholder") == -1)) {
                            elm._imgs[elm._index].src = elm._imgs[elm._index].getAttribute('data-src');
                        }
                        break;
                    case "SOURCE":
                        if (!(elm._imgs[elm._index].srcset.indexOf("img_placeholder") == -1)) {
                            elm._imgs[elm._index].srcset = elm._imgs[elm._index].getAttribute('data-srcset');
                        }
                        break;
                    }
                }
                elm._index++;
            }, 10);
        }
        )(this);
    }
}

window.addEventListener('mousemove', function() {
    _isVisible._init({
        classSelector: ".inc_pdp_block img[data-src], .inc_pdp_block source[data-src], .inc_sidebar_modal_block img[data-src], .inc_sidebar_modal_block source[data-src], .inc_af_block img[data-src], .inc_af_block source[data-src]",
        index: 0
    });
}, {
    passive: true
});

INC.methods.updateallbasketprice = function(bundle_card) {
    if (window.innerWidth < 821 && INC.config.pageType == "pdp" && document.querySelector('.header-gnav-cart__overlay.visible') == null && document.querySelector('.sidebar_outer.sidebar_outer_active') == null) {
        var prod1 = []
        var prod2 = []
        var p_id = bundle_card.querySelectorAll('.inc_product_module_block')[0].getAttribute('data-id')
        var p_mainid = bundle_card.querySelectorAll('.inc_product_module_block')[0].getAttribute('data-main_id')
        var p_sku = bundle_card.querySelectorAll('.inc_product_module_block')[0].getAttribute('data-sku')
        var p_bid = bundle_card.querySelectorAll('.inc_product_module_block')[0].getAttribute('data-bundle_id')
        var p_qty = bundle_card.querySelectorAll('.inc_product_module_block .inc_product_qty_input_text input')[0].value
        var activePrice = bundle_card.querySelectorAll('.inc_product_desc_ecirp_active_text')[0].innerText.replace('$', '')
        var regularPrice = bundle_card.querySelectorAll('.inc_product_desc_ecirp_regular_text')[0].innerText.replace('Was', '').replace('$', '').trim()
        if (regularPrice == "") {
            regularPrice = activePrice
        }
        var secondprd = bundle_card.querySelectorAll('.inc_product_module_block')[1]
        if (secondprd != null) {
            var p_id1 = secondprd.getAttribute('data-id')
            var p_mainid1 = secondprd.getAttribute('data-main_id')
            var p_sku1 = secondprd.getAttribute('data-sku')
            var p_bid1 = secondprd.getAttribute('data-bundle_id')
            var p_qty1 = secondprd.querySelector('.inc_product_qty_input_text input').value
            var activePrice1 = secondprd.querySelectorAll('.inc_product_desc_ecirp_active_text')[0].innerText.replace('$', '')
            var regularPrice1 = secondprd.querySelectorAll('.inc_product_desc_ecirp_regular_text')[0].innerText.replace('Was', '').replace('$', '').trim()
            if (regularPrice1 == "") {
                regularPrice1 = activePrice1
            }
            var elBundleCartPriceActiveText = bundle_card.querySelector('.inc_pdp_bundle_cart_summary_ecirp_active_text')
            var elBundleCartPriceRegularText = bundle_card.querySelector('.inc_pdp_bundle_cart_summary_ecirp_regular_text')
            var elBundleCartPriceActiveTextMsg = bundle_card.querySelector('.inc_pdp_bundle_cart_summary_ecirp_save_text')
            //debugger
            var totalActivePrice = (+activePrice * parseInt(p_qty)) + (+activePrice1 * parseInt(p_qty1))
            var totalRegularPrice = (+regularPrice * parseInt(p_qty)) + (+regularPrice1 * parseInt(p_qty1))
            if (elBundleCartPriceActiveText != null) {
                //console.log(totalActivePrice)
                elBundleCartPriceActiveText.innerText = formatter.format(totalActivePrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');;
                elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.remove('simple_ecirp')
                elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.remove('is_special_ecirp')
                elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.remove('simple_ecirp')
                elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.remove('is_special_ecirp')
                var totalsaveprcs = get_discount_price(totalRegularPrice, totalActivePrice)
                if (totalRegularPrice != totalActivePrice && totalRegularPrice != null && totalRegularPrice != "") {
                    elBundleCartPriceRegularText.innerText = "Was " + formatter.format(totalRegularPrice).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
                    elBundleCartPriceRegularText.parentNode.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
                    elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.add('is_special_ecirp')
                    elBundleCartPriceActiveTextMsg.innerHTML = "Save " + formatter.format(totalsaveprcs).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');;
                } else {
                    elBundleCartPriceActiveTextMsg.innerHTML = ""
                    elBundleCartPriceRegularText.innerHTML = ""
                    elBundleCartPriceRegularText.parentNode.parentNode.parentNode.classList.add('simple_ecirp')
                }
                var elsummaryblock = bundle_card.querySelector('.inc_pdp_bundle_cart_summary_add_btn_block')
                elsummaryblock.setAttribute('id', p_id)
                elsummaryblock.setAttribute('psku', p_sku)
                elsummaryblock.setAttribute('mainid', p_mainid)
                elsummaryblock.setAttribute('bid', p_bid)
                elsummaryblock.setAttribute('qty', p_qty)
                elsummaryblock.setAttribute('id1', p_id1)
                elsummaryblock.setAttribute('psku1', p_sku1)
                elsummaryblock.setAttribute('mainid1', p_mainid1)
                elsummaryblock.setAttribute('bid1', p_bid1)
                elsummaryblock.setAttribute('qty1', p_qty1)
            }
        }
    }
}




// .inc_product_add_text:before {
//     content: '';
//     background-image: 'https://www2.avoncosmetics.ro/dam/jcr:5bd8b520-73df-415d-bd02-efed18c604d5/green_tick.svg';
//     background-image: url(https://www2.avoncosmetics.ro/dam/jcr:5bd8b520-73df-415d-bd02-efed18c604d5/green_tick.svg);
//     display: block;
//     width: 50px;
//     height: 50px;
//     background-repeat: no-repeat;
//     position: absolute;
// }
var formatter = new Intl.NumberFormat('ro-RO',{
    style: 'currency',
    currency: 'Lei',
})
function check_currency_symb(a) {
    return a.toLocaleString('ro-RO', {
        style: 'currency',
        currency: 'Lei',
        symbolPosition: 'end',
        minimumFractionDigits: 2,
        currencyDisplay: 'name',
    }).replace('LEI','Lei').replace('.','*').replace(',','.').replace('*',',').replace('de','');
}

function updateproducttobottom(items,item_added_list){
    var active_cust_item_list=[]
    // for(l=0;l<bundle_vars.push_product_to_add.length;l++){
    //     active_cust_item_list.push(bundle_vars.push_product_to_add[l].id)
    //     active_cust_item_list.push(bundle_vars.push_product_to_add[l].p_sku)
    //     if(bundle_vars.push_product_to_add[l].c_pid != null){
    //         active_cust_item_list.push(bundle_vars.push_product_to_add[l].c_pid)
    //         active_cust_item_list.push(bundle_vars.push_product_to_add[l].c_sku)
    //     }
    // }
    var custids = ""
    var cust_data_online = JSON.parse(sessionStorage.getItem("custData"))
    var act_cust="";
    if (cust_data_online != null) {
        for (var ca = 0; ca < cust_data_online.dataList.length; ca++) {
            if (cust_data_online.dataList[ca].active == true) {
                act_cust = cust_data_online.dataList[ca];
                break;
            }
        }
        if (act_cust != "") {
            custids = act_cust.custId
        }
    }

    var appended_lineNr=[]
    var append_p_sibling=document.querySelector('.cartItm .ordItems')
    if(items.custOrds != undefined){
        for(var h=0;h<items.custOrds.length;h++){
            // if(custids == items.custOrds[h].custId){
                for(var it=0;it<items.custOrds[h].items.length;it++){
                    if(item_added_list.indexOf(items.custOrds[h].items[it].lineNr) >= 0 || item_added_list.indexOf(items.custOrds[h].items[it].fscNr) >= 0){
                        if(appended_lineNr.indexOf(items.custOrds[h].items[it].lineNr) == -1 && appended_lineNr.indexOf(items.custOrds[h].items[it].fscNr) == -1){
                            appended_lineNr.push(items.custOrds[h].items[it].lineNr)
                            appended_lineNr.push(items.custOrds[h].items[it].fscNr)
                            var img_src_p = ""
                            if(items.custOrds[h].items[it].prodUrl != undefined){
                                if(items.custOrds[h].items[it].prodUrl != undefined){
                                    var imgsrc=items.custOrds[h].items[it].prodUrl.split('.png')[0]
                                }else{
                                    var imgsrc=items.custOrds[h].items[it].prodUrl
                                }
                            }else{
                                var imgsrc=items.custOrds[h].items[it].prodUrl
                            }
                            if(imgsrc != undefined){   
                                if(imgsrc.indexOf('_1_th') == -1){
                                    img_src_p = imgsrc + "_1_th" + ".png"
                                }else{
                                    img_src_p = items.custOrds[h].items[it].prodUrl
                                }
                            }
                            if(items.custOrds[h].items[it].prodVrntNm != undefined){
                                var desc=" Produs disponibil "
                            }else{
                                var desc= " Produs disponibil "
                            }
                            var selvarient=""
                            if(items.custOrds[h].items[it].prodVrntNm != undefined){
                                selvarient = items.custOrds[h].items[it].prodVrntNm
                            }
                            var percentoff = "0%"
                            if(items.custOrds[h].items[it].prodNm != undefined){
                                var html_item='<div _ngcontent-c4="" class="pr-items"><div _ngcontent-c4="" class="pr-image"><!----><img _ngcontent-c4="" alt="" src='+img_src_p+'><!----></div><div _ngcontent-c4="" class="pr-desc"><div _ngcontent-c4="" class="desc"><span _ngcontent-c4="" class="name"> '+items.custOrds[h].items[it].prodNm+' </span><div _ngcontent-c4="" class="vset"><!----><!----><!----></div></div><div _ngcontent-c4="" class="desc"><!----><span _ngcontent-c4="" class="wtVolInfo">'+selvarient+'</span></div><!----><div _ngcontent-c4="" class="desc">  <!----><div _ngcontent-c4="" class="inStck"> '+desc+' <div _ngcontent-c4="" class="info-tltp-c small-tt"><div _ngcontent-c4="" class="info-tltp ttclick">!</div><div _ngcontent-c4="" class="tltp-wrap tltp-1 toolTipwrap"><div _ngcontent-c4="" class="tltp-trang"></div><div _ngcontent-c4="" class="tltp-cnt"><div _ngcontent-c4="" class="tltp-cls"><img _ngcontent-c4="" id="tltpCls1" src="/dam/jcr:f21f1a65-b27d-4e0e-86ce-330558040d8d/navClose.svg"></div><div _ngcontent-c4="" class="tltp-txt">Acest produs este disponibil pentru a fi comandat</div><div _ngcontent-c4="" class="tltp-lnk mab-prim-lnk"></div></div></div></div></div><!----></div><!----></div><div _ngcontent-c4="" class="hr-line hidden-lg"></div><div _ngcontent-c4="" class="pr-subC mv-rgt"><div _ngcontent-c4="" class="pr-qty"> CANT. '+items.custOrds[h].items[it].qty+' </div></div><div _ngcontent-c4="" class="pr-subC mv-lft"><!----><div _ngcontent-c4="" class="pr-price"> '+check_currency_symb(parseFloat(items.custOrds[h].items[it].prc))+'</div><div _ngcontent-c4="" class="pr-bottomTxt"> Pret unitar - '+check_currency_symb(parseFloat(items.custOrds[h].items[it].brchrPrc))+' </div></div><div _ngcontent-c4="" class="clearfix"></div><div _ngcontent-c4="" class="prrtC"><div _ngcontent-c4="" class="pr-price"> '+check_currency_symb(parseFloat(items.custOrds[h].items[it].prc))+' </div><div _ngcontent-c4="" class="pr-bottomTxt"><!----><!----> '+percentoff+' <!----></div></div></div>'
                            }else{
                                var html_item='<div _ngcontent-c4="" class="pr-items"><div _ngcontent-c4="" class="pr-image"><!----><img _ngcontent-c4="" alt="" src="https://www2.avoncosmetics.ro/dam/jcr:c7d4e16e-c653-4ab4-ac64-705f35ac0162/dummy_listview.svg"><!----></div><div _ngcontent-c4="" class="pr-desc"><div _ngcontent-c4="" class="desc"><span _ngcontent-c4="" class="name"> '+items.custOrds[h].items[it].lineNr+' </span><div _ngcontent-c4="" class="vset"><!----><!----><!----></div></div><div _ngcontent-c4="" class="desc"><!----><span _ngcontent-c4="" class="wtVolInfo">'+selvarient+'</span></div><!----><div _ngcontent-c4="" class="desc">  <!----><div _ngcontent-c4="" class="inStck"> '+desc+' <div _ngcontent-c4="" class="info-tltp-c small-tt"><div _ngcontent-c4="" class="info-tltp ttclick">!</div><div _ngcontent-c4="" class="tltp-wrap tltp-1 toolTipwrap"><div _ngcontent-c4="" class="tltp-trang"></div><div _ngcontent-c4="" class="tltp-cnt"><div _ngcontent-c4="" class="tltp-cls"><img _ngcontent-c4="" id="tltpCls1" src="/dam/jcr:f21f1a65-b27d-4e0e-86ce-330558040d8d/navClose.svg"></div><div _ngcontent-c4="" class="tltp-txt">Acest produs este disponibil pentru a fi comandat</div><div _ngcontent-c4="" class="tltp-lnk mab-prim-lnk"></div></div></div></div></div><!----></div><!----></div><div _ngcontent-c4="" class="hr-line hidden-lg"></div><div _ngcontent-c4="" class="pr-subC mv-rgt"><div _ngcontent-c4="" class="pr-qty"> CANT. '+items.custOrds[h].items[it].qty+' </div></div><div _ngcontent-c4="" class="pr-subC mv-lft"><!----><div _ngcontent-c4="" class="pr-price"> '+check_currency_symb(parseFloat(items.custOrds[h].items[it].prc))+'</div><div _ngcontent-c4="" class="pr-bottomTxt"> Pret unitar - '+check_currency_symb(parseFloat(items.custOrds[h].items[it].totPrc))+' </div></div><div _ngcontent-c4="" class="clearfix"></div><div _ngcontent-c4="" class="prrtC"><div _ngcontent-c4="" class="pr-price"> '+check_currency_symb(parseFloat(items.custOrds[h].items[it].prc))+' </div><div _ngcontent-c4="" class="pr-bottomTxt"><!----><!----> '+percentoff+' <!----></div></div></div>'
                            }
                            var div_den = generate_html_tag('div')
                            div_den.classList.add('inc_add_item')
                            div_den.innerHTML = html_item
                            if(document.querySelector('pao-order-summary .amnt') != null){
                                var preordrval =document.querySelector('pao-order-summary .amnt').innerText.replace('Lei','')
                                var totalordrvadd = items.custOrds[h].items[it].prc + +(preordrval)
                                var totalordervalue=check_currency_symb(parseFloat(totalordrvadd))
                                document.querySelector('pao-order-summary .amnt').innerHTML = '<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'+totalordervalue+'</font></font>'
                            }
                            if(append_p_sibling != null){
                                append_p_sibling.appendChild(div_den)
                            }else{
                                if(document.querySelector('offers-submit .amntSum-row .amnt') != null){
                                    var preordrval =document.querySelector('offers-submit .amntSum-row .amnt').innerText.replace('Lei','')
                                    var totalordrvadd = items.custOrds[h].items[it].prc + +(preordrval)
                                    var totalordervalue=check_currency_symb(parseFloat(totalordrvadd))
                                    document.querySelector('offers-submit .amntSum-row .amnt').innerHTML = totalordervalue
                                }
                            }
                            
                        }
                    }  
                }
            // }
        }
    }
    
}
function updateplpactivemodalprc() {
    var elprice = document.querySelectorAll('.inc_product_block.inc_checked') 
    var activepriceary = 0
    var regularpriceary = 0
    for(var p=0;p<elprice.length;p++){
        var prcact = 0
        var prcreg = 0
        if(elprice[p].querySelector('.inc_product_desc_ecirp_active_text') != null){
            prcact = elprice[p].querySelector('.inc_product_desc_ecirp_active_text').innerText.replace("€", "").replace(",", ".").replace("£", "").replace("lei", "").replace("Lei", "").trim()
            prcreg = elprice[p].querySelector('.inc_product_desc_ecirp_regular_text').innerText.replace("€", "").replace(",", ".").replace("£", "").replace("lei", "").replace("Lei", "").trim()
        }else{
            prcact = elprice[p].querySelector('.inc_product_desc_ecirp_active_text').innerText.replace("€", "").replace(",", ".").replace("£", "").replace("lei", "").replace("Lei", "").trim()
        }
        
        if(prcreg == "" || prcreg == 0  || prcreg == null){
            prcreg = prcact
        }
        var qtye = elprice[p].querySelector('.inc_product_qty_input_text input').value
        activepriceary = +activepriceary +  +(prcact * qtye)
        regularpriceary =  +regularpriceary +  +(prcreg * qtye)
    }
    if(document.querySelector('.inc_checkout_prc_active_text') != null){
        document.querySelector('.inc_checkout_prc_active_text').innerHTML = check_currency_symb(parseFloat(activepriceary))
    }
    if(parseFloat(activepriceary) != 0 && parseFloat(activepriceary) < parseFloat(regularpriceary) && parseFloat(regularpriceary) != parseFloat(activepriceary)){
        // var totalsave = get_discount_ecirp(regularpriceary, activepriceary)
        document.querySelector('.inc_checkout_prc_regular_text').innerHTML =  check_currency_symb(parseFloat(regularpriceary));
        if(document.querySelector('.inc_checkout_bk') != null){
            document.querySelector('.inc_checkout_bk').classList.add('inc_special_prc')
        }
    }else{
        document.querySelector('.inc_checkout_prc_regular_text').innerHTML = ""
        if(document.querySelector('.inc_checkout_bk') != null){
            document.querySelector('.inc_checkout_bk').classList.remove('inc_special_prc')
        }
    }
    
    if(activepriceary == 0){
        document.querySelector('.inc_chk_add_btn').innerText = "Adaugă coș"
        document.querySelector('.inc_checkout_bk').classList.add('disable_btn')
        document.querySelector('.inc_chk_add_btn').setAttribute('style','pointer-events: none;opacity: 0.5;')
        // document.querySelector('.inc_checkout_prc_bk').setAttribute('style','visibility: hidden;')
    }else{
        document.querySelector('.inc_chk_add_btn').innerText = "Adaugă "+elprice.length+" produse în coș"
        document.querySelector('.inc_checkout_bk').classList.remove('disable_btn')
        document.querySelector('.inc_chk_add_btn').setAttribute('style','pointer-events: auto;opacity: 1')
        // document.querySelector('.inc_checkout_prc_bk').setAttribute('style','visibility: visible;')
    }
}
function add_multiple_prod(elbtn){
    if(document.querySelector('.yrOrders-C.active.open') == null && document.querySelector('.yrOrders-C.active') != null){
        if(document.querySelector('.yrOrders-C.active .mab-prim-lnk.itcnt') != null){
            document.querySelector('.yrOrders-C.active .mab-prim-lnk.itcnt').click()
        }
    }
    var elcheckprod = document.querySelectorAll('.inc_product_block.inc_checked')
    var formData = []
    var eltrackdata=[]
    var item_added_list = []
    INC.config.bundle_tracking=[]
    for(let h=0;h<elcheckprod.length;h++){
        var ic_pr_div = elcheckprod[h];
        var qty1 = ic_pr_div.querySelector('.inc_product_qty_input_text input').value
        var href1 = ic_pr_div.querySelector('.inc_product_img_block a').href;
        var img0 = ic_pr_div.querySelector('.inc_product_img_block img').src;
        var sel_length = ic_pr_div.querySelectorAll('.select_wrapper');
        var p_id1 = ic_pr_div.getAttribute('data-id')
        var p_sku1 = ic_pr_div.getAttribute('data-sku')
        var main_p_id = ic_pr_div.getAttribute('data-main_id');
        var qty_main = 0;
        
        var cust_data_online = JSON.parse(sessionStorage.getItem("custData"))
        var inc_acctNr = sessionStorage.getItem("acctNr")
        var data_param = {}
        var inc_cust_name = ""
        var cust_id = ""
        var active_customer = ""

        var current_act = ""
        if (document.querySelector('.yrOrders-C.active .name') != null) {
            current_act = document.querySelector('.yrOrders-C.active .name').innerText.trim();
        }
        for (var ca = 0; ca < cust_data_online.dataList.length; ca++) {
            if (current_act != "") {
                if (cust_data_online.dataList[ca].custName == current_act) {
                    active_customer = cust_data_online.dataList[ca];
                    break;
                }
            } else {
                if (cust_data_online.dataList[ca].active == true) {
                    active_customer = cust_data_online.dataList[ca];
                    break;
                }
            }
        }
        if (active_customer != "") {
            cust_id = active_customer.custId
            inc_cust_name = active_customer.custName
        } else {
            if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                cust_id = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim();
            }
            if (document.querySelector('#co-mobMenu .name') != null) {
                inc_cust_name = document.querySelector('#co-mobMenu .name').innerText
            }
        }
        var placeordrtype = ""
        placeordrtype = "REGULAR"
        //bundle_id
        var mainproductid = ic_pr_div.getAttribute('bundledprod_id')
        item_added_list.push(p_id1)
        item_added_list.push(p_sku1)
        INC.config.bundle_tracking.push({
            bid:ic_pr_div.getAttribute('data-bundle_id'),
            id:ic_pr_div.getAttribute('data-main_id'),
            b_id:ic_pr_div.getAttribute('bundledprod_id'),
        })
        if (cust_data_online != undefined) {
            if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                var inc_param = {
                    cmpgnId: campNr,
                    lineNr: p_id1.toString(),
                    qty: qty1,
                    custId: cust_id,
                    placOrdSctnCd: placeordrtype
                }
                formData.push(inc_param)
            } else {
                var inc_param = {
                    custId: cust_id,
                    lineNr: p_id1.toString(),
                    placOrdSctnCd: placeordrtype,
                    qty: qty1,
                    cmpgnId: campNr
                }
                formData.push(inc_param)
            }
        }
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            var inc_login_user_id = document.querySelector('#co-mobMenu .ordr-date').innerText.replace('#', '').trim()
        }
        if (document.querySelector('#co-mobMenu .ordr-date') != null) {
            var url1 = '//apim-eu.api-prod.aws.avon.com/v1/RO/RO/rep/' + inc_acctNr + '/order/' + inc_login_user_id + '/cust/' + cust_id + '?groups=custords,custords,discnt'
        } else {
            var url1 = '//apim-eu.api-prod.aws.avon.com/v1/RO/RO/rep/' + inc_acctNr + '/order?groups=header,custords,discnt';
        }
        if(elcheckprod.length == h+1){
            data_param["cmpgnId"] = campNr;
            data_param["ordNm"] = inc_cust_name;
            data_param["ordType"] = "REG";
            data_param["items"] = formData;
            if (document.querySelector('#co-mobMenu .ordr-date') != null) {
                addtocartapi(formData,url1,item_added_list,inc_cust_name,elbtn);
            } else {
                addtocartapi(data_param,url1,item_added_list,inc_cust_name,elbtn);
            }
        }
    }
}

function addtocartapi(formData,url1,item_added_list,inc_cust_name,elbtn){
    add_to_cart_tracking_multiple()
    if(document.querySelector('#co-mobMenu .ordr-date') == null) {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url1, false);
        xhr.onload = function() {}
        xhr.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');
        xhr.setRequestHeader('x-sec-token', readCookie('avn_tkn'));
        xhr.setRequestHeader('content-type', 'application/json');
        xhr.onerror = function(errorMessage) {
            location.reload()
        }
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                if(elbtn != null){
                    elbtn.classList.remove('inc_loading')
                }
                var elproductchecked = document.querySelectorAll('.inc_product_block.inc_checked') 
                for(var p=0;p<elproductchecked.length;p++){
                    elproductchecked[p].classList.remove('inc_checked')
                }
                updateplpactivemodalprc()
                if (document.querySelector('#cartbag span') == null) {
                    var r = JSON.parse(this.responseText)
                    var cookieorderinfo = JSON.parse(decodeURIComponent(decodeURIComponent(readCookie('orderInfo'))))
                    setObject_m("orderInfo", {
                        ordrNr: r.ordNr,
                        ordrNm: inc_cust_name,
                        isRepOrdr : cookieorderinfo.isRepOrdr,
                        ordrngNavObj : cookieorderinfo.ordrngNavObj,
                        custId:cust_ids,
                        totCustCnt:cookieorderinfo.totCustCnt
                    })
                    document.querySelector('.mcrt-btn-c .mcrt-btn.avn-prim-btn').click()
                    // location.reload()
                }
            }
        }
        xhr.send(JSON.stringify(data_param));
    } else {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", url1, true);
        xhr.onload = function() {}
        xhr.setRequestHeader('Accept', 'application/json, text/javascript, */*; q=0.01');
        xhr.setRequestHeader('x-sec-token', readCookie('avn_tkn'));
        xhr.setRequestHeader('content-type', 'application/json');
        xhr.onerror = function(errorMessage) {
            if(document.querySelector('.fullscreen-spinner') != null){
                document.querySelector('.fullscreen-spinner').style.display = "none"
            }
            var elproductchecked = document.querySelectorAll('.inc_product_block.inc_checked') 
            for(var p=0;p<elproductchecked.length;p++){
                elproductchecked[p].classList.remove('inc_checked')
            }
            updateplpactivemodalprc()
            var checkout_wrapper = null
            if (errorMessage == "Unauthorized") {
                refresh_token()
            }
            if(elbtn != null){
                elbtn.classList.remove('inc_loading')
            }
        }
        xhr.onreadystatechange = function() {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                if(document.querySelector('.fullscreen-spinner') != null){
                    document.querySelector('.fullscreen-spinner').style.display = "none"
                }
                if(elbtn != null){
                    elbtn.classList.remove('inc_loading')
                }
                var elproductchecked = document.querySelectorAll('.inc_product_block.inc_checked') 
                for(var p=0;p<elproductchecked.length;p++){
                    elproductchecked[p].classList.remove('inc_checked')
                }
                updateplpactivemodalprc()
                if (document.querySelector('#cartbag span') == null) {
                    window.location.reload()
                }
                var result = result = JSON.parse(xhr.response)
                
                
                if (result.custOrds[0] != undefined) {
                    var cust_data_online_s = JSON.parse(sessionStorage.getItem("custData"))
                    var checkout_wrapper = null;
                    var prev_qt = 0
                    if (document.querySelector('#cartbag span') != null) {
                        prev_qt = document.querySelector('#cartbag span').innerHTML
                    }

                    var checkadded = result.custOrds[0].items;
                   

                    // sessionStorage.setItem("custData",JSON.stringify(update_sesion_cart_data))
                    if (document.querySelector('#cartbag span') != null) {
                        document.querySelector('#cartbag span').innerHTML = update_mini_basket_qty();
                    }

                    if (document.querySelectorAll('.sub_total_Price')[0] != undefined) {
                        document.querySelectorAll('.sub_total_Price')[0].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    if (document.querySelector('#cartbag span') != null) {
                        var totl_qty = update_mini_basket_qty();
                        if (document.querySelector('.sub_total_text') != null) {
                            document.querySelector('.sub_total_text').innerHTML = "Subtotal comanda  (" + totl_qty + "  produse)";
                        }
                    }
                    if (document.querySelectorAll('.ic_bundle_price_span')[0] != undefined) {
                        document.querySelectorAll('.ic_bundle_price_span')[0].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    if (document.querySelector('.crt-amt') != null) {
                        var cart_amnt = update_mini_basket_price_to_our_bundle()
                        // update_progress_bar_on_load()
                    }
                    if (document.querySelectorAll('.ic_bundle_price_span')[1] != undefined) {
                        document.querySelectorAll('.ic_bundle_price_span')[1].innerHTML = check_currency_symb(parseFloat(update_mini_basket_price_to_our_bundle()));
                    }
                    var dataList_inc = [];
                    var update_sesion_cart_data = {}
                    var is_flag = false;
                    if (cust_data_online_s.dataList.length > 1) {
                        var all_cust_online = cust_data_online_s.dataList
                        for (ic_o = 0; ic_o < all_cust_online.length; ic_o++) {
                            if (all_cust_online[ic_o].custId == cust_ids) {
                                var curent_data = all_cust_online[ic_o]
                                curent_data.custName = cust_data_online_s.dataList[ic_o].custName
                                curent_data.gendrCd = cust_data_online_s.dataList[ic_o].gendrCd
                                curent_data.custId = cust_data_online_s.dataList[ic_o].custId
                                curent_data.active = cust_data_online_s.dataList[ic_o].active
                                curent_data.amt = result.custOrds[0].totPrc
                                curent_data.nrItems = result.custOrds[0].noOfItems
                                var qtyitem=result.custOrds[0].items.length;
                                var qty_item = 0
                                for(w=0;w<result.custOrds[0].items.length;w++){
                                    qty_item = qty_item + result.custOrds[0].items[w].qty
                                }
                                // curent_data.nrItems = qty_item
                                dataList_inc.push(all_cust_online[ic_o])
                                active_customer_for_added_prod = cust_data_online_s.dataList[ic_o].custName
                                var all_cust_elm = document.querySelectorAll('.yrOrders-C .name');
                                var all_cust_elm_orders = document.querySelectorAll('.yrOrders-C');
                                for (cp = 0; cp < all_cust_elm_orders.length; cp++) {
                                    if (all_cust_elm_orders[cp] != undefined) {
                                        var cust_nm = all_cust_elm_orders[cp].querySelector('.yrOrders-C .name').innerText.trim();
                                        if (cust_nm == inc_cust_name) {
                                            if (all_cust_elm_orders[cp].querySelector('.r-secAmnt .amount') != null) {
                                                all_cust_elm_orders[cp].querySelector('.r-secAmnt .amount').innerHTML = check_currency_symb(parseFloat(result.custOrds[0].totPrc))
                                            }
                                            all_cust_elm_orders[cp].querySelector('.mab-prim-lnk.itcnt').disabled = false;
                                            if (all_cust_elm_orders[cp].querySelector('.edit-txt') == null) {
                                                // window.location.reload();
                                            }
                                            is_flag = true;
                                        }
                                    }
                                }
                            } else {
                                dataList_inc.push(all_cust_online[ic_o])
                            }
                            if (cust_data_online_s.dataList.length == ic_o + 1) {
                                update_sesion_cart_data = {
                                    "dataList": dataList_inc
                                }
                                sessionStorage.setItem("custData", JSON.stringify(update_sesion_cart_data))
                            }
                        }
                    } else {
                        var all_cust_online = cust_data_online_s.dataList
                        var curent_data = all_cust_online[0]
                        curent_data.custName = cust_data_online_s.dataList[0].custName
                        curent_data.gendrCd = cust_data_online_s.dataList[0].gendrCd
                        curent_data.custId = cust_data_online_s.dataList[0].custId
                        curent_data.active = cust_data_online_s.dataList[0].active
                        curent_data.amt = result.custOrds[0].totPrc
                        active_customer_for_added_prod = cust_data_online_s.dataList[0].custName
                        curent_data.nrItems = result.custOrds[0].noOfItems
                        var qty_item = 0
                        for(w=0;w<result.custOrds[0].items.length;w++){
                            qty_item = qty_item + result.custOrds[0].items[w].qty
                        }
                        // curent_data.nrItems = qty_item
                        dataList_inc.push(all_cust_online[0])
                        update_sesion_cart_data = {
                            "dataList": dataList_inc
                        }
                        sessionStorage.setItem("custData", JSON.stringify(update_sesion_cart_data))
                        if(document.querySelector('.r-secAmnt .amount') != null){
                            document.querySelector('.r-secAmnt .amount').innerHTML = check_currency_symb(parseFloat(result.custOrds[0].totPrc))
                            document.querySelector('.mab-prim-lnk.itcnt').disabled = false;
                        }
                        
                    }
                    get_customer_discount_message()
                    updateproducttobottom(result,item_added_list)
                    setTimeout(function(){
                        if(document.querySelector('#cartbag span') != null){
                            document.querySelector('mini-cart #cartbag').click()
                        }
                        var count_item=0;
                        var celcam_count=document.querySelectorAll('mini-cart .crt-cnt')
                        for(c=0;c<celcam_count.length;c++){
                            count_item = count_item + +celcam_count[c].innerText.replace('produse','').replace('PRODUSE','').trim()
                        }
                        if(document.querySelector('#cartbag > span') != null){
                            var prev_c=document.querySelector('#cartbag > span').innerText
                            document.querySelector('#cartbag > span').innerText = count_item
                            if(document.querySelector('.sub_total_text') != null){
                                document.querySelector('.sub_total_text').innerText = "Subtotal comanda  (" + count_item + "  produse)";
                            }
                        }
                    },3000)
                }
                if(INC.config.pageType == 'cartPage'){
                    INC.clientConfig.offset = 0;
                    INC.clientConfig.slidevalue = 0;
                    INC.init();
                }
            } else if (this.readyState === XMLHttpRequest.DONE && (this.status === 400 || this.status === 401 || this.status === 405 || this.status === 403)) {
                var elproductchecked = document.querySelectorAll('.inc_product_block.inc_checked') 
                for(var p=0;p<elproductchecked.length;p++){
                    elproductchecked[p].classList.remove('inc_checked')
                }
                updateplpactivemodalprc()
                if(document.querySelector('.fullscreen-spinner') != null){
                    document.querySelector('.fullscreen-spinner').style.display = "none"
                }
            }
        }
        try {
            xhr.send(JSON.stringify(formData));
        } catch (err) {
            if(elbtn != null){
                elbtn.classList.remove('inc_loading')
            }
            var elproductchecked = document.querySelectorAll('.inc_product_block.inc_checked') 
            for(var p=0;p<elproductchecked.length;p++){
                elproductchecked[p].classList.remove('inc_checked')
            }
            updateplpactivemodalprc()
            if(document.querySelector('.fullscreen-spinner') != null){
                document.querySelector('.fullscreen-spinner').style.display = "none"
            }
        }
    }
}